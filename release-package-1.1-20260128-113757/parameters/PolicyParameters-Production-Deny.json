{
  "_comment": "Production environment - 35 policies in DENY mode (maximum enforcement - blocks non-compliant resources). NOTE: 11 policies removed that only support DeployIfNotExists/AuditIfNotExists/Modify/Audit effects and cannot use Deny. Removed policies: (1-8) DeployIfNotExists/Modify for diagnostics/private endpoints, (9) Configure Managed HSM public access (Modify only), (10) Managed HSM private link (Audit only), (11) Keys rotation policy (Audit only).",
  
  "Key vaults should have soft delete enabled": {
    "effect": "Deny"
  },
  "Key vaults should have deletion protection enabled": {
    "effect": "Deny"
  },
  "Azure Key Vault should disable public network access": {
    "effect": "Deny"
  },
  "Azure Key Vault should have firewall enabled or public network access disabled": {
    "allowedIPAddresses": ["0.0.0.0/0"],
    "forbiddenIPAddresses": [],
    "effect": "Deny"
  },
  "Azure Key Vault Managed HSM should have purge protection enabled": {
    "effect": "Deny"
  },
  "Azure Key Vault should use RBAC permission model": {
    "effect": "Deny"
  },
  
  "Certificates should use allowed key types": {
    "allowedKeyTypes": ["RSA", "EC"],
    "effect": "Deny"
  },
  "Certificates using elliptic curve cryptography should have allowed curve names": {
    "allowedECNames": ["P-256", "P-256K", "P-384", "P-521"],
    "effect": "Deny"
  },
  "Certificates should have the specified maximum validity period": {
    "maximumValidityInMonths": 12,
    "effect": "Deny"
  },
  "Certificates should have the specified lifetime action triggers": {
    "maximumPercentageLife": 80,
    "minimumDaysBeforeExpiry": 90,
    "effect": "Deny"
  },
  "Certificates should be issued by the specified integrated certificate authority": {
    "allowedCAs": ["DigiCert", "GlobalSign"],
    "effect": "Deny"
  },
  "Certificates should be issued by the specified non-integrated certificate authority": {
    "caCommonName": "ContosoCA",
    "effect": "Deny"
  },
  "Certificates should be issued by one of the specified non-integrated certificate authorities": {
    "caCommonNames": ["ContosoCA", "FabrikamCA"],
    "effect": "Deny"
  },
  "Certificates should not expire within the specified number of days": {
    "daysToExpire": 90,
    "effect": "Deny"
  },
  "Keys should have the specified maximum validity period": {
    "maximumValidityInDays": 365,
    "effect": "Deny"
  },
  "Secrets should have the specified maximum validity period": {
    "maximumValidityInDays": 365,
    "effect": "Deny"
  },
  
  "Key Vault secrets should have an expiration date": {
    "effect": "Deny"
  },
  "Key Vault keys should have an expiration date": {
    "effect": "Deny"
  },
  
  "Keys should have more than the specified number of days before expiration": {
    "minimumDaysBeforeExpiration": 90,
    "effect": "Deny"
  },
  "Secrets should have more than the specified number of days before expiration": {
    "minimumDaysBeforeExpiration": 90,
    "effect": "Deny"
  },
  
  "Keys should not be active for longer than the specified number of days": {
    "maximumValidityInDays": 365,
    "effect": "Deny"
  },
  "Secrets should not be active for longer than the specified number of days": {
    "maximumValidityInDays": 365,
    "effect": "Deny"
  },
  
  "Keys should be the specified cryptographic type RSA or EC": {
    "allowedKeyTypes": ["RSA", "EC"],
    "effect": "Deny"
  },
  "Keys using RSA cryptography should have a specified minimum key size": {
    "minimumRSAKeySize": 4096,
    "effect": "Deny"
  },
  "Keys using elliptic curve cryptography should have the specified curve names": {
    "allowedECNames": ["P-256", "P-256K", "P-384", "P-521"],
    "effect": "Deny"
  },
  "Certificates using RSA cryptography should have the specified minimum key size": {
    "minimumRSAKeySize": 4096,
    "effect": "Deny"
  },  "[Preview]: Azure Key Vault Managed HSM should disable public network access": {
    "effect": "Deny"
  },
  "[Preview]: Azure Key Vault Managed HSM keys should have an expiration date": {
    "effect": "Deny"
  },
  "[Preview]: Azure Key Vault Managed HSM Keys should have more than the specified number of days before expiration": {
    "minimumDaysBeforeExpiration": 30,
    "effect": "Deny"
  },
  "[Preview]: Azure Key Vault Managed HSM keys using elliptic curve cryptography should have the specified curve names": {
    "allowedECNames": ["P-256", "P-256K", "P-384", "P-521"],
    "effect": "Deny"
  },  "[Preview]: Azure Key Vault Managed HSM keys using RSA cryptography should have a specified minimum key size": {
    "minimumRSAKeySize": 4096,
    "effect": "Deny"
  },
  
  "Keys should be backed by a hardware security module (HSM)": {
    "effect": "Deny"
  },
  
  "Secrets should have content type set": {
    "effect": "Deny"
  },
  
  "Azure Key Vaults should use private link": {
    "effect": "Deny"
  }
}
