{
  "Assignments": [
    {
      "IntendedAssignmentName": "Certificatesusingellipticcurvecryptographyshouldhavea-1468057639",
      "Parameters": {
        "effect": "Audit",
        "allowedECNames": [
          "P-256",
          "P-256K",
          "P-384",
          "P-521"
        ]
      },
      "Status": "DryRun",
      "Name": "Certificates using elliptic curve cryptography should have allowed curve names"
    },
    {
      "IntendedAssignmentName": "DeployConfigurediagnosticsettingsforAzureKeyVaulttoLog-821297124",
      "Parameters": {
        "effect": "DeployIfNotExists",
        "logAnalytics": "/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.OperationalInsights/workspaces/law-policy-test-6874"
      },
      "Status": "DryRun",
      "Name": "Deploy - Configure diagnostic settings for Azure Key Vault to Log Analytics workspace"
    },
    {
      "IntendedAssignmentName": "ConfigureAzureKeyVaultswithprivateendpoints-1664094028",
      "Parameters": {
        "effect": "DeployIfNotExists",
        "privateEndpointSubnetId": "/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-keyvault-test/providers/Microsoft.Network/virtualNetworks/vnet-policy-test/subnets/subnet-keyvault"
      },
      "Status": "DryRun",
      "Name": "Configure Azure Key Vaults with private endpoints"
    },
    {
      "IntendedAssignmentName": "ConfigureAzureKeyVaultstouseprivateDNSzones-1754477011",
      "Parameters": {
        "effect": "DeployIfNotExists",
        "privateDnsZoneId": "/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.Network/privateDnsZones/privatelink.vaultcore.azure.net"
      },
      "Status": "DryRun",
      "Name": "Configure Azure Key Vaults to use private DNS zones"
    },
    {
      "IntendedAssignmentName": "PreviewAzureKeyVaultManagedHSMkeysshouldhaveanexpirati-976371970",
      "Parameters": {
        "effect": "Audit"
      },
      "Status": "DryRun",
      "Name": "[Preview]: Azure Key Vault Managed HSM keys should have an expiration date"
    },
    {
      "IntendedAssignmentName": "KeysshouldbebackedbyahardwaresecuritymoduleHSM-593124860",
      "Parameters": {
        "effect": "Audit"
      },
      "Status": "DryRun",
      "Name": "Keys should be backed by a hardware security module (HSM)"
    },
    {
      "IntendedAssignmentName": "PreviewAzureKeyVaultManagedHSMshoulddisablepublicnetwo-208646097",
      "Parameters": {
        "effect": "Audit"
      },
      "Status": "DryRun",
      "Name": "[Preview]: Azure Key Vault Managed HSM should disable public network access"
    },
    {
      "IntendedAssignmentName": "KeyVaultkeysshouldhaveanexpirationdate-386037801",
      "Parameters": {
        "effect": "Audit"
      },
      "Status": "DryRun",
      "Name": "Key Vault keys should have an expiration date"
    },
    {
      "IntendedAssignmentName": "DeployDiagnosticSettingsforKeyVaulttoEventHub-215019929",
      "Parameters": {
        "eventHubLocation": "eastus",
        "effect": "DeployIfNotExists",
        "eventHubRuleId": "/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.EventHub/namespaces/eh-policy-test-3464/authorizationrules/RootManageSharedAccessKey"
      },
      "Status": "DryRun",
      "Name": "Deploy Diagnostic Settings for Key Vault to Event Hub"
    },
    {
      "IntendedAssignmentName": "Certificatesshouldbeissuedbythespecifiedintegratedcer-1190107367",
      "Parameters": {
        "allowedCAs": [
          "DigiCert",
          "GlobalSign"
        ],
        "effect": "Audit"
      },
      "Status": "DryRun",
      "Name": "Certificates should be issued by the specified integrated certificate authority"
    },
    {
      "IntendedAssignmentName": "Keysshouldhavearotationpolicyensuringthattheirrotatio-1816322754",
      "Parameters": {
        "effect": "Audit",
        "maximumDaysToRotate": 90
      },
      "Status": "DryRun",
      "Name": "Keys should have a rotation policy ensuring that their rotation is scheduled within the specified number of days after creation."
    },
    {
      "IntendedAssignmentName": "AzureKeyVaultManagedHSMshouldhavepurgeprotectionenabl-1494992807",
      "Parameters": {
        "effect": "Audit"
      },
      "Status": "DryRun",
      "Name": "Azure Key Vault Managed HSM should have purge protection enabled"
    },
    {
      "IntendedAssignmentName": "Keysusingellipticcurvecryptographyshouldhavethespecif-1437325202",
      "Parameters": {
        "effect": "Audit",
        "allowedECNames": [
          "P-256",
          "P-256K",
          "P-384",
          "P-521"
        ]
      },
      "Status": "DryRun",
      "Name": "Keys using elliptic curve cryptography should have the specified curve names"
    },
    {
      "IntendedAssignmentName": "PreviewAzureKeyVaultManagedHSMKeysshouldhavemorethant-1035226701",
      "Parameters": {
        "minimumDaysBeforeExpiration": 30,
        "effect": "Audit"
      },
      "Status": "DryRun",
      "Name": "[Preview]: Azure Key Vault Managed HSM Keys should have more than the specified number of days before expiration"
    },
    {
      "IntendedAssignmentName": "KeyVaultsecretsshouldhaveanexpirationdate-1232117220",
      "Parameters": {
        "effect": "Audit"
      },
      "Status": "DryRun",
      "Name": "Key Vault secrets should have an expiration date"
    },
    {
      "IntendedAssignmentName": "Keysshouldnotbeactiveforlongerthanthespecifiednumbero-1296256806",
      "Parameters": {
        "maximumValidityInDays": 365,
        "effect": "Audit"
      },
      "Status": "DryRun",
      "Name": "Keys should not be active for longer than the specified number of days"
    },
    {
      "IntendedAssignmentName": "PreviewAzureKeyVaultManagedHSMkeysusingRSAcryptography-998252524",
      "Parameters": {
        "minimumRSAKeySize": 4096,
        "effect": "Audit"
      },
      "Status": "DryRun",
      "Name": "[Preview]: Azure Key Vault Managed HSM keys using RSA cryptography should have a specified minimum key size"
    },
    {
      "IntendedAssignmentName": "AzureKeyVaultshouldhavefirewallenabledorpublicnetwork-1396884516",
      "Parameters": {
        "allowedIPAddresses": [
          "0.0.0.0/0"
        ],
        "effect": "Audit",
        "forbiddenIPAddresses": []
      },
      "Status": "DryRun",
      "Name": "Azure Key Vault should have firewall enabled or public network access disabled"
    },
    {
      "IntendedAssignmentName": "PreviewConfigureAzureKeyVaultManagedHSMwithprivateendp-732076577",
      "Parameters": {
        "effect": "DeployIfNotExists",
        "privateEndpointSubnetId": "/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-keyvault-test/providers/Microsoft.Network/virtualNetworks/vnet-policy-test/subnets/subnet-keyvault"
      },
      "Status": "DryRun",
      "Name": "[Preview]: Configure Azure Key Vault Managed HSM with private endpoints"
    },
    {
      "IntendedAssignmentName": "Secretsshouldhavethespecifiedmaximumvalidityperiod-1663466362",
      "Parameters": {
        "maximumValidityInDays": 365,
        "effect": "Audit"
      },
      "Status": "DryRun",
      "Name": "Secrets should have the specified maximum validity period"
    },
    {
      "IntendedAssignmentName": "Certificatesshouldbeissuedbyoneofthespecifiednonintegr-165973907",
      "Parameters": {
        "caCommonNames": [
          "ContosoCA",
          "FabrikamCA"
        ],
        "effect": "Audit"
      },
      "Status": "DryRun",
      "Name": "Certificates should be issued by one of the specified non-integrated certificate authorities"
    },
    {
      "IntendedAssignmentName": "KeysusingRSAcryptographyshouldhaveaspecifiedminimumkey-909744685",
      "Parameters": {
        "minimumRSAKeySize": 4096,
        "effect": "Audit"
      },
      "Status": "DryRun",
      "Name": "Keys using RSA cryptography should have a specified minimum key size"
    },
    {
      "IntendedAssignmentName": "DeployConfigurediagnosticsettingstoanEventHubtobeenabl-909645055",
      "Parameters": {
        "eventHubLocation": "eastus",
        "effect": "DeployIfNotExists",
        "eventHubRuleId": "/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.EventHub/namespaces/eh-policy-test-3464/authorizationrules/RootManageSharedAccessKey"
      },
      "Status": "DryRun",
      "Name": "Deploy - Configure diagnostic settings to an Event Hub to be enabled on Azure Key Vault Managed HSM"
    },
    {
      "IntendedAssignmentName": "Secretsshouldhavemorethanthespecifiednumberofdaysbefo-1193127515",
      "Parameters": {
        "minimumDaysBeforeExpiration": 90,
        "effect": "Audit"
      },
      "Status": "DryRun",
      "Name": "Secrets should have more than the specified number of days before expiration"
    },
    {
      "IntendedAssignmentName": "Keyvaultsshouldhavedeletionprotectionenabled-1439856846",
      "Parameters": {
        "effect": "Audit"
      },
      "Status": "DryRun",
      "Name": "Key vaults should have deletion protection enabled"
    },
    {
      "IntendedAssignmentName": "Keysshouldhavemorethanthespecifiednumberofdaysbeforeexp-12464927",
      "Parameters": {
        "minimumDaysBeforeExpiration": 90,
        "effect": "Audit"
      },
      "Status": "DryRun",
      "Name": "Keys should have more than the specified number of days before expiration"
    },
    {
      "IntendedAssignmentName": "ResourcelogsinKeyVaultshouldbeenabled-1683835535",
      "Parameters": {
        "effect": "AuditIfNotExists",
        "requiredRetentionDays": "365"
      },
      "Status": "DryRun",
      "Name": "Resource logs in Key Vault should be enabled"
    },
    {
      "IntendedAssignmentName": "Keysshouldhavethespecifiedmaximumvalidityperiod-906231923",
      "Parameters": {
        "maximumValidityInDays": 365,
        "effect": "Audit"
      },
      "Status": "DryRun",
      "Name": "Keys should have the specified maximum validity period"
    },
    {
      "IntendedAssignmentName": "Certificatesshouldbeissuedbythespecifiednonintegratedc-500792775",
      "Parameters": {
        "caCommonName": "ContosoCA",
        "effect": "Audit"
      },
      "Status": "DryRun",
      "Name": "Certificates should be issued by the specified non-integrated certificate authority"
    },
    {
      "IntendedAssignmentName": "AzureKeyVaultshoulduseRBACpermissionmodel-307198231",
      "Parameters": {
        "effect": "Audit"
      },
      "Status": "DryRun",
      "Name": "Azure Key Vault should use RBAC permission model"
    },
    {
      "IntendedAssignmentName": "Certificatesshouldhavethespecifiedlifetimeactiontrigg-1761965968",
      "Parameters": {
        "minimumDaysBeforeExpiry": 90,
        "maximumPercentageLife": 80,
        "effect": "Audit"
      },
      "Status": "DryRun",
      "Name": "Certificates should have the specified lifetime action triggers"
    },
    {
      "IntendedAssignmentName": "CertificatesusingRSAcryptographyshouldhavethespecifie-2031578458",
      "Parameters": {
        "minimumRSAKeySize": 4096,
        "effect": "Audit"
      },
      "Status": "DryRun",
      "Name": "Certificates using RSA cryptography should have the specified minimum key size"
    },
    {
      "IntendedAssignmentName": "Certificatesshoulduseallowedkeytypes-246707145",
      "Parameters": {
        "allowedKeyTypes": [
          "RSA",
          "EC"
        ],
        "effect": "Audit"
      },
      "Status": "DryRun",
      "Name": "Certificates should use allowed key types"
    },
    {
      "IntendedAssignmentName": "KeysshouldbethespecifiedcryptographictypeRSAorEC-976981238",
      "Parameters": {
        "effect": "Audit"
      },
      "Status": "DryRun",
      "Name": "Keys should be the specified cryptographic type RSA or EC"
    },
    {
      "IntendedAssignmentName": "PreviewAzureKeyVaultManagedHSMkeysusingellipticcurvecr-518169623",
      "Parameters": {
        "effect": "Audit",
        "allowedECNames": [
          "P-256",
          "P-256K",
          "P-384",
          "P-521"
        ]
      },
      "Status": "DryRun",
      "Name": "[Preview]: Azure Key Vault Managed HSM keys using elliptic curve cryptography should have the specified curve names"
    },
    {
      "IntendedAssignmentName": "PreviewAzureKeyVaultManagedHSMshoulduseprivatelink-504701151",
      "Parameters": {
        "effect": "Audit"
      },
      "Status": "DryRun",
      "Name": "[Preview]: Azure Key Vault Managed HSM should use private link"
    },
    {
      "IntendedAssignmentName": "PreviewConfigureAzureKeyVaultManagedHSMtodisablepublic-937554689",
      "Parameters": {
        "effect": "Modify"
      },
      "Status": "DryRun",
      "Name": "[Preview]: Configure Azure Key Vault Managed HSM to disable public network access"
    },
    {
      "IntendedAssignmentName": "Configurekeyvaultstoenablefirewall-2078747040",
      "Parameters": {
        "effect": "Modify"
      },
      "Status": "DryRun",
      "Name": "Configure key vaults to enable firewall"
    },
    {
      "IntendedAssignmentName": "AzureKeyVaultsshoulduseprivatelink-2127082189",
      "Parameters": {
        "effect": "Audit"
      },
      "Status": "DryRun",
      "Name": "Azure Key Vaults should use private link"
    },
    {
      "IntendedAssignmentName": "ResourcelogsinAzureKeyVaultManagedHSMshouldbeenabled-1874150632",
      "Parameters": {
        "effect": "AuditIfNotExists"
      },
      "Status": "DryRun",
      "Name": "Resource logs in Azure Key Vault Managed HSM should be enabled"
    },
    {
      "IntendedAssignmentName": "Certificatesshouldnotexpirewithinthespecifiednumberof-2114192775",
      "Parameters": {
        "effect": "Audit",
        "daysToExpire": 90
      },
      "Status": "DryRun",
      "Name": "Certificates should not expire within the specified number of days"
    },
    {
      "IntendedAssignmentName": "Secretsshouldhavecontenttypeset-1186338756",
      "Parameters": {
        "effect": "Audit"
      },
      "Status": "DryRun",
      "Name": "Secrets should have content type set"
    },
    {
      "IntendedAssignmentName": "Secretsshouldnotbeactiveforlongerthanthespecifiednumb-1452013840",
      "Parameters": {
        "maximumValidityInDays": 365,
        "effect": "Audit"
      },
      "Status": "DryRun",
      "Name": "Secrets should not be active for longer than the specified number of days"
    },
    {
      "IntendedAssignmentName": "Keyvaultsshouldhavesoftdeleteenabled-656701378",
      "Parameters": {
        "effect": "Audit"
      },
      "Status": "DryRun",
      "Name": "Key vaults should have soft delete enabled"
    },
    {
      "IntendedAssignmentName": "AzureKeyVaultshoulddisablepublicnetworkaccess-906277113",
      "Parameters": {
        "effect": "Audit"
      },
      "Status": "DryRun",
      "Name": "Azure Key Vault should disable public network access"
    },
    {
      "IntendedAssignmentName": "Certificatesshouldhavethespecifiedmaximumvalidityperio-407807336",
      "Parameters": {
        "maximumValidityInMonths": 12,
        "effect": "Audit"
      },
      "Status": "DryRun",
      "Name": "Certificates should have the specified maximum validity period"
    }
  ],
  "Preview": true,
  "Compliance": null,
  "Verification": [],
  "DryRun": true
}
