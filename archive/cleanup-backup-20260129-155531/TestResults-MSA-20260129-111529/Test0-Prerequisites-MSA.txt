**********************
PowerShell transcript start
Start time: 20260129111547
Username: DTL01\lcladmin
RunAs User: DTL01\lcladmin
Configuration Name: 
Machine: DTL01 (Microsoft Windows NT 10.0.20348.0)
Host Application: C:\Program Files\PowerShell\7\pwsh.dll -noexit -command try { . "c:\Program Files\Microsoft VS Code\resources\app\out\vs\workbench\contrib\terminal\common\scripts\shellIntegration.ps1" } catch {}
Process ID: 8684
PSVersion: 7.5.3
PSEdition: Core
GitCommitId: 7.5.3
OS: Microsoft Windows 10.0.20348
Platform: Win32NT
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1, 6.0, 7.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
WSManStackVersion: 3.0
**********************
Transcript started, output file is .\TestResults-MSA-20260129-111529\Test0-Prerequisites-MSA.txt
[2026-01-29 11:15:47]
Running: .\Test-DiscoveryPrerequisites.ps1 -Detailed
[2026-01-29 11:15:47] [HEADER] =====================================================================
[2026-01-29 11:15:47] [HEADER] Azure Environment Discovery - Prerequisites Validation
[2026-01-29 11:15:47] [HEADER] Sprint 1, Story 1.1 - Environment Discovery & Baseline Assessment
[2026-01-29 11:15:47] [HEADER] =====================================================================
[2026-01-29 11:15:47] [INFO]
[2026-01-29 11:15:47] [INFO] Supported Scenarios:
[2026-01-29 11:15:47] [INFO]   1. MSDN subscription with guest MSA account (Owner role)
[2026-01-29 11:15:47] [INFO]   2. Corporate AAD environment with AAD user (Reader+ role)
[2026-01-29 11:15:47] [INFO]
[2026-01-29 11:15:47] [HEADER] =====================================================================
[2026-01-29 11:15:47] [HEADER] PHASE 1: Local Environment Checks
[2026-01-29 11:15:47] [HEADER] =====================================================================
[2026-01-29 11:15:47] [INFO] Checking PowerShell version...

✓ PASS - PowerShell Version
  Details: Current: 7.5.3, Required: 7.0 or higher
[2026-01-29 11:15:47] [INFO] Checking Azure PowerShell modules...

✓ PASS - Module: Az.Accounts
  Details: Version: 5.3.0, Purpose: Azure authentication and context management

✓ PASS - Module: Az.Resources
  Details: Version: 8.1.0, Purpose: Resource and policy management

✓ PASS - Module: Az.KeyVault
  Details: Version: 6.3.2, Purpose: Key Vault inventory
[2026-01-29 11:15:47] [INFO] 
Checking optional modules...
  ✓ Optional: Az.Monitor v6.0.3 - Diagnostic settings check (optional)
[2026-01-29 11:15:47] [INFO]
[2026-01-29 11:15:47] [HEADER] =====================================================================
[2026-01-29 11:15:47] [HEADER] PHASE 2: Azure Connectivity Checks
[2026-01-29 11:15:47] [HEADER] =====================================================================
[2026-01-29 11:15:47] [INFO] Checking Azure connectivity...

✓ PASS - Azure Connection
  Details: Connected as: theregniers@hotmail.com | Type: Corporate AAD User | Tenant: 21bd262e-3255-411e-8345-51102d9d9e9e
[2026-01-29 11:15:47] [INFO] Checking subscription access...
WARNING: Unable to acquire token for tenant '28a0fe2d-1db4-4c3e-9a58-142d0f38e709' with error 'Authentication failed against tenant 28a0fe2d-1db4-4c3e-9a58-142d0f38e709. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 28a0fe2d-1db4-4c3e-9a58-142d0f38e709'.'
WARNING: Unable to acquire token for tenant '93298d06-3fff-4626-8e13-397bf9bd4c30' with error 'Authentication failed against tenant 93298d06-3fff-4626-8e13-397bf9bd4c30. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 93298d06-3fff-4626-8e13-397bf9bd4c30'.'
WARNING: Unable to acquire token for tenant '218094f2-2976-4255-a15c-4008e6c8a18b' with error 'Authentication failed against tenant 218094f2-2976-4255-a15c-4008e6c8a18b. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 218094f2-2976-4255-a15c-4008e6c8a18b'.'

✓ PASS - Subscription Access
  Details: Accessible subscriptions: 3

  Subscription Details:
    - MSDN Platforms Subscription (ab1336c7-687d-4107-b0f6-9649a0458adb) - State: Enabled
    - Azure subscription 1 (9f51cccf-950f-45d3-b2bf-df25d614c4d2) - State: Enabled
    - Pay-As-You-Go (332b96cc-1d4e-439c-b88f-c3ab0fec466c) - State: Enabled
[2026-01-29 11:15:50] [INFO] Checking RBAC permissions on subscriptions...
WARNING: Unable to acquire token for tenant '28a0fe2d-1db4-4c3e-9a58-142d0f38e709' with error 'Authentication failed against tenant 28a0fe2d-1db4-4c3e-9a58-142d0f38e709. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 28a0fe2d-1db4-4c3e-9a58-142d0f38e709'.'
WARNING: Unable to acquire token for tenant '93298d06-3fff-4626-8e13-397bf9bd4c30' with error 'Authentication failed against tenant 93298d06-3fff-4626-8e13-397bf9bd4c30. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 93298d06-3fff-4626-8e13-397bf9bd4c30'.'
WARNING: Unable to acquire token for tenant '218094f2-2976-4255-a15c-4008e6c8a18b' with error 'Authentication failed against tenant 218094f2-2976-4255-a15c-4008e6c8a18b. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 218094f2-2976-4255-a15c-4008e6c8a18b'.'
WARNING: Unable to acquire token for tenant '' with error 'Authentication failed against tenant 28a0fe2d-1db4-4c3e-9a58-142d0f38e709. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 28a0fe2d-1db4-4c3e-9a58-142d0f38e709'.'
WARNING: Unable to acquire token for tenant '' with error 'Authentication failed against tenant 93298d06-3fff-4626-8e13-397bf9bd4c30. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 93298d06-3fff-4626-8e13-397bf9bd4c30'.'
WARNING: Unable to acquire token for tenant '' with error 'Authentication failed against tenant 218094f2-2976-4255-a15c-4008e6c8a18b. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 218094f2-2976-4255-a15c-4008e6c8a18b'.'

✗ FAIL - RBAC Permissions (Sample: MSDN Platforms Subscription)
  Details: Current roles: 
. Required: Reader, Contributor, or Owner
  Remediation: Contact subscription owner to grant Reader role: New-AzRoleAssignment -SignInName 'theregniers@hotmail.com' -RoleDefinitionName 'Reader' -Scope '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb'

  Minimum Required Permissions for Discovery:
    - Reader role at subscription scope (for inventory)
    - Optional: User Access Administrator (for RBAC owner/contributor enumeration)

  Minimum Required Permissions for Policy Deployment (Story 1.2):
    - Contributor role at subscription scope
    - Resource Policy Contributor role (or Owner)
[2026-01-29 11:15:53] [INFO] Checking access to required Resource Providers...
WARNING: Unable to acquire token for tenant '28a0fe2d-1db4-4c3e-9a58-142d0f38e709' with error 'Authentication failed against tenant 28a0fe2d-1db4-4c3e-9a58-142d0f38e709. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 28a0fe2d-1db4-4c3e-9a58-142d0f38e709'.'
WARNING: Unable to acquire token for tenant '93298d06-3fff-4626-8e13-397bf9bd4c30' with error 'Authentication failed against tenant 93298d06-3fff-4626-8e13-397bf9bd4c30. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 93298d06-3fff-4626-8e13-397bf9bd4c30'.'
WARNING: Unable to acquire token for tenant '218094f2-2976-4255-a15c-4008e6c8a18b' with error 'Authentication failed against tenant 218094f2-2976-4255-a15c-4008e6c8a18b. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 218094f2-2976-4255-a15c-4008e6c8a18b'.'
WARNING: Unable to acquire token for tenant '' with error 'Authentication failed against tenant 28a0fe2d-1db4-4c3e-9a58-142d0f38e709. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 28a0fe2d-1db4-4c3e-9a58-142d0f38e709'.'
WARNING: Unable to acquire token for tenant '' with error 'Authentication failed against tenant 93298d06-3fff-4626-8e13-397bf9bd4c30. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 93298d06-3fff-4626-8e13-397bf9bd4c30'.'
WARNING: Unable to acquire token for tenant '' with error 'Authentication failed against tenant 218094f2-2976-4255-a15c-4008e6c8a18b. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 218094f2-2976-4255-a15c-4008e6c8a18b'.'
  ✓ Microsoft.KeyVault - Registered
  ✓ Microsoft.PolicyInsights - Registered
  ✓ Microsoft.Authorization - Registered

✓ PASS - Resource Provider Access
  Details: Checked sample subscription: MSDN Platforms Subscription
[2026-01-29 11:16:06] [INFO]
[2026-01-29 11:16:06] [HEADER] =====================================================================
[2026-01-29 11:16:06] [HEADER] VALIDATION SUMMARY
[2026-01-29 11:16:06] [HEADER] =====================================================================
[2026-01-29 11:16:06] [INFO]
[2026-01-29 11:16:06] [WARN] Checks Passed: 5 / 6
  ✓ PASS - AzureConnection
  ✓ PASS - AzureModules
  ✓ PASS - ResourceProviderAccess
  ✓ PASS - RBACPermissions
  ✓ PASS - SubscriptionAccess
  ✓ PASS - PowerShellVersion
[2026-01-29 11:16:06] [INFO]
[2026-01-29 11:16:06] [ERROR] ✗ Some prerequisites not met. Review failures above.
[2026-01-29 11:16:06] [INFO]
[2026-01-29 11:16:06] [WARN] Common Resolutions:
**********************
PowerShell transcript end
End time: 20260129111606
**********************
