# v1.0 Feature Enhancement Testing Plan

**Date**: January 20, 2026  
**Purpose**: Validate all v1.0 enhancements before release

---

## üéØ TEST OBJECTIVES

1. Verify all 8 feature enhancements work correctly
2. Validate console next-steps for each workflow
3. Validate HTML next-steps for each report type
4. Ensure documentation matches actual behavior

---

## ‚úÖ TEST SCENARIOS

### Test 1: Interactive Menu (`-Interactive`)

**Command**:
```powershell
.\AzPolicyImplScript.ps1 -Interactive
```

**Expected Behavior**:
- ‚úÖ Shows "Azure Policy Implementation Assistant" header
- ‚úÖ Prompts for environment preset (DevTest/Production/Custom)
- ‚úÖ Prompts for policy scope (All 46/Critical only/Custom)
- ‚úÖ Loads selected parameter file
- ‚úÖ Applies policy filter if custom selection chosen

**Validation**:
- [ ] Menu displays correctly
- [ ] Selection 1 (DevTest) loads PolicyParameters-DevTest.json
- [ ] Selection 2 (Production) loads PolicyParameters-Production.json
- [ ] Selection 3 (Custom) uses PolicyParameters.json
- [ ] Critical policies filter (7 policies) works correctly

**Console Next-Steps Expected**:
```
üìã Next Steps:
  1. Review deployment logs above
  2. Check Azure Portal for policy assignments
  3. Wait 24-48 hours for compliance data
  4. Run compliance check: .\AzPolicyImplScript.ps1 -CheckCompliance
```

---

### Test 2: Color-Coded Console Output

**Command**:
```powershell
.\AzPolicyImplScript.ps1 -TestInfrastructure -Detailed
```

**Expected Behavior**:
- ‚úÖ `[ERROR]` messages in RED
- ‚úÖ `[WARN]` messages in YELLOW
- ‚úÖ `[INFO]` messages in CYAN
- ‚úÖ `[SUCCESS]` messages in GREEN

**Validation**:
- [ ] Error messages (if any) show in red
- [ ] Warning messages show in yellow
- [ ] Info messages show in cyan
- [ ] Success messages show in green
- [ ] Timestamps show in gray

**Console Next-Steps Expected**:
```
üìã Next Steps:
  1. Review validation results above
  2. Fix any FAILED checks before proceeding
  3. If all PASS, proceed to policy deployment
```

---

### Test 3: Console Next-Steps - DevTest Deployment

**Command**:
```powershell
# Using shortcut (if we add it)
.\AzPolicyImplScript.ps1 -DeployDevTest -SkipRBACCheck -DryRun

# OR using current syntax
.\AzPolicyImplScript.ps1 -ParameterFile .\PolicyParameters-DevTest.json -SkipRBACCheck -DryRun
```

**Expected Behavior**:
- ‚úÖ Deployment summary shows 30 policies
- ‚úÖ Console displays duration
- ‚úÖ Next-steps guidance specific to DevTest phase

**Console Next-Steps Expected**:
```
üìã Next Steps:
  1. Remove -DryRun flag to execute actual deployment
  2. Wait 24-48 hours for compliance data collection
  3. Run compliance check: .\AzPolicyImplScript.ps1 -CheckCompliance -TriggerScan
  4. Review HTML compliance report
  5. If successful, proceed to Production Audit:
     .\AzPolicyImplScript.ps1 -ParameterFile .\PolicyParameters-Production.json -SkipRBACCheck
```

**Validation**:
- [ ] Next-steps mention removing -DryRun
- [ ] Next-steps mention 24-48 hour wait
- [ ] Next-steps provide compliance check command
- [ ] Next-steps suggest Production deployment

---

### Test 4: Console Next-Steps - Production Audit

**Command**:
```powershell
.\AzPolicyImplScript.ps1 -ParameterFile .\PolicyParameters-Production.json -SkipRBACCheck -DryRun
```

**Expected Behavior**:
- ‚úÖ Deployment summary shows 46 policies
- ‚úÖ Confirms Audit mode (not Deny)
- ‚úÖ Next-steps guidance specific to Production Audit

**Console Next-Steps Expected**:
```
üìã Next Steps:
  1. Remove -DryRun flag to execute actual deployment
  2. Wait 24-48 hours for compliance data collection
  3. Run compliance check: .\AzPolicyImplScript.ps1 -CheckCompliance -TriggerScan
  4. Review HTML compliance report
  5. Analyze non-compliant resources and plan remediation
  6. Review exemption requests (see PRE-DEPLOYMENT-CHECKLIST.md)
  7. When ready (after 30-90 days audit), enable enforcement by setting effect=Deny in parameter file
```

**Validation**:
- [ ] Next-steps mention 30-90 day audit period
- [ ] Next-steps reference PRE-DEPLOYMENT-CHECKLIST.md
- [ ] Next-steps explain how to enable Deny mode
- [ ] Next-steps don't suggest immediate enforcement

---

### Test 5: Console Next-Steps - Infrastructure Test

**Command**:
```powershell
.\AzPolicyImplScript.ps1 -TestInfrastructure -Detailed
```

**Expected Behavior**:
- ‚úÖ Runs 11 validation checks
- ‚úÖ Shows PASS/FAIL for each check
- ‚úÖ Next-steps based on validation results

**Console Next-Steps Expected** (if all PASS):
```
üìã Next Steps:
  ‚úÖ Infrastructure validated successfully!
  
  1. Proceed to DevTest deployment:
     .\AzPolicyImplScript.ps1 -ParameterFile .\PolicyParameters-DevTest.json -SkipRBACCheck
  
  2. OR deploy DevTest Full (46 policies):
     .\AzPolicyImplScript.ps1 -ParameterFile .\PolicyParameters-DevTest-Full.json -SkipRBACCheck
```

**Console Next-Steps Expected** (if any FAIL):
```
üìã Next Steps:
  ‚ö†Ô∏è Infrastructure validation found issues!
  
  1. Review FAILED checks above
  2. Fix issues before proceeding to deployment
  3. Common fixes:
     - Resource Group: Run Setup-AzureKeyVaultPolicyEnvironment.ps1
     - Managed Identity: Assign Key Vault Contributor role
     - RBAC: Request Policy Contributor role on subscription
  4. Re-run validation: .\AzPolicyImplScript.ps1 -TestInfrastructure -Detailed
```

**Validation**:
- [ ] Next-steps conditional on test results
- [ ] PASS scenario suggests deployment
- [ ] FAIL scenario provides troubleshooting steps

---

### Test 6: HTML Report Next-Steps - Compliance Check

**Command**:
```powershell
.\AzPolicyImplScript.ps1 -CheckCompliance -TriggerScan
```

**Expected Behavior**:
- ‚úÖ Generates `ComplianceReport-<timestamp>.html`
- ‚úÖ Report includes "üìã Next Steps" section
- ‚úÖ Next-steps show 3-phase progression (Audit‚ÜíDeny‚ÜíEnforce)

**HTML Next-Steps Expected**:
```html
<h2>üìã Next Steps</h2>
<div class="next-steps">
  <h3>Phase 1: Review & Remediate (Current - Weeks 1-4)</h3>
  <ol>
    <li><strong>Analyze compliance data</strong>: Review tables above...</li>
    <li><strong>Plan remediation</strong>: For each non-compliant resource...</li>
    <li><strong>Update deployment templates</strong>: ARM/Bicep/Terraform...</li>
    <li><strong>Re-check compliance</strong>: .\AzPolicyImplScript.ps1 -CheckCompliance</li>
  </ol>
  
  <h3>Phase 2: Test Deny Mode (Weeks 5-12)</h3>
  <ol start="5">
    <li><strong>Deploy Deny mode in dev/test</strong>...</li>
    <li><strong>Deploy Deny mode in production</strong>...</li>
    <li><strong>Monitor blocked operations</strong>: 60-90 days...</li>
  </ol>
  
  <h3>Phase 3: Enable Enforce Mode (Week 13+)</h3>
  <ol start="9">
    <li><strong>Configure auto-remediation</strong>...</li>
    <li><strong>Enable Enforce mode</strong>...</li>
    <li><strong>Monitor remediation tasks</strong>...</li>
  </ol>
</div>
```

**Validation**:
- [ ] HTML report has "Next Steps" section
- [ ] Shows 3 phases (Review, Deny, Enforce)
- [ ] Each phase has numbered steps
- [ ] Steps are actionable with PowerShell commands
- [ ] Best practice warning at bottom

---

### Test 7: HTML Report Remediation Guidance

**Command**:
```powershell
.\AzPolicyImplScript.ps1 -CheckCompliance -TriggerScan
```

**Expected Behavior**:
- ‚úÖ For each non-compliant policy, shows yellow remediation box
- ‚úÖ Remediation box includes "Why Non-Compliant", "How to Fix", "PowerShell" commands

**HTML Remediation Box Expected** (for soft delete policy):
```html
<div style='margin-top: 10px; padding: 12px; background: #fff3cd; border-left: 3px solid #ffc107;'>
  <strong style='color: #856404;'>üîß Remediation Guide:</strong><br>
  <div style='color: #856404; margin-top: 8px; line-height: 1.6;'>
    <strong>Why Non-Compliant:</strong> Key Vault does not have soft delete enabled...<br>
    <strong>How to Fix:</strong> Cannot be enabled post-creation. Resource must be recreated...<br>
    <strong>PowerShell:</strong> <code>New-AzKeyVault -EnableSoftDelete -EnablePurgeProtection</code>
  </div>
</div>
```

**Validation**:
- [ ] Yellow remediation boxes appear for non-compliant policies
- [ ] Each box has "Why Non-Compliant" section
- [ ] Each box has "How to Fix" section
- [ ] Each box has PowerShell command examples
- [ ] Commands are copy-paste ready (in <code> tags)

---

### Test 8: RBAC Documentation Verification

**Location**: `DEPLOYMENT-PREREQUISITES.md` lines 168-228

**Validation**:
- [ ] "When to Use -SkipRBACCheck" section exists
- [ ] 4 use cases listed (CI/CD, Testing, Repeated, Non-Interactive)
- [ ] "When NOT to Use" section exists
- [ ] 3 scenarios listed (First-time, Production, Uncertain)
- [ ] "Impact of Skipping" section explains consequences
- [ ] PowerShell examples are accurate

---

### Test 9: Pre-Deployment Checklist Verification

**Location**: `PRE-DEPLOYMENT-CHECKLIST.md`

**Validation**:
- [ ] 8 deployment phases covered (Infrastructure ‚Üí Ongoing Maintenance)
- [ ] Each phase has checkboxes for validation steps
- [ ] Each phase has "Go/No-Go Decision" section
- [ ] Each phase has sign-off line
- [ ] Acceptance thresholds table exists (lines 570-582)
- [ ] Rollback procedures documented (lines 585-620)

---

### Test 10: Email Alert Configuration Verification

**Location**: `EMAIL-ALERT-CONFIGURATION.md`

**Validation**:
- [ ] Action Group setup instructions exist (Step 1)
- [ ] 5 alert rules documented (Step 2)
- [ ] Alert Rule #1: Policy Assignment Deleted (PowerShell + Portal)
- [ ] Alert Rule #3: Remediation Task Failures (PowerShell + Portal)
- [ ] Email testing instructions (Step 3)
- [ ] Troubleshooting section exists
- [ ] Sample email notification examples

---

## üß™ EXECUTION PLAN

### Phase 1: Quick Validation (5 minutes)
```powershell
# 1. Test infrastructure validation
.\AzPolicyImplScript.ps1 -TestInfrastructure -Detailed

# 2. Test interactive menu (press Ctrl+C to cancel)
.\AzPolicyImplScript.ps1 -Interactive

# 3. Test dry-run deployment
.\AzPolicyImplScript.ps1 -ParameterFile .\PolicyParameters-DevTest.json -DryRun -SkipRBACCheck
```

### Phase 2: Documentation Review (10 minutes)
- [ ] Read DEPLOYMENT-PREREQUISITES.md RBAC section
- [ ] Scan PRE-DEPLOYMENT-CHECKLIST.md structure
- [ ] Review EMAIL-ALERT-CONFIGURATION.md alert rules

### Phase 3: HTML Report Validation (5 minutes)
```powershell
# Generate sample compliance report (requires policies deployed)
.\AzPolicyImplScript.ps1 -CheckCompliance

# Open HTML report in browser
Invoke-Item (Get-ChildItem "ComplianceReport-*.html" | Sort-Object LastWriteTime | Select-Object -Last 1).FullName

# Verify:
# - Next Steps section exists
# - Remediation guidance appears for non-compliant policies
# - 3-phase progression shown
```

### Phase 4: Console Output Review (10 minutes)
```powershell
# Run various commands and verify console next-steps:

# Infrastructure test
.\AzPolicyImplScript.ps1 -TestInfrastructure -Detailed | Out-File -FilePath ".\test-output-infrastructure.txt"

# DevTest dry-run
.\AzPolicyImplScript.ps1 -ParameterFile .\PolicyParameters-DevTest.json -DryRun -SkipRBACCheck | Out-File -FilePath ".\test-output-devtest.txt"

# Production dry-run
.\AzPolicyImplScript.ps1 -ParameterFile .\PolicyParameters-Production.json -DryRun -SkipRBACCheck | Out-File -FilePath ".\test-output-production.txt"

# Review output files for correct next-steps
```

---

## üìä TEST RESULTS TRACKING

| Test | Status | Notes | Evidence File |
|------|--------|-------|---------------|
| 1. Interactive Menu | ‚è≥ | | |
| 2. Color-Coded Output | ‚è≥ | | |
| 3. Console Next-Steps - DevTest | ‚è≥ | | test-output-devtest.txt |
| 4. Console Next-Steps - Production | ‚è≥ | | test-output-production.txt |
| 5. Console Next-Steps - Infrastructure | ‚è≥ | | test-output-infrastructure.txt |
| 6. HTML Report Next-Steps | ‚è≥ | | ComplianceReport-*.html |
| 7. HTML Remediation Guidance | ‚è≥ | | ComplianceReport-*.html |
| 8. RBAC Documentation | ‚è≥ | | DEPLOYMENT-PREREQUISITES.md |
| 9. Pre-Deployment Checklist | ‚è≥ | | PRE-DEPLOYMENT-CHECKLIST.md |
| 10. Email Alert Configuration | ‚è≥ | | EMAIL-ALERT-CONFIGURATION.md |

---

## ‚úÖ ACCEPTANCE CRITERIA

**All tests must PASS before v1.0 release distribution:**

- ‚úÖ Interactive menu works correctly
- ‚úÖ Color-coded output displays in correct colors
- ‚úÖ Console next-steps are workflow-specific and actionable
- ‚úÖ HTML next-steps show 3-phase progression
- ‚úÖ HTML remediation guidance appears for non-compliant policies
- ‚úÖ Documentation accurate and complete

---

## üêõ ISSUES FOUND

**Issue Tracking**: Record any issues discovered during testing

| Issue # | Description | Severity | Status | Fix |
|---------|-------------|----------|--------|-----|
| | | | | |

---

**END OF TEST PLAN**
