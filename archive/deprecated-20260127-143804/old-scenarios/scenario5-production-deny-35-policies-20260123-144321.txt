**********************
PowerShell transcript start
Start time: 20260123144321
Username: DTL01\lcladmin
RunAs User: DTL01\lcladmin
Configuration Name: 
Machine: DTL01 (Microsoft Windows NT 10.0.20348.0)
Host Application: C:\Program Files\PowerShell\7\pwsh.dll -noexit -command try { . "c:\Program Files\Microsoft VS Code\resources\app\out\vs\workbench\contrib\terminal\common\scripts\shellIntegration.ps1" } catch {}
Process ID: 10740
PSVersion: 7.5.3
PSEdition: Core
GitCommitId: 7.5.3
OS: Microsoft Windows 10.0.20348
Platform: Win32NT
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1, 6.0, 7.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
WSManStackVersion: 3.0
**********************

ğŸš€ Starting deployment...
Command: .\AzPolicyImplScript.ps1
  -SkipRBACCheck
  -Preview
  -ParameterFile C:\Source\powershell-akv-policyhardening\PolicyParameters-Production-Deny.json


â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  Azure Policy Implementation - Key Vault Governance          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[2026-01-23 14:43:22Z]
[INFO]
Starting Azure Policy implementation script for Key Vault policies
[2026-01-23 14:43:22Z]
[INFO]
Checking required PowerShell modules...
[2026-01-23 14:43:22Z]
[SUCCESS]
Module Az.Accounts is present
[2026-01-23 14:43:22Z]
[SUCCESS]
Module Az.Resources is present
[2026-01-23 14:43:22Z]
[SUCCESS]
Module Az.PolicyInsights is present
[2026-01-23 14:43:22Z]
[SUCCESS]
Module Az.Monitor is present
[2026-01-23 14:43:22Z]
[SUCCESS]
Module Az.KeyVault is present
[2026-01-23 14:43:23Z]
[INFO]
Using Azure context: theregniers@hotmail.com
[2026-01-23 14:43:23Z]
[INFO]
Loading policy mapping from ./PolicyNameMapping.json
[2026-01-23 14:43:23Z]
[INFO]
Loaded 3745 policy mappings
[2026-01-23 14:43:23Z]
[INFO]
Loading policy parameter overrides from C:\Source\powershell-akv-policyhardening\PolicyParameters-Production-Deny.json
[2026-01-23 14:43:23Z]
[INFO]
Detected deployment type: Custom (from parameter file: PolicyParameters-Production-Deny.json)
[2026-01-23 14:43:23Z]
[INFO]
Preview mode enabled: setting DryRun and skipping RBAC checks.
[2026-01-23 14:43:23Z]
[INFO]
DEBUG: PSBoundParameters keys: SkipRBACCheck, CsvPath, Preview, ParameterOverridesPath
[2026-01-23 14:43:23Z]
[INFO]
DEBUG: ScopeType value: ''
[2026-01-23 14:43:23Z]
[INFO]
Dry-run mode: using Subscription scope by default
[2026-01-23 14:43:23Z]
[INFO]
Checking current subscription context.
[2026-01-23 14:43:23Z]
[INFO]
Current subscription: MSDN Platforms Subscription (ab1336c7-687d-4107-b0f6-9649a0458adb)
[2026-01-23 14:43:23Z]
[INFO]
Dry-run mode: using current subscription context
[2026-01-23 14:43:23Z]
[INFO]
Preview mode: skipped RBAC permission check.
[2026-01-23 14:43:23Z]
[INFO]
Using policy effects from parameter file: C:\Source\powershell-akv-policyhardening\PolicyParameters-Production-Deny.json

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  â„¹ï¸  Production Configuration Detected (Audit Mode)            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  Using production parameters in Audit mode (recommended first step)
  No resources will be blocked during this deployment

[2026-01-23 14:43:23Z]
[SUCCESS]
Loaded 34 policies from parameter file: C:\Source\powershell-akv-policyhardening\PolicyParameters-Production-Deny.json

Processing 34 policies...
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

[2026-01-23 14:43:23Z]
[INFO]
Preparing to assign (1/34): Certificates using RSA cryptography should have the specified minimum key size
[2026-01-23 14:43:23Z]
[INFO]
Assigning policy 'Certificates using RSA cryptography should have the specified minimum key size' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-23 14:43:23Z]
[SUCCESS]
Found 'Certificates using RSA cryptography should have the specified minimum key size' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/cee51871-e572-4576-855c-047c820360f0
[2026-01-23 14:43:28Z]
[INFO]
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-23 14:43:28Z]
[INFO]
DEBUG: Defined parameter names: minimumRSAKeySize, effect
[2026-01-23 14:43:28Z]
[INFO]
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-23 14:43:28Z]
[INFO]
DEBUG: Checking parameter 'minimumRSAKeySize' against policy definition
[2026-01-23 14:43:28Z]
[INFO]
DEBUG: Defined parameter names: minimumRSAKeySize, effect
[2026-01-23 14:43:28Z]
[INFO]
DEBUG: Added parameter 'minimumRSAKeySize' = '4096' to cleaned params
[2026-01-23 14:43:28Z]
[INFO]
Dry-run: would create assignment with name CertificatesusingRSAcryptographyshouldhavethespecifie-2031578458 and params: 
Name                           Value
----                           -----
effect                         Deny
minimumRSAKeySize              4096

[2026-01-23 14:43:28Z]
[INFO]
Preparing to assign (2/34): Keys should have more than the specified number of days before expiration
[2026-01-23 14:43:28Z]
[INFO]
Assigning policy 'Keys should have more than the specified number of days before expiration' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-23 14:43:28Z]
[SUCCESS]
Found 'Keys should have more than the specified number of days before expiration' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/5ff38825-c5d8-47c5-b70e-069a21955146
[2026-01-23 14:43:28Z]
[INFO]
DEBUG: Checking parameter 'minimumDaysBeforeExpiration' against policy definition
[2026-01-23 14:43:28Z]
[INFO]
DEBUG: Defined parameter names: minimumDaysBeforeExpiration, effect
[2026-01-23 14:43:28Z]
[INFO]
DEBUG: Added parameter 'minimumDaysBeforeExpiration' = '90' to cleaned params
[2026-01-23 14:43:28Z]
[INFO]
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-23 14:43:28Z]
[INFO]
DEBUG: Defined parameter names: minimumDaysBeforeExpiration, effect
[2026-01-23 14:43:28Z]
[INFO]
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-23 14:43:28Z]
[INFO]
Dry-run: would create assignment with name Keysshouldhavemorethanthespecifiednumberofdaysbeforeexp-12464927 and params: 
Name                           Value
----                           -----
minimumDaysBeforeExpiration    90
effect                         Deny

[2026-01-23 14:43:28Z]
[INFO]
Preparing to assign (3/34): Azure Key Vault should disable public network access
[2026-01-23 14:43:28Z]
[INFO]
Assigning policy 'Azure Key Vault should disable public network access' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-23 14:43:28Z]
[SUCCESS]
Found 'Azure Key Vault should disable public network access' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/405c5871-3e91-4644-8a63-58e19d68ff5b
[2026-01-23 14:43:29Z]
[INFO]
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-23 14:43:29Z]
[INFO]
DEBUG: Defined parameter names: effect
[2026-01-23 14:43:29Z]
[INFO]
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-23 14:43:29Z]
[INFO]
Dry-run: would create assignment with name AzureKeyVaultshoulddisablepublicnetworkaccess-906277113 and params: 
Name                           Value
----                           -----
effect                         Deny

[2026-01-23 14:43:29Z]
[INFO]
Preparing to assign (4/34): Secrets should not be active for longer than the specified number of days
[2026-01-23 14:43:29Z]
[INFO]
Assigning policy 'Secrets should not be active for longer than the specified number of days' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-23 14:43:29Z]
[SUCCESS]
Found 'Secrets should not be active for longer than the specified number of days' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/e8d99835-8a06-45ae-a8e0-87a91941ccfe
[2026-01-23 14:43:29Z]
[INFO]
DEBUG: Checking parameter 'maximumValidityInDays' against policy definition
[2026-01-23 14:43:29Z]
[INFO]
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-23 14:43:29Z]
[INFO]
DEBUG: Added parameter 'maximumValidityInDays' = '365' to cleaned params
[2026-01-23 14:43:29Z]
[INFO]
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-23 14:43:29Z]
[INFO]
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-23 14:43:29Z]
[INFO]
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-23 14:43:29Z]
[INFO]
Dry-run: would create assignment with name Secretsshouldnotbeactiveforlongerthanthespecifiednumb-1452013840 and params: 
Name                           Value
----                           -----
maximumValidityInDays          365
effect                         Deny

[2026-01-23 14:43:29Z]
[INFO]
Preparing to assign (5/34): Keys using elliptic curve cryptography should have the specified curve names
[2026-01-23 14:43:29Z]
[INFO]
Assigning policy 'Keys using elliptic curve cryptography should have the specified curve names' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-23 14:43:29Z]
[SUCCESS]
Found 'Keys using elliptic curve cryptography should have the specified curve names' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/ff25f3c8-b739-4538-9d07-3d6d25cfb255
[2026-01-23 14:43:29Z]
[INFO]
DEBUG: Checking parameter 'allowedECNames' against policy definition
[2026-01-23 14:43:29Z]
[INFO]
DEBUG: Defined parameter names: allowedECNames, effect
[2026-01-23 14:43:30Z]
[INFO]
DEBUG: Added parameter 'allowedECNames' = 'P-256 P-256K P-384 P-521' to cleaned params
[2026-01-23 14:43:30Z]
[INFO]
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-23 14:43:30Z]
[INFO]
DEBUG: Defined parameter names: allowedECNames, effect
[2026-01-23 14:43:30Z]
[INFO]
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-23 14:43:30Z]
[INFO]
Dry-run: would create assignment with name Keysusingellipticcurvecryptographyshouldhavethespecif-1437325202 and params: 
Name                           Value
----                           -----
allowedECNames                 {P-256, P-256K, P-384, P-521}
effect                         Deny

[2026-01-23 14:43:30Z]
[INFO]
Preparing to assign (6/34): Certificates should be issued by one of the specified non-integrated certificate authorities
[2026-01-23 14:43:30Z]
[INFO]
Assigning policy 'Certificates should be issued by one of the specified non-integrated certificate authorities' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-23 14:43:30Z]
[SUCCESS]
Found 'Certificates should be issued by one of the specified non-integrated certificate authorities' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/d3e82b87-6673-410b-8501-1896b688b9a3
[2026-01-23 14:43:30Z]
[INFO]
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-23 14:43:30Z]
[INFO]
DEBUG: Defined parameter names: caCommonNames, effect
[2026-01-23 14:43:30Z]
[INFO]
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-23 14:43:30Z]
[INFO]
DEBUG: Checking parameter 'caCommonNames' against policy definition
[2026-01-23 14:43:30Z]
[INFO]
DEBUG: Defined parameter names: caCommonNames, effect
[2026-01-23 14:43:30Z]
[INFO]
DEBUG: Added parameter 'caCommonNames' = 'ContosoCA FabrikamCA' to cleaned params
[2026-01-23 14:43:30Z]
[INFO]
Dry-run: would create assignment with name Certificatesshouldbeissuedbyoneofthespecifiednonintegr-165973907 and params: 
Name                           Value
----                           -----
effect                         Deny
caCommonNames                  {ContosoCA, FabrikamCA}

[2026-01-23 14:43:31Z]
[INFO]
Preparing to assign (7/34): Certificates should have the specified maximum validity period
[2026-01-23 14:43:31Z]
[INFO]
Assigning policy 'Certificates should have the specified maximum validity period' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-23 14:43:31Z]
[SUCCESS]
Found 'Certificates should have the specified maximum validity period' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/0a075868-4c26-42ef-914c-5bc007359560
[2026-01-23 14:43:31Z]
[INFO]
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-23 14:43:31Z]
[INFO]
DEBUG: Defined parameter names: maximumValidityInMonths, effect
[2026-01-23 14:43:31Z]
[INFO]
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-23 14:43:31Z]
[INFO]
DEBUG: Checking parameter 'maximumValidityInMonths' against policy definition
[2026-01-23 14:43:31Z]
[INFO]
DEBUG: Defined parameter names: maximumValidityInMonths, effect
[2026-01-23 14:43:31Z]
[INFO]
DEBUG: Added parameter 'maximumValidityInMonths' = '12' to cleaned params
[2026-01-23 14:43:31Z]
[INFO]
Dry-run: would create assignment with name Certificatesshouldhavethespecifiedmaximumvalidityperio-407807336 and params: 
Name                           Value
----                           -----
maximumValidityInMonths        12
effect                         Deny

[2026-01-23 14:43:31Z]
[INFO]
Preparing to assign (8/34): Certificates should not expire within the specified number of days
[2026-01-23 14:43:31Z]
[INFO]
Assigning policy 'Certificates should not expire within the specified number of days' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-23 14:43:31Z]
[SUCCESS]
Found 'Certificates should not expire within the specified number of days' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/f772fb64-8e40-40ad-87bc-7706e1949427
[2026-01-23 14:43:31Z]
[INFO]
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-23 14:43:31Z]
[INFO]
DEBUG: Defined parameter names: daysToExpire, effect
[2026-01-23 14:43:31Z]
[INFO]
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-23 14:43:31Z]
[INFO]
DEBUG: Checking parameter 'daysToExpire' against policy definition
[2026-01-23 14:43:31Z]
[INFO]
DEBUG: Defined parameter names: daysToExpire, effect
[2026-01-23 14:43:31Z]
[INFO]
DEBUG: Added parameter 'daysToExpire' = '90' to cleaned params
[2026-01-23 14:43:31Z]
[INFO]
Dry-run: would create assignment with name Certificatesshouldnotexpirewithinthespecifiednumberof-2114192775 and params: 
Name                           Value
----                           -----
effect                         Deny
daysToExpire                   90

[2026-01-23 14:43:31Z]
[INFO]
Preparing to assign (9/34): Keys should be the specified cryptographic type RSA or EC
[2026-01-23 14:43:31Z]
[INFO]
Assigning policy 'Keys should be the specified cryptographic type RSA or EC' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-23 14:43:31Z]
[SUCCESS]
Found 'Keys should be the specified cryptographic type RSA or EC' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/75c4f823-d65c-4f29-a733-01d0077fdbcb
[2026-01-23 14:43:32Z]
[INFO]
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-23 14:43:32Z]
[INFO]
DEBUG: Defined parameter names: allowedKeyTypes, effect
[2026-01-23 14:43:32Z]
[INFO]
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-23 14:43:32Z]
[INFO]
DEBUG: Checking parameter 'cryptographicType' against policy definition
[2026-01-23 14:43:32Z]
[INFO]
DEBUG: Defined parameter names: allowedKeyTypes, effect
[2026-01-23 14:43:32Z]
[WARN]
DEBUG: Parameter 'cryptographicType' NOT FOUND in policy definition - SKIPPED
[2026-01-23 14:43:32Z]
[WARN]
Parameter 'cryptographicType' not defined in policy. Skipping to avoid UndefinedPolicyParameter error.
[2026-01-23 14:43:32Z]
[INFO]
Dry-run: would create assignment with name KeysshouldbethespecifiedcryptographictypeRSAorEC-976981238 and params: 
Name                           Value
----                           -----
effect                         Deny

[2026-01-23 14:43:32Z]
[INFO]
Preparing to assign (10/34): [Preview]: Azure Key Vault Managed HSM keys using elliptic curve cryptography should have the specified curve names
[2026-01-23 14:43:32Z]
[INFO]
Assigning policy '[Preview]: Azure Key Vault Managed HSM keys using elliptic curve cryptography should have the specified curve names' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-23 14:43:32Z]
[SUCCESS]
Found '[Preview]: Azure Key Vault Managed HSM keys using elliptic curve cryptography should have the specified curve names' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/e58fd0c1-feac-4d12-92db-0a7e9421f53e
[2026-01-23 14:43:32Z]
[INFO]
DEBUG: Checking parameter 'allowedECNames' against policy definition
[2026-01-23 14:43:32Z]
[INFO]
DEBUG: Defined parameter names: allowedECNames, effect
[2026-01-23 14:43:32Z]
[INFO]
DEBUG: Added parameter 'allowedECNames' = 'P-256 P-256K P-384 P-521' to cleaned params
[2026-01-23 14:43:32Z]
[INFO]
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-23 14:43:32Z]
[INFO]
DEBUG: Defined parameter names: allowedECNames, effect
[2026-01-23 14:43:32Z]
[INFO]
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-23 14:43:32Z]
[INFO]
Dry-run: would create assignment with name PreviewAzureKeyVaultManagedHSMkeysusingellipticcurvecr-518169623 and params: 
Name                           Value
----                           -----
allowedECNames                 {P-256, P-256K, P-384, P-521}
effect                         Deny

[2026-01-23 14:43:32Z]
[INFO]
Preparing to assign (11/34): Key Vault secrets should have an expiration date
[2026-01-23 14:43:32Z]
[INFO]
Assigning policy 'Key Vault secrets should have an expiration date' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-23 14:43:32Z]
[SUCCESS]
Found 'Key Vault secrets should have an expiration date' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/98728c90-32c7-4049-8429-847dc0f4fe37
[2026-01-23 14:43:33Z]
[INFO]
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-23 14:43:33Z]
[INFO]
DEBUG: Defined parameter names: effect
[2026-01-23 14:43:33Z]
[INFO]
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-23 14:43:33Z]
[INFO]
Dry-run: would create assignment with name KeyVaultsecretsshouldhaveanexpirationdate-1232117220 and params: 
Name                           Value
----                           -----
effect                         Deny

[2026-01-23 14:43:33Z]
[INFO]
Preparing to assign (12/34): [Preview]: Azure Key Vault Managed HSM Keys should have more than the specified number of days before expiration
[2026-01-23 14:43:33Z]
[INFO]
Assigning policy '[Preview]: Azure Key Vault Managed HSM Keys should have more than the specified number of days before expiration' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-23 14:43:33Z]
[SUCCESS]
Found '[Preview]: Azure Key Vault Managed HSM Keys should have more than the specified number of days before expiration' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/ad27588c-0198-4c84-81ef-08efd0274653
[2026-01-23 14:43:33Z]
[INFO]
DEBUG: Checking parameter 'minimumDaysBeforeExpiration' against policy definition
[2026-01-23 14:43:33Z]
[INFO]
DEBUG: Defined parameter names: effect, minimumDaysBeforeExpiration
[2026-01-23 14:43:33Z]
[INFO]
DEBUG: Added parameter 'minimumDaysBeforeExpiration' = '30' to cleaned params
[2026-01-23 14:43:33Z]
[INFO]
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-23 14:43:33Z]
[INFO]
DEBUG: Defined parameter names: effect, minimumDaysBeforeExpiration
[2026-01-23 14:43:33Z]
[INFO]
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-23 14:43:33Z]
[INFO]
Dry-run: would create assignment with name PreviewAzureKeyVaultManagedHSMKeysshouldhavemorethant-1035226701 and params: 
Name                           Value
----                           -----
minimumDaysBeforeExpiration    30
effect                         Deny

[2026-01-23 14:43:33Z]
[INFO]
Preparing to assign (13/34): Azure Key Vault Managed HSM should have purge protection enabled
[2026-01-23 14:43:33Z]
[INFO]
Assigning policy 'Azure Key Vault Managed HSM should have purge protection enabled' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-23 14:43:33Z]
[SUCCESS]
Found 'Azure Key Vault Managed HSM should have purge protection enabled' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/c39ba22d-4428-4149-b981-70acb31fc383
[2026-01-23 14:43:34Z]
[INFO]
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-23 14:43:34Z]
[INFO]
DEBUG: Defined parameter names: effect
[2026-01-23 14:43:34Z]
[INFO]
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-23 14:43:34Z]
[INFO]
Dry-run: would create assignment with name AzureKeyVaultManagedHSMshouldhavepurgeprotectionenabl-1494992807 and params: 
Name                           Value
----                           -----
effect                         Deny

[2026-01-23 14:43:34Z]
[INFO]
Preparing to assign (14/34): Secrets should have the specified maximum validity period
[2026-01-23 14:43:34Z]
[INFO]
Assigning policy 'Secrets should have the specified maximum validity period' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-23 14:43:34Z]
[SUCCESS]
Found 'Secrets should have the specified maximum validity period' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/342e8053-e12e-4c44-be01-c3c2f318400f
[2026-01-23 14:43:34Z]
[INFO]
DEBUG: Checking parameter 'maximumValidityInDays' against policy definition
[2026-01-23 14:43:34Z]
[INFO]
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-23 14:43:34Z]
[INFO]
DEBUG: Added parameter 'maximumValidityInDays' = '365' to cleaned params
[2026-01-23 14:43:34Z]
[INFO]
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-23 14:43:34Z]
[INFO]
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-23 14:43:34Z]
[INFO]
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-23 14:43:34Z]
[INFO]
Dry-run: would create assignment with name Secretsshouldhavethespecifiedmaximumvalidityperiod-1663466362 and params: 
Name                           Value
----                           -----
maximumValidityInDays          365
effect                         Deny

[2026-01-23 14:43:34Z]
[INFO]
Preparing to assign (15/34): Key vaults should have deletion protection enabled
[2026-01-23 14:43:34Z]
[INFO]
Assigning policy 'Key vaults should have deletion protection enabled' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-23 14:43:34Z]
[SUCCESS]
Found 'Key vaults should have deletion protection enabled' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/0b60c0b2-2dc2-4e1c-b5c9-abbed971de53
[2026-01-23 14:43:34Z]
[INFO]
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-23 14:43:34Z]
[INFO]
DEBUG: Defined parameter names: effect
[2026-01-23 14:43:34Z]
[INFO]
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-23 14:43:34Z]
[INFO]
Dry-run: would create assignment with name Keyvaultsshouldhavedeletionprotectionenabled-1439856846 and params: 
Name                           Value
----                           -----
effect                         Deny

[2026-01-23 14:43:34Z]
[INFO]
Preparing to assign (16/34): Certificates using elliptic curve cryptography should have allowed curve names
[2026-01-23 14:43:34Z]
[INFO]
Assigning policy 'Certificates using elliptic curve cryptography should have allowed curve names' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-23 14:43:34Z]
[SUCCESS]
Found 'Certificates using elliptic curve cryptography should have allowed curve names' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/bd78111f-4953-4367-9fd5-7e08808b54bf
[2026-01-23 14:43:35Z]
[INFO]
DEBUG: Checking parameter 'allowedECNames' against policy definition
[2026-01-23 14:43:35Z]
[INFO]
DEBUG: Defined parameter names: allowedECNames, effect
[2026-01-23 14:43:35Z]
[INFO]
DEBUG: Added parameter 'allowedECNames' = 'P-256 P-256K P-384 P-521' to cleaned params
[2026-01-23 14:43:35Z]
[INFO]
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-23 14:43:35Z]
[INFO]
DEBUG: Defined parameter names: allowedECNames, effect
[2026-01-23 14:43:35Z]
[INFO]
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-23 14:43:35Z]
[INFO]
Dry-run: would create assignment with name Certificatesusingellipticcurvecryptographyshouldhavea-1468057639 and params: 
Name                           Value
----                           -----
allowedECNames                 {P-256, P-256K, P-384, P-521}
effect                         Deny

[2026-01-23 14:43:35Z]
[INFO]
Preparing to assign (17/34): Secrets should have content type set
[2026-01-23 14:43:35Z]
[INFO]
Assigning policy 'Secrets should have content type set' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-23 14:43:35Z]
[SUCCESS]
Found 'Secrets should have content type set' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/75262d3e-ba4a-4f43-85f8-9f72c090e5e3
[2026-01-23 14:43:35Z]
[INFO]
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-23 14:43:35Z]
[INFO]
DEBUG: Defined parameter names: effect
[2026-01-23 14:43:35Z]
[INFO]
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-23 14:43:35Z]
[INFO]
Dry-run: would create assignment with name Secretsshouldhavecontenttypeset-1186338756 and params: 
Name                           Value
----                           -----
effect                         Deny

[2026-01-23 14:43:35Z]
[INFO]
Preparing to assign (18/34): Certificates should have the specified lifetime action triggers
[2026-01-23 14:43:35Z]
[INFO]
Assigning policy 'Certificates should have the specified lifetime action triggers' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-23 14:43:35Z]
[SUCCESS]
Found 'Certificates should have the specified lifetime action triggers' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/12ef42cb-9903-4e39-9c26-422d29570417
[2026-01-23 14:43:36Z]
[INFO]
DEBUG: Checking parameter 'maximumPercentageLife' against policy definition
[2026-01-23 14:43:36Z]
[INFO]
DEBUG: Defined parameter names: maximumPercentageLife, minimumDaysBeforeExpiry, effect
[2026-01-23 14:43:36Z]
[INFO]
DEBUG: Added parameter 'maximumPercentageLife' = '80' to cleaned params
[2026-01-23 14:43:36Z]
[INFO]
DEBUG: Checking parameter 'minimumDaysBeforeExpiry' against policy definition
[2026-01-23 14:43:36Z]
[INFO]
DEBUG: Defined parameter names: maximumPercentageLife, minimumDaysBeforeExpiry, effect
[2026-01-23 14:43:36Z]
[INFO]
DEBUG: Added parameter 'minimumDaysBeforeExpiry' = '90' to cleaned params
[2026-01-23 14:43:36Z]
[INFO]
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-23 14:43:36Z]
[INFO]
DEBUG: Defined parameter names: maximumPercentageLife, minimumDaysBeforeExpiry, effect
[2026-01-23 14:43:36Z]
[INFO]
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-23 14:43:36Z]
[INFO]
Dry-run: would create assignment with name Certificatesshouldhavethespecifiedlifetimeactiontrigg-1761965968 and params: 
Name                           Value
----                           -----
maximumPercentageLife          80
minimumDaysBeforeExpiry        90
effect                         Deny

[2026-01-23 14:43:36Z]
[INFO]
Preparing to assign (19/34): Key vaults should have soft delete enabled
[2026-01-23 14:43:36Z]
[INFO]
Assigning policy 'Key vaults should have soft delete enabled' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-23 14:43:36Z]
[SUCCESS]
Found 'Key vaults should have soft delete enabled' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/1e66c121-a66a-4b1f-9b83-0fd99bf0fc2d
[2026-01-23 14:43:36Z]
[INFO]
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-23 14:43:36Z]
[INFO]
DEBUG: Defined parameter names: effect
[2026-01-23 14:43:36Z]
[INFO]
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-23 14:43:36Z]
[INFO]
Dry-run: would create assignment with name Keyvaultsshouldhavesoftdeleteenabled-656701378 and params: 
Name                           Value
----                           -----
effect                         Deny

[2026-01-23 14:43:36Z]
[INFO]
Preparing to assign (20/34): Certificates should be issued by the specified non-integrated certificate authority
[2026-01-23 14:43:36Z]
[INFO]
Assigning policy 'Certificates should be issued by the specified non-integrated certificate authority' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-23 14:43:36Z]
[SUCCESS]
Found 'Certificates should be issued by the specified non-integrated certificate authority' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/a22f4a40-01d3-4c7d-8071-da157eeff341
[2026-01-23 14:43:36Z]
[INFO]
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-23 14:43:36Z]
[INFO]
DEBUG: Defined parameter names: caCommonName, effect
[2026-01-23 14:43:36Z]
[INFO]
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-23 14:43:36Z]
[INFO]
DEBUG: Checking parameter 'caCommonName' against policy definition
[2026-01-23 14:43:36Z]
[INFO]
DEBUG: Defined parameter names: caCommonName, effect
[2026-01-23 14:43:36Z]
[INFO]
DEBUG: Added parameter 'caCommonName' = 'ContosoCA' to cleaned params
[2026-01-23 14:43:36Z]
[INFO]
Dry-run: would create assignment with name Certificatesshouldbeissuedbythespecifiednonintegratedc-500792775 and params: 
Name                           Value
----                           -----
caCommonName                   ContosoCA
effect                         Deny

[2026-01-23 14:43:36Z]
[INFO]
Preparing to assign (21/34): Keys using RSA cryptography should have a specified minimum key size
[2026-01-23 14:43:36Z]
[INFO]
Assigning policy 'Keys using RSA cryptography should have a specified minimum key size' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-23 14:43:36Z]
[SUCCESS]
Found 'Keys using RSA cryptography should have a specified minimum key size' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/82067dbb-e53b-4e06-b631-546d197452d9
[2026-01-23 14:43:37Z]
[INFO]
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-23 14:43:37Z]
[INFO]
DEBUG: Defined parameter names: minimumRSAKeySize, effect
[2026-01-23 14:43:37Z]
[INFO]
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-23 14:43:37Z]
[INFO]
DEBUG: Checking parameter 'minimumRSAKeySize' against policy definition
[2026-01-23 14:43:37Z]
[INFO]
DEBUG: Defined parameter names: minimumRSAKeySize, effect
[2026-01-23 14:43:37Z]
[INFO]
DEBUG: Added parameter 'minimumRSAKeySize' = '4096' to cleaned params
[2026-01-23 14:43:37Z]
[INFO]
Dry-run: would create assignment with name KeysusingRSAcryptographyshouldhaveaspecifiedminimumkey-909744685 and params: 
Name                           Value
----                           -----
effect                         Deny
minimumRSAKeySize              4096

[2026-01-23 14:43:37Z]
[INFO]
Preparing to assign (22/34): [Preview]: Azure Key Vault Managed HSM should disable public network access
[2026-01-23 14:43:37Z]
[INFO]
Assigning policy '[Preview]: Azure Key Vault Managed HSM should disable public network access' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-23 14:43:37Z]
[SUCCESS]
Found '[Preview]: Azure Key Vault Managed HSM should disable public network access' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/19ea9d63-adee-4431-a95e-1913c6c1c75f
[2026-01-23 14:43:37Z]
[INFO]
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-23 14:43:37Z]
[INFO]
DEBUG: Defined parameter names: effect
[2026-01-23 14:43:37Z]
[INFO]
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-23 14:43:37Z]
[INFO]
Dry-run: would create assignment with name PreviewAzureKeyVaultManagedHSMshoulddisablepublicnetwo-208646097 and params: 
Name                           Value
----                           -----
effect                         Deny

[2026-01-23 14:43:37Z]
[INFO]
Preparing to assign (23/34): Certificates should use allowed key types
[2026-01-23 14:43:37Z]
[INFO]
Assigning policy 'Certificates should use allowed key types' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-23 14:43:37Z]
[SUCCESS]
Found 'Certificates should use allowed key types' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/1151cede-290b-4ba0-8b38-0ad145ac888f
[2026-01-23 14:43:38Z]
[INFO]
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-23 14:43:38Z]
[INFO]
DEBUG: Defined parameter names: allowedKeyTypes, effect
[2026-01-23 14:43:38Z]
[INFO]
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-23 14:43:38Z]
[INFO]
DEBUG: Checking parameter 'allowedKeyTypes' against policy definition
[2026-01-23 14:43:38Z]
[INFO]
DEBUG: Defined parameter names: allowedKeyTypes, effect
[2026-01-23 14:43:38Z]
[INFO]
DEBUG: Added parameter 'allowedKeyTypes' = 'RSA EC' to cleaned params
[2026-01-23 14:43:38Z]
[INFO]
Dry-run: would create assignment with name Certificatesshoulduseallowedkeytypes-246707145 and params: 
Name                           Value
----                           -----
allowedKeyTypes                {RSA, EC}
effect                         Deny

[2026-01-23 14:43:38Z]
[INFO]
Preparing to assign (24/34): [Preview]: Azure Key Vault Managed HSM keys should have an expiration date
[2026-01-23 14:43:38Z]
[INFO]
Assigning policy '[Preview]: Azure Key Vault Managed HSM keys should have an expiration date' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-23 14:43:38Z]
[SUCCESS]
Found '[Preview]: Azure Key Vault Managed HSM keys should have an expiration date' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/1d478a74-21ba-4b9f-9d8f-8e6fced0eec5
[2026-01-23 14:43:38Z]
[INFO]
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-23 14:43:38Z]
[INFO]
DEBUG: Defined parameter names: effect
[2026-01-23 14:43:38Z]
[INFO]
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-23 14:43:38Z]
[INFO]
Dry-run: would create assignment with name PreviewAzureKeyVaultManagedHSMkeysshouldhaveanexpirati-976371970 and params: 
Name                           Value
----                           -----
effect                         Deny

[2026-01-23 14:43:38Z]
[INFO]
Preparing to assign (25/34): Azure Key Vault should have firewall enabled or public network access disabled
[2026-01-23 14:43:38Z]
[INFO]
Assigning policy 'Azure Key Vault should have firewall enabled or public network access disabled' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-23 14:43:38Z]
[SUCCESS]
Found 'Azure Key Vault should have firewall enabled or public network access disabled' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/55615ac9-af46-4a59-874e-391cc3dfb490
[2026-01-23 14:43:38Z]
[INFO]
DEBUG: Checking parameter 'allowedIPAddresses' against policy definition
[2026-01-23 14:43:38Z]
[INFO]
DEBUG: Defined parameter names: effect, restrictIPAddresses, allowedIPAddresses, forbiddenIPAddresses
[2026-01-23 14:43:38Z]
[INFO]
DEBUG: Added parameter 'allowedIPAddresses' = '0.0.0.0/0' to cleaned params
[2026-01-23 14:43:39Z]
[INFO]
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-23 14:43:39Z]
[INFO]
DEBUG: Defined parameter names: effect, restrictIPAddresses, allowedIPAddresses, forbiddenIPAddresses
[2026-01-23 14:43:39Z]
[INFO]
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-23 14:43:39Z]
[INFO]
DEBUG: Checking parameter 'forbiddenIPAddresses' against policy definition
[2026-01-23 14:43:39Z]
[INFO]
DEBUG: Defined parameter names: effect, restrictIPAddresses, allowedIPAddresses, forbiddenIPAddresses
[2026-01-23 14:43:39Z]
[INFO]
DEBUG: Added parameter 'forbiddenIPAddresses' = '' to cleaned params
[2026-01-23 14:43:39Z]
[INFO]
Dry-run: would create assignment with name AzureKeyVaultshouldhavefirewallenabledorpublicnetwork-1396884516 and params: 
Name                           Value
----                           -----
allowedIPAddresses             {0.0.0.0/0}
effect                         Deny
forbiddenIPAddresses           {}

[2026-01-23 14:43:39Z]
[INFO]
Preparing to assign (26/34): Secrets should have more than the specified number of days before expiration
[2026-01-23 14:43:39Z]
[INFO]
Assigning policy 'Secrets should have more than the specified number of days before expiration' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-23 14:43:39Z]
[SUCCESS]
Found 'Secrets should have more than the specified number of days before expiration' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/b0eb591a-5e70-4534-a8bf-04b9c489584a
[2026-01-23 14:43:39Z]
[INFO]
DEBUG: Checking parameter 'minimumDaysBeforeExpiration' against policy definition
[2026-01-23 14:43:39Z]
[INFO]
DEBUG: Defined parameter names: minimumDaysBeforeExpiration, effect
[2026-01-23 14:43:39Z]
[INFO]
DEBUG: Added parameter 'minimumDaysBeforeExpiration' = '90' to cleaned params
[2026-01-23 14:43:39Z]
[INFO]
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-23 14:43:39Z]
[INFO]
DEBUG: Defined parameter names: minimumDaysBeforeExpiration, effect
[2026-01-23 14:43:39Z]
[INFO]
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-23 14:43:39Z]
[INFO]
Dry-run: would create assignment with name Secretsshouldhavemorethanthespecifiednumberofdaysbefo-1193127515 and params: 
Name                           Value
----                           -----
minimumDaysBeforeExpiration    90
effect                         Deny

[2026-01-23 14:43:39Z]
[INFO]
Preparing to assign (27/34): Azure Key Vaults should use private link
[2026-01-23 14:43:39Z]
[INFO]
Assigning policy 'Azure Key Vaults should use private link' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-23 14:43:39Z]
[SUCCESS]
Found 'Azure Key Vaults should use private link' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/a6abeaec-4d90-4a02-805f-6b26c4d3fbe9
[2026-01-23 14:43:40Z]
[INFO]
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-23 14:43:40Z]
[INFO]
DEBUG: Defined parameter names: audit_effect, effect
[2026-01-23 14:43:40Z]
[INFO]
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-23 14:43:40Z]
[INFO]
Dry-run: would create assignment with name AzureKeyVaultsshoulduseprivatelink-2127082189 and params: 
Name                           Value
----                           -----
effect                         Deny

[2026-01-23 14:43:40Z]
[INFO]
Preparing to assign (28/34): Key Vault keys should have an expiration date
[2026-01-23 14:43:40Z]
[INFO]
Assigning policy 'Key Vault keys should have an expiration date' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-23 14:43:40Z]
[SUCCESS]
Found 'Key Vault keys should have an expiration date' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/152b15f7-8e1f-4c1f-ab71-8c010ba5dbc0
[2026-01-23 14:43:40Z]
[INFO]
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-23 14:43:40Z]
[INFO]
DEBUG: Defined parameter names: effect
[2026-01-23 14:43:40Z]
[INFO]
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-23 14:43:40Z]
[INFO]
Dry-run: would create assignment with name KeyVaultkeysshouldhaveanexpirationdate-386037801 and params: 
Name                           Value
----                           -----
effect                         Deny

[2026-01-23 14:43:40Z]
[INFO]
Preparing to assign (29/34): Keys should not be active for longer than the specified number of days
[2026-01-23 14:43:40Z]
[INFO]
Assigning policy 'Keys should not be active for longer than the specified number of days' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-23 14:43:40Z]
[SUCCESS]
Found 'Keys should not be active for longer than the specified number of days' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/c26e4b24-cf98-4c67-b48b-5a25c4c69eb9
[2026-01-23 14:43:41Z]
[INFO]
DEBUG: Checking parameter 'maximumValidityInDays' against policy definition
[2026-01-23 14:43:41Z]
[INFO]
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-23 14:43:41Z]
[INFO]
DEBUG: Added parameter 'maximumValidityInDays' = '365' to cleaned params
[2026-01-23 14:43:41Z]
[INFO]
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-23 14:43:41Z]
[INFO]
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-23 14:43:41Z]
[INFO]
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-23 14:43:41Z]
[INFO]
Dry-run: would create assignment with name Keysshouldnotbeactiveforlongerthanthespecifiednumbero-1296256806 and params: 
Name                           Value
----                           -----
maximumValidityInDays          365
effect                         Deny

[2026-01-23 14:43:41Z]
[INFO]
Preparing to assign (30/34): Keys should be backed by a hardware security module (HSM)
[2026-01-23 14:43:41Z]
[INFO]
Assigning policy 'Keys should be backed by a hardware security module (HSM)' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-23 14:43:41Z]
[SUCCESS]
Found 'Keys should be backed by a hardware security module (HSM)' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/587c79fe-dd04-4a5e-9d0b-f89598c7261b
[2026-01-23 14:43:41Z]
[INFO]
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-23 14:43:41Z]
[INFO]
DEBUG: Defined parameter names: effect
[2026-01-23 14:43:41Z]
[INFO]
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-23 14:43:41Z]
[INFO]
Dry-run: would create assignment with name KeysshouldbebackedbyahardwaresecuritymoduleHSM-593124860 and params: 
Name                           Value
----                           -----
effect                         Deny

[2026-01-23 14:43:41Z]
[INFO]
Preparing to assign (31/34): Certificates should be issued by the specified integrated certificate authority
[2026-01-23 14:43:41Z]
[INFO]
Assigning policy 'Certificates should be issued by the specified integrated certificate authority' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-23 14:43:41Z]
[SUCCESS]
Found 'Certificates should be issued by the specified integrated certificate authority' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/8e826246-c976-48f6-b03e-619bb92b3d82
[2026-01-23 14:43:42Z]
[INFO]
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-23 14:43:42Z]
[INFO]
DEBUG: Defined parameter names: allowedCAs, effect
[2026-01-23 14:43:42Z]
[INFO]
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-23 14:43:42Z]
[INFO]
DEBUG: Checking parameter 'allowedCAs' against policy definition
[2026-01-23 14:43:42Z]
[INFO]
DEBUG: Defined parameter names: allowedCAs, effect
[2026-01-23 14:43:42Z]
[INFO]
DEBUG: Added parameter 'allowedCAs' = 'DigiCert GlobalSign' to cleaned params
[2026-01-23 14:43:42Z]
[INFO]
Dry-run: would create assignment with name Certificatesshouldbeissuedbythespecifiedintegratedcer-1190107367 and params: 
Name                           Value
----                           -----
effect                         Deny
allowedCAs                     {DigiCert, GlobalSign}

[2026-01-23 14:43:42Z]
[INFO]
Preparing to assign (32/34): Azure Key Vault should use RBAC permission model
[2026-01-23 14:43:42Z]
[INFO]
Assigning policy 'Azure Key Vault should use RBAC permission model' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-23 14:43:42Z]
[SUCCESS]
Found 'Azure Key Vault should use RBAC permission model' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/12d4fa5e-1f9f-4c21-97a9-b99b3c6611b5
[2026-01-23 14:43:43Z]
[INFO]
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-23 14:43:43Z]
[INFO]
DEBUG: Defined parameter names: effect
[2026-01-23 14:43:43Z]
[INFO]
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-23 14:43:43Z]
[INFO]
Dry-run: would create assignment with name AzureKeyVaultshoulduseRBACpermissionmodel-307198231 and params: 
Name                           Value
----                           -----
effect                         Deny

[2026-01-23 14:43:43Z]
[INFO]
Preparing to assign (33/34): [Preview]: Azure Key Vault Managed HSM keys using RSA cryptography should have a specified minimum key size
[2026-01-23 14:43:43Z]
[INFO]
Assigning policy '[Preview]: Azure Key Vault Managed HSM keys using RSA cryptography should have a specified minimum key size' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-23 14:43:43Z]
[SUCCESS]
Found '[Preview]: Azure Key Vault Managed HSM keys using RSA cryptography should have a specified minimum key size' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/86810a98-8e91-4a44-8386-ec66d0de5d57
[2026-01-23 14:43:43Z]
[INFO]
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-23 14:43:43Z]
[INFO]
DEBUG: Defined parameter names: effect, minimumRSAKeySize
[2026-01-23 14:43:43Z]
[INFO]
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-23 14:43:43Z]
[INFO]
DEBUG: Checking parameter 'minimumRSAKeySize' against policy definition
[2026-01-23 14:43:43Z]
[INFO]
DEBUG: Defined parameter names: effect, minimumRSAKeySize
[2026-01-23 14:43:43Z]
[INFO]
DEBUG: Added parameter 'minimumRSAKeySize' = '4096' to cleaned params
[2026-01-23 14:43:43Z]
[INFO]
Dry-run: would create assignment with name PreviewAzureKeyVaultManagedHSMkeysusingRSAcryptography-998252524 and params: 
Name                           Value
----                           -----
effect                         Deny
minimumRSAKeySize              4096

[2026-01-23 14:43:43Z]
[INFO]
Preparing to assign (34/34): Keys should have the specified maximum validity period
[2026-01-23 14:43:43Z]
[INFO]
Assigning policy 'Keys should have the specified maximum validity period' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-23 14:43:43Z]
[SUCCESS]
Found 'Keys should have the specified maximum validity period' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/49a22571-d204-4c91-a7b6-09b1a586fbc9
[2026-01-23 14:43:44Z]
[INFO]
DEBUG: Checking parameter 'maximumValidityInDays' against policy definition
[2026-01-23 14:43:44Z]
[INFO]
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-23 14:43:44Z]
[INFO]
DEBUG: Added parameter 'maximumValidityInDays' = '365' to cleaned params
[2026-01-23 14:43:44Z]
[INFO]
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-23 14:43:44Z]
[INFO]
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-23 14:43:44Z]
[INFO]
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-23 14:43:44Z]
[INFO]
Dry-run: would create assignment with name Keysshouldhavethespecifiedmaximumvalidityperiod-906231923 and params: 
Name                           Value
----                           -----
maximumValidityInDays          365
effect                         Deny
[2026-01-23 14:43:44Z]
[INFO]
Collected 0 assignment IDs for filtering
[2026-01-23 14:43:44Z]
[INFO]
Wrote reports: KeyVaultPolicyImplementationReport-20260123-144344.md, KeyVaultPolicyImplementationReport-20260123-144344.json, KeyVaultPolicyImplementationReport-20260123-144344.csv
[2026-01-23 14:43:44Z]
[SUCCESS]
HTML report generated: ./PolicyImplementationReport-20260123-144344.html
Dry-run summary written to ./DryRunSummary.txt

[2026-01-23 14:43:44Z]
[INFO]
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-01-23 14:43:44Z]
[INFO]
                    ğŸ“‹ NEXT STEPS GUIDANCE
[2026-01-23 14:43:44Z]
[INFO]
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ¯ Dry-Run Validation Complete

âœ… What was validated:
  â†’ Policy definitions resolved from mapping file
  â†’ Parameter overrides validated against policy schemas
  â†’ Assignment names generated (64-char limit enforced)
  â†’ No actual Azure resources created or modified

ğŸ“‹ Recommended Next Steps:
  1. ğŸ“„ Review dry-run summary:

notepad ./DryRunSummary.txt
  2. âœ… Verify all policies resolved successfully (Status: DryRun)
  3. ğŸ” Check for policies requiring managed identity (DeployIfNotExists/Modify effects)
  4. ğŸ“Š Review parameter values match your requirements
  5. ğŸš€ Deploy to test environment when ready:

.\\AzPolicyImplScript.ps1 -ParameterFile <YOUR_PARAM_FILE> -SkipRBACCheck

âš ï¸  Common Issues to Check:
  â†’ Policies with Status='Skipped' require -IdentityResourceId parameter
  â†’ Verify parameter values don't exceed policy min/max constraints
  â†’ Check for typos in policy display names (lookup failures)

ğŸ“š Documentation:
  â†’ Parameter File Guide: PolicyParameters-QuickReference.md
  â†’ Deployment Workflow: DEPLOYMENT-WORKFLOW-GUIDE.md


ğŸ“‹ Dry-Run Summary:
./DryRunSummary.txt


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-01-23 14:43:44Z]
[SUCCESS]
Completed run. Reports generated.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“„ Reports Generated:
  â€¢ HTML:
./PolicyImplementationReport-20260123-144344.html
  â€¢ Markdown:
KeyVaultPolicyImplementationReport-20260123-144344.md
  â€¢ JSON:
KeyVaultPolicyImplementationReport-20260123-144344.json


[2026-01-23 14:43:44Z]
[INFO]
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-01-23 14:43:44Z]
[INFO]
                    ğŸ“‹ NEXT STEPS GUIDANCE
[2026-01-23 14:43:44Z]
[INFO]
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ¯ Custom Deployment Complete

âœ… What was deployed:
  â†’ Custom policy configuration from parameter file

ğŸ“‹ Recommended Next Steps:
  1. â³ Wait 30-60 minutes for Azure Policy evaluation cycle
  2. ğŸ“Š Check compliance status:

.\\AzPolicyImplScript.ps1 -CheckCompliance -TriggerScan
  3. ğŸ“š Review deployment documentation for custom workflows

**********************
PowerShell transcript end
End time: 20260123144344
**********************
