
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  Azure Key Vault Policy Governance - Scenario Validation
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[2026-01-22 15:08:44] [INFO] Starting comprehensive scenario validation
[2026-01-22 15:08:44] [INFO] Test mode: DRYRUN (Preview)
[2026-01-22 15:08:44] [INFO] Test log: .\test-all-scenarios-validation-20260122-150844.txt
[2026-01-22 15:08:44] [INFO] 
Validating prerequisites...
[2026-01-22 15:08:44] [SUCCESS] âœ… All prerequisites validated

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-01-22 15:08:44] [INFO] SCENARIO 1: DevTest Baseline (30 Policies)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-01-22 15:08:44] [INFO] Executing: .\AzPolicyImplScript.ps1 -ParameterFile .\PolicyParameters-DevTest.json -SkipRBACCheck -Preview

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  Azure Policy Implementation - Key Vault Governance          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[2026-01-22 15:08:44Z] 
[INFO] 
Starting Azure Policy implementation script for Key Vault policies
[2026-01-22 15:08:44Z] 
[INFO] 
Checking required PowerShell modules...
[2026-01-22 15:08:44Z] 
[SUCCESS] 
Module Az.Accounts is present
[2026-01-22 15:08:44Z] 
[SUCCESS] 
Module Az.Resources is present
[2026-01-22 15:08:45Z] 
[SUCCESS] 
Module Az.PolicyInsights is present
[2026-01-22 15:08:45Z] 
[SUCCESS] 
Module Az.Monitor is present
[2026-01-22 15:08:45Z] 
[SUCCESS] 
Module Az.KeyVault is present
[2026-01-22 15:08:45Z] 
[INFO] 
Using Azure context: theregniers@hotmail.com
[2026-01-22 15:08:45Z] 
[INFO] 
Loading policy mapping from ./PolicyNameMapping.json
[2026-01-22 15:08:46Z] 
[INFO] 
Loaded 3745 policy mappings
[2026-01-22 15:08:46Z] 
[INFO] 
Loading policy parameter overrides from .\PolicyParameters-DevTest.json
[2026-01-22 15:08:46Z] 
[INFO] 
Detected deployment type: DevTest30 (from parameter file: PolicyParameters-DevTest.json)
[2026-01-22 15:08:46Z] 
[INFO] 
Preview mode enabled: setting DryRun and skipping RBAC checks.
[2026-01-22 15:08:46Z] 
[INFO] 
DEBUG: PSBoundParameters keys: CsvPath, ParameterOverridesPath, SkipRBACCheck, Preview
[2026-01-22 15:08:46Z] 
[INFO] 
DEBUG: ScopeType value: ''
[2026-01-22 15:08:46Z] 
[INFO] 
Dry-run mode: using Subscription scope by default
[2026-01-22 15:08:46Z] 
[INFO] 
Checking current subscription context.
[2026-01-22 15:08:46Z] 
[INFO] 
Current subscription: MSDN Platforms Subscription (ab1336c7-687d-4107-b0f6-9649a0458adb)
[2026-01-22 15:08:46Z] 
[INFO] 
Dry-run mode: using current subscription context
[2026-01-22 15:08:46Z] 
[INFO] 
Preview mode: skipped RBAC permission check.
[2026-01-22 15:08:46Z] 
[INFO] 
Using policy effects from parameter file: .\PolicyParameters-DevTest.json
[2026-01-22 15:08:46Z] 
[SUCCESS] 
Loaded 30 policies from parameter file: .\PolicyParameters-DevTest.json

Processing 30 policies...
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

[2026-01-22 15:08:46Z] 
[INFO] 
Preparing to assign (1/30): Configure key vaults to enable firewall
[2026-01-22 15:08:46Z] 
[INFO] 
Assigning policy 'Configure key vaults to enable firewall' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:08:46Z] 
[SUCCESS] 
Found 'Configure key vaults to enable firewall' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/ac673a9a-f77d-4846-b2d8-a57f8e1c01dc
[2026-01-22 15:08:49Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:08:49Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:08:49Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Modify' to cleaned params
[2026-01-22 15:08:49Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '' (Length: 0)
[2026-01-22 15:08:49Z] 
[WARN] 
Effect '' requires managed identity. Skipping assignment - provide -IdentityResourceId to enable.

[2026-01-22 15:08:49Z] 
[INFO] 
Preparing to assign (2/30): Deploy Diagnostic Settings for Key Vault to Event Hub
[2026-01-22 15:08:49Z] 
[INFO] 
Assigning policy 'Deploy Diagnostic Settings for Key Vault to Event Hub' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:08:49Z] 
[SUCCESS] 
Found 'Deploy Diagnostic Settings for Key Vault to Event Hub' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/ed7c8c13-51e7-49d1-8a43-8490431a0da2
[2026-01-22 15:08:49Z] 
[INFO] 
DEBUG: Checking parameter 'eventHubLocation' against policy definition
[2026-01-22 15:08:49Z] 
[INFO] 
DEBUG: Defined parameter names: effect, profileName, eventHubRuleId, eventHubLocation, metricsEnabled, logsEnabled
[2026-01-22 15:08:49Z] 
[INFO] 
DEBUG: Added parameter 'eventHubLocation' = 'eastus' to cleaned params
[2026-01-22 15:08:49Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:08:49Z] 
[INFO] 
DEBUG: Defined parameter names: effect, profileName, eventHubRuleId, eventHubLocation, metricsEnabled, logsEnabled
[2026-01-22 15:08:49Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'DeployIfNotExists' to cleaned params
[2026-01-22 15:08:49Z] 
[INFO] 
DEBUG: Checking parameter 'eventHubRuleId' against policy definition
[2026-01-22 15:08:49Z] 
[INFO] 
DEBUG: Defined parameter names: effect, profileName, eventHubRuleId, eventHubLocation, metricsEnabled, logsEnabled
[2026-01-22 15:08:49Z] 
[INFO] 
DEBUG: Added parameter 'eventHubRuleId' = '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.EventHub/namespaces/eh-policy-test-6513/authorizationrules/RootManageSharedAccessKey' to cleaned params
[2026-01-22 15:08:49Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '' (Length: 0)
[2026-01-22 15:08:49Z] 
[WARN] 
Effect '' requires managed identity. Skipping assignment - provide -IdentityResourceId to enable.

[2026-01-22 15:08:49Z] 
[INFO] 
Preparing to assign (3/30): Keys using RSA cryptography should have a specified minimum key size
[2026-01-22 15:08:49Z] 
[INFO] 
Assigning policy 'Keys using RSA cryptography should have a specified minimum key size' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:08:49Z] 
[SUCCESS] 
Found 'Keys using RSA cryptography should have a specified minimum key size' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/82067dbb-e53b-4e06-b631-546d197452d9
[2026-01-22 15:08:50Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:08:50Z] 
[INFO] 
DEBUG: Defined parameter names: minimumRSAKeySize, effect
[2026-01-22 15:08:50Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:08:50Z] 
[INFO] 
DEBUG: Checking parameter 'minimumRSAKeySize' against policy definition
[2026-01-22 15:08:50Z] 
[INFO] 
DEBUG: Defined parameter names: minimumRSAKeySize, effect
[2026-01-22 15:08:50Z] 
[INFO] 
DEBUG: Added parameter 'minimumRSAKeySize' = '2048' to cleaned params
[2026-01-22 15:08:50Z] 
[INFO] 
Dry-run: would create assignment with name KeysusingRSAcryptographyshouldhaveaspecifiedminimumkey-909744685 and params: 
Name                           Value
----                           -----
minimumRSAKeySize              2048
effect                         Audit



[2026-01-22 15:08:50Z] 
[INFO] 
Preparing to assign (4/30): Deploy - Configure diagnostic settings for Azure Key Vault to Log Analytics workspace
[2026-01-22 15:08:50Z] 
[INFO] 
Assigning policy 'Deploy - Configure diagnostic settings for Azure Key Vault to Log Analytics workspace' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:08:50Z] 
[SUCCESS] 
Found 'Deploy - Configure diagnostic settings for Azure Key Vault to Log Analytics workspace' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/951af2fa-529b-416e-ab6e-066fd85ac459
[2026-01-22 15:08:50Z] 
[INFO] 
DEBUG: Checking parameter 'logAnalytics' against policy definition
[2026-01-22 15:08:50Z] 
[INFO] 
DEBUG: Defined parameter names: effect, diagnosticsSettingNameToUse, logAnalytics, AuditEventEnabled, AllMetricsEnabled
[2026-01-22 15:08:51Z] 
[INFO] 
DEBUG: Added parameter 'logAnalytics' = '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.OperationalInsights/workspaces/law-policy-test-6827' to cleaned params
[2026-01-22 15:08:51Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:08:51Z] 
[INFO] 
DEBUG: Defined parameter names: effect, diagnosticsSettingNameToUse, logAnalytics, AuditEventEnabled, AllMetricsEnabled
[2026-01-22 15:08:51Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'DeployIfNotExists' to cleaned params
[2026-01-22 15:08:51Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '' (Length: 0)
[2026-01-22 15:08:51Z] 
[WARN] 
Effect '' requires managed identity. Skipping assignment - provide -IdentityResourceId to enable.

[2026-01-22 15:08:51Z] 
[INFO] 
Preparing to assign (5/30): Key Vault secrets should have an expiration date
[2026-01-22 15:08:51Z] 
[INFO] 
Assigning policy 'Key Vault secrets should have an expiration date' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:08:51Z] 
[SUCCESS] 
Found 'Key Vault secrets should have an expiration date' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/98728c90-32c7-4049-8429-847dc0f4fe37
[2026-01-22 15:08:51Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:08:51Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:08:51Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:08:51Z] 
[INFO] 
Dry-run: would create assignment with name KeyVaultsecretsshouldhaveanexpirationdate-1232117220 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:08:51Z] 
[INFO] 
Preparing to assign (6/30): Secrets should have more than the specified number of days before expiration
[2026-01-22 15:08:51Z] 
[INFO] 
Assigning policy 'Secrets should have more than the specified number of days before expiration' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:08:51Z] 
[SUCCESS] 
Found 'Secrets should have more than the specified number of days before expiration' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/b0eb591a-5e70-4534-a8bf-04b9c489584a
[2026-01-22 15:08:51Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:08:51Z] 
[INFO] 
DEBUG: Defined parameter names: minimumDaysBeforeExpiration, effect
[2026-01-22 15:08:51Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:08:51Z] 
[INFO] 
DEBUG: Checking parameter 'minimumDaysBeforeExpiration' against policy definition
[2026-01-22 15:08:51Z] 
[INFO] 
DEBUG: Defined parameter names: minimumDaysBeforeExpiration, effect
[2026-01-22 15:08:51Z] 
[INFO] 
DEBUG: Added parameter 'minimumDaysBeforeExpiration' = '30' to cleaned params
[2026-01-22 15:08:51Z] 
[INFO] 
Dry-run: would create assignment with name Secretsshouldhavemorethanthespecifiednumberofdaysbefo-1193127515 and params: 
Name                           Value
----                           -----
minimumDaysBeforeExpiration    30
effect                         Audit



[2026-01-22 15:08:51Z] 
[INFO] 
Preparing to assign (7/30): Configure Azure Key Vaults with private endpoints
[2026-01-22 15:08:51Z] 
[INFO] 
Assigning policy 'Configure Azure Key Vaults with private endpoints' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:08:51Z] 
[SUCCESS] 
Found 'Configure Azure Key Vaults with private endpoints' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/9d4fad1f-5189-4a42-b29e-cf7929c6b6df
[2026-01-22 15:08:52Z] 
[INFO] 
DEBUG: Checking parameter 'privateEndpointSubnetId' against policy definition
[2026-01-22 15:08:52Z] 
[INFO] 
DEBUG: Defined parameter names: privateEndpointSubnetId, effect
[2026-01-22 15:08:52Z] 
[INFO] 
DEBUG: Added parameter 'privateEndpointSubnetId' = '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.Network/virtualNetworks/vnet-policy-test/subnets/snet-privateendpoints' to cleaned params
[2026-01-22 15:08:52Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:08:52Z] 
[INFO] 
DEBUG: Defined parameter names: privateEndpointSubnetId, effect
[2026-01-22 15:08:52Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'DeployIfNotExists' to cleaned params
[2026-01-22 15:08:52Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '' (Length: 0)
[2026-01-22 15:08:52Z] 
[WARN] 
Effect '' requires managed identity. Skipping assignment - provide -IdentityResourceId to enable.

[2026-01-22 15:08:52Z] 
[INFO] 
Preparing to assign (8/30): Key vaults should have soft delete enabled
[2026-01-22 15:08:52Z] 
[INFO] 
Assigning policy 'Key vaults should have soft delete enabled' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:08:52Z] 
[SUCCESS] 
Found 'Key vaults should have soft delete enabled' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/1e66c121-a66a-4b1f-9b83-0fd99bf0fc2d
[2026-01-22 15:08:52Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:08:52Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:08:52Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:08:52Z] 
[INFO] 
Dry-run: would create assignment with name Keyvaultsshouldhavesoftdeleteenabled-656701378 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:08:52Z] 
[INFO] 
Preparing to assign (9/30): Certificates should have the specified lifetime action triggers
[2026-01-22 15:08:52Z] 
[INFO] 
Assigning policy 'Certificates should have the specified lifetime action triggers' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:08:52Z] 
[SUCCESS] 
Found 'Certificates should have the specified lifetime action triggers' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/12ef42cb-9903-4e39-9c26-422d29570417
[2026-01-22 15:08:53Z] 
[INFO] 
DEBUG: Checking parameter 'maximumPercentageLife' against policy definition
[2026-01-22 15:08:53Z] 
[INFO] 
DEBUG: Defined parameter names: maximumPercentageLife, minimumDaysBeforeExpiry, effect
[2026-01-22 15:08:53Z] 
[INFO] 
DEBUG: Added parameter 'maximumPercentageLife' = '80' to cleaned params
[2026-01-22 15:08:53Z] 
[INFO] 
DEBUG: Checking parameter 'minimumDaysBeforeExpiry' against policy definition
[2026-01-22 15:08:53Z] 
[INFO] 
DEBUG: Defined parameter names: maximumPercentageLife, minimumDaysBeforeExpiry, effect
[2026-01-22 15:08:53Z] 
[INFO] 
DEBUG: Added parameter 'minimumDaysBeforeExpiry' = '30' to cleaned params
[2026-01-22 15:08:53Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:08:53Z] 
[INFO] 
DEBUG: Defined parameter names: maximumPercentageLife, minimumDaysBeforeExpiry, effect
[2026-01-22 15:08:53Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:08:53Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesshouldhavethespecifiedlifetimeactiontrigg-1761965968 and params: 
Name                           Value
----                           -----
maximumPercentageLife          80
minimumDaysBeforeExpiry        30
effect                         Audit



[2026-01-22 15:08:53Z] 
[INFO] 
Preparing to assign (10/30): Secrets should not be active for longer than the specified number of days
[2026-01-22 15:08:53Z] 
[INFO] 
Assigning policy 'Secrets should not be active for longer than the specified number of days' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:08:53Z] 
[SUCCESS] 
Found 'Secrets should not be active for longer than the specified number of days' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/e8d99835-8a06-45ae-a8e0-87a91941ccfe
[2026-01-22 15:08:53Z] 
[INFO] 
DEBUG: Checking parameter 'maximumValidityInDays' against policy definition
[2026-01-22 15:08:53Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:08:53Z] 
[INFO] 
DEBUG: Added parameter 'maximumValidityInDays' = '730' to cleaned params
[2026-01-22 15:08:53Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:08:53Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:08:53Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:08:53Z] 
[INFO] 
Dry-run: would create assignment with name Secretsshouldnotbeactiveforlongerthanthespecifiednumb-1452013840 and params: 
Name                           Value
----                           -----
maximumValidityInDays          730
effect                         Audit



[2026-01-22 15:08:53Z] 
[INFO] 
Preparing to assign (11/30): Certificates should be issued by the specified non-integrated certificate authority
[2026-01-22 15:08:53Z] 
[INFO] 
Assigning policy 'Certificates should be issued by the specified non-integrated certificate authority' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:08:53Z] 
[SUCCESS] 
Found 'Certificates should be issued by the specified non-integrated certificate authority' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/a22f4a40-01d3-4c7d-8071-da157eeff341
[2026-01-22 15:08:53Z] 
[INFO] 
DEBUG: Checking parameter 'caCommonName' against policy definition
[2026-01-22 15:08:53Z] 
[INFO] 
DEBUG: Defined parameter names: caCommonName, effect
[2026-01-22 15:08:53Z] 
[INFO] 
DEBUG: Added parameter 'caCommonName' = 'CN=ContosoCA' to cleaned params
[2026-01-22 15:08:53Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:08:53Z] 
[INFO] 
DEBUG: Defined parameter names: caCommonName, effect
[2026-01-22 15:08:53Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:08:53Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesshouldbeissuedbythespecifiednonintegratedc-500792775 and params: 
Name                           Value
----                           -----
caCommonName                   CN=ContosoCA
effect                         Audit



[2026-01-22 15:08:53Z] 
[INFO] 
Preparing to assign (12/30): Certificates should have the specified maximum validity period
[2026-01-22 15:08:53Z] 
[INFO] 
Assigning policy 'Certificates should have the specified maximum validity period' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:08:53Z] 
[SUCCESS] 
Found 'Certificates should have the specified maximum validity period' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/0a075868-4c26-42ef-914c-5bc007359560
[2026-01-22 15:08:54Z] 
[INFO] 
DEBUG: Checking parameter 'maximumValidityInMonths' against policy definition
[2026-01-22 15:08:54Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInMonths, effect
[2026-01-22 15:08:54Z] 
[INFO] 
DEBUG: Added parameter 'maximumValidityInMonths' = '36' to cleaned params
[2026-01-22 15:08:54Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:08:54Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInMonths, effect
[2026-01-22 15:08:54Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:08:54Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesshouldhavethespecifiedmaximumvalidityperio-407807336 and params: 
Name                           Value
----                           -----
maximumValidityInMonths        36
effect                         Audit



[2026-01-22 15:08:54Z] 
[INFO] 
Preparing to assign (13/30): Keys should have more than the specified number of days before expiration
[2026-01-22 15:08:54Z] 
[INFO] 
Assigning policy 'Keys should have more than the specified number of days before expiration' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:08:54Z] 
[SUCCESS] 
Found 'Keys should have more than the specified number of days before expiration' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/5ff38825-c5d8-47c5-b70e-069a21955146
[2026-01-22 15:08:54Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:08:54Z] 
[INFO] 
DEBUG: Defined parameter names: minimumDaysBeforeExpiration, effect
[2026-01-22 15:08:54Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:08:54Z] 
[INFO] 
DEBUG: Checking parameter 'minimumDaysBeforeExpiration' against policy definition
[2026-01-22 15:08:54Z] 
[INFO] 
DEBUG: Defined parameter names: minimumDaysBeforeExpiration, effect
[2026-01-22 15:08:54Z] 
[INFO] 
DEBUG: Added parameter 'minimumDaysBeforeExpiration' = '30' to cleaned params
[2026-01-22 15:08:54Z] 
[INFO] 
Dry-run: would create assignment with name Keysshouldhavemorethanthespecifiednumberofdaysbeforeexp-12464927 and params: 
Name                           Value
----                           -----
minimumDaysBeforeExpiration    30
effect                         Audit



[2026-01-22 15:08:54Z] 
[INFO] 
Preparing to assign (14/30): Resource logs in Azure Key Vault Managed HSM should be enabled
[2026-01-22 15:08:54Z] 
[INFO] 
Assigning policy 'Resource logs in Azure Key Vault Managed HSM should be enabled' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:08:54Z] 
[SUCCESS] 
Found 'Resource logs in Azure Key Vault Managed HSM should be enabled' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/a2a5b911-5617-447e-a49e-59dbe0e0434b
[2026-01-22 15:08:55Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:08:55Z] 
[INFO] 
DEBUG: Defined parameter names: effect, requiredRetentionDays
[2026-01-22 15:08:55Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'AuditIfNotExists' to cleaned params
[2026-01-22 15:08:55Z] 
[INFO] 
Dry-run: would create assignment with name ResourcelogsinAzureKeyVaultManagedHSMshouldbeenabled-1874150632 and params: 
Name                           Value
----                           -----
effect                         AuditIfNotExists



[2026-01-22 15:08:55Z] 
[INFO] 
Preparing to assign (15/30): Key Vault keys should have an expiration date
[2026-01-22 15:08:55Z] 
[INFO] 
Assigning policy 'Key Vault keys should have an expiration date' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:08:55Z] 
[SUCCESS] 
Found 'Key Vault keys should have an expiration date' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/152b15f7-8e1f-4c1f-ab71-8c010ba5dbc0
[2026-01-22 15:08:56Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:08:56Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:08:56Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:08:56Z] 
[INFO] 
Dry-run: would create assignment with name KeyVaultkeysshouldhaveanexpirationdate-386037801 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:08:56Z] 
[INFO] 
Preparing to assign (16/30): Keys should have a rotation policy ensuring that their rotation is scheduled within the specified number of days after creation.
[2026-01-22 15:08:56Z] 
[INFO] 
Assigning policy 'Keys should have a rotation policy ensuring that their rotation is scheduled within the specified number of days after creation.' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:08:56Z] 
[SUCCESS] 
Found 'Keys should have a rotation policy ensuring that their rotation is scheduled within the specified number of days after creation.' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/d8cf8476-a2ec-4916-896e-992351803c44
[2026-01-22 15:08:56Z] 
[INFO] 
DEBUG: Checking parameter 'maximumDaysToRotate' against policy definition
[2026-01-22 15:08:56Z] 
[INFO] 
DEBUG: Defined parameter names: maximumDaysToRotate, effect
[2026-01-22 15:08:56Z] 
[INFO] 
DEBUG: Added parameter 'maximumDaysToRotate' = '180' to cleaned params
[2026-01-22 15:08:56Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:08:56Z] 
[INFO] 
DEBUG: Defined parameter names: maximumDaysToRotate, effect
[2026-01-22 15:08:56Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:08:56Z] 
[INFO] 
Dry-run: would create assignment with name Keysshouldhavearotationpolicyensuringthattheirrotatio-1816322754 and params: 
Name                           Value
----                           -----
maximumDaysToRotate            180
effect                         Audit



[2026-01-22 15:08:56Z] 
[INFO] 
Preparing to assign (17/30): Resource logs in Key Vault should be enabled
[2026-01-22 15:08:56Z] 
[INFO] 
Assigning policy 'Resource logs in Key Vault should be enabled' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:08:56Z] 
[SUCCESS] 
Found 'Resource logs in Key Vault should be enabled' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21
[2026-01-22 15:08:56Z] 
[INFO] 
DEBUG: Checking parameter 'requiredRetentionDays' against policy definition
[2026-01-22 15:08:56Z] 
[INFO] 
DEBUG: Defined parameter names: effect, requiredRetentionDays
[2026-01-22 15:08:56Z] 
[INFO] 
DEBUG: Added parameter 'requiredRetentionDays' = '30' to cleaned params
[2026-01-22 15:08:56Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:08:56Z] 
[INFO] 
DEBUG: Defined parameter names: effect, requiredRetentionDays
[2026-01-22 15:08:56Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'AuditIfNotExists' to cleaned params
[2026-01-22 15:08:56Z] 
[INFO] 
Dry-run: would create assignment with name ResourcelogsinKeyVaultshouldbeenabled-1683835535 and params: 
Name                           Value
----                           -----
requiredRetentionDays          30
effect                         AuditIfNotExists



[2026-01-22 15:08:56Z] 
[INFO] 
Preparing to assign (18/30): Certificates should not expire within the specified number of days
[2026-01-22 15:08:56Z] 
[INFO] 
Assigning policy 'Certificates should not expire within the specified number of days' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:08:56Z] 
[SUCCESS] 
Found 'Certificates should not expire within the specified number of days' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/f772fb64-8e40-40ad-87bc-7706e1949427
[2026-01-22 15:08:57Z] 
[INFO] 
DEBUG: Checking parameter 'daysToExpire' against policy definition
[2026-01-22 15:08:57Z] 
[INFO] 
DEBUG: Defined parameter names: daysToExpire, effect
[2026-01-22 15:08:57Z] 
[INFO] 
DEBUG: Added parameter 'daysToExpire' = '30' to cleaned params
[2026-01-22 15:08:57Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:08:57Z] 
[INFO] 
DEBUG: Defined parameter names: daysToExpire, effect
[2026-01-22 15:08:57Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:08:57Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesshouldnotexpirewithinthespecifiednumberof-2114192775 and params: 
Name                           Value
----                           -----
daysToExpire                   30
effect                         Audit



[2026-01-22 15:08:57Z] 
[INFO] 
Preparing to assign (19/30): Key vaults should have deletion protection enabled
[2026-01-22 15:08:57Z] 
[INFO] 
Assigning policy 'Key vaults should have deletion protection enabled' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:08:57Z] 
[SUCCESS] 
Found 'Key vaults should have deletion protection enabled' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/0b60c0b2-2dc2-4e1c-b5c9-abbed971de53
[2026-01-22 15:08:57Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:08:57Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:08:57Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:08:57Z] 
[INFO] 
Dry-run: would create assignment with name Keyvaultsshouldhavedeletionprotectionenabled-1439856846 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:08:57Z] 
[INFO] 
Preparing to assign (20/30): Deploy - Configure diagnostic settings to an Event Hub to be enabled on Azure Key Vault Managed HSM
[2026-01-22 15:08:57Z] 
[INFO] 
Assigning policy 'Deploy - Configure diagnostic settings to an Event Hub to be enabled on Azure Key Vault Managed HSM' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:08:57Z] 
[SUCCESS] 
Found 'Deploy - Configure diagnostic settings to an Event Hub to be enabled on Azure Key Vault Managed HSM' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/a6d2c800-5230-4a40-bff3-8268b4987d42
[2026-01-22 15:08:58Z] 
[INFO] 
DEBUG: Checking parameter 'eventHubLocation' against policy definition
[2026-01-22 15:08:58Z] 
[INFO] 
DEBUG: Defined parameter names: effect, profileName, eventHubRuleId, eventHubLocation, metricsEnabled, logsEnabled
[2026-01-22 15:08:58Z] 
[INFO] 
DEBUG: Added parameter 'eventHubLocation' = 'eastus' to cleaned params
[2026-01-22 15:08:58Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:08:58Z] 
[INFO] 
DEBUG: Defined parameter names: effect, profileName, eventHubRuleId, eventHubLocation, metricsEnabled, logsEnabled
[2026-01-22 15:08:58Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'DeployIfNotExists' to cleaned params
[2026-01-22 15:08:58Z] 
[INFO] 
DEBUG: Checking parameter 'eventHubRuleId' against policy definition
[2026-01-22 15:08:58Z] 
[INFO] 
DEBUG: Defined parameter names: effect, profileName, eventHubRuleId, eventHubLocation, metricsEnabled, logsEnabled
[2026-01-22 15:08:58Z] 
[INFO] 
DEBUG: Added parameter 'eventHubRuleId' = '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.EventHub/namespaces/eh-policy-test-6513/authorizationrules/RootManageSharedAccessKey' to cleaned params
[2026-01-22 15:08:58Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '' (Length: 0)
[2026-01-22 15:08:58Z] 
[WARN] 
Effect '' requires managed identity. Skipping assignment - provide -IdentityResourceId to enable.

[2026-01-22 15:08:58Z] 
[INFO] 
Preparing to assign (21/30): [Preview]: Configure Azure Key Vault Managed HSM with private endpoints
[2026-01-22 15:08:58Z] 
[INFO] 
Assigning policy '[Preview]: Configure Azure Key Vault Managed HSM with private endpoints' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:08:58Z] 
[SUCCESS] 
Found '[Preview]: Configure Azure Key Vault Managed HSM with private endpoints' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/d1d6d8bb-cc7c-420f-8c7d-6f6f5279a844
[2026-01-22 15:08:58Z] 
[INFO] 
DEBUG: Checking parameter 'privateEndpointSubnetId' against policy definition
[2026-01-22 15:08:58Z] 
[INFO] 
DEBUG: Defined parameter names: privateEndpointSubnetId, effect
[2026-01-22 15:08:58Z] 
[INFO] 
DEBUG: Added parameter 'privateEndpointSubnetId' = '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.Network/virtualNetworks/vnet-policy-test/subnets/snet-privateendpoints' to cleaned params
[2026-01-22 15:08:58Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:08:58Z] 
[INFO] 
DEBUG: Defined parameter names: privateEndpointSubnetId, effect
[2026-01-22 15:08:58Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'DeployIfNotExists' to cleaned params
[2026-01-22 15:08:58Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '' (Length: 0)
[2026-01-22 15:08:58Z] 
[WARN] 
Effect '' requires managed identity. Skipping assignment - provide -IdentityResourceId to enable.

[2026-01-22 15:08:58Z] 
[INFO] 
Preparing to assign (22/30): Azure Key Vault should have firewall enabled or public network access disabled
[2026-01-22 15:08:58Z] 
[INFO] 
Assigning policy 'Azure Key Vault should have firewall enabled or public network access disabled' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:08:59Z] 
[SUCCESS] 
Found 'Azure Key Vault should have firewall enabled or public network access disabled' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/55615ac9-af46-4a59-874e-391cc3dfb490
[2026-01-22 15:08:59Z] 
[INFO] 
DEBUG: Checking parameter 'allowedIPAddresses' against policy definition
[2026-01-22 15:08:59Z] 
[INFO] 
DEBUG: Defined parameter names: effect, restrictIPAddresses, allowedIPAddresses, forbiddenIPAddresses
[2026-01-22 15:08:59Z] 
[INFO] 
DEBUG: Added parameter 'allowedIPAddresses' = '' to cleaned params
[2026-01-22 15:08:59Z] 
[INFO] 
DEBUG: Checking parameter 'forbiddenIPAddresses' against policy definition
[2026-01-22 15:08:59Z] 
[INFO] 
DEBUG: Defined parameter names: effect, restrictIPAddresses, allowedIPAddresses, forbiddenIPAddresses
[2026-01-22 15:08:59Z] 
[INFO] 
DEBUG: Added parameter 'forbiddenIPAddresses' = '' to cleaned params
[2026-01-22 15:08:59Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:08:59Z] 
[INFO] 
DEBUG: Defined parameter names: effect, restrictIPAddresses, allowedIPAddresses, forbiddenIPAddresses
[2026-01-22 15:08:59Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:08:59Z] 
[INFO] 
Dry-run: would create assignment with name AzureKeyVaultshouldhavefirewallenabledorpublicnetwork-1396884516 and params: 
Name                           Value
----                           -----
allowedIPAddresses             {}
forbiddenIPAddresses           {}
effect                         Audit



[2026-01-22 15:08:59Z] 
[INFO] 
Preparing to assign (23/30): Keys should have the specified maximum validity period
[2026-01-22 15:08:59Z] 
[INFO] 
Assigning policy 'Keys should have the specified maximum validity period' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:08:59Z] 
[SUCCESS] 
Found 'Keys should have the specified maximum validity period' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/49a22571-d204-4c91-a7b6-09b1a586fbc9
[2026-01-22 15:08:59Z] 
[INFO] 
DEBUG: Checking parameter 'maximumValidityInDays' against policy definition
[2026-01-22 15:08:59Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:08:59Z] 
[INFO] 
DEBUG: Added parameter 'maximumValidityInDays' = '1095' to cleaned params
[2026-01-22 15:08:59Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:08:59Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:08:59Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:08:59Z] 
[INFO] 
Dry-run: would create assignment with name Keysshouldhavethespecifiedmaximumvalidityperiod-906231923 and params: 
Name                           Value
----                           -----
maximumValidityInDays          1095
effect                         Audit



[2026-01-22 15:08:59Z] 
[INFO] 
Preparing to assign (24/30): Azure Key Vault should disable public network access
[2026-01-22 15:08:59Z] 
[INFO] 
Assigning policy 'Azure Key Vault should disable public network access' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:08:59Z] 
[SUCCESS] 
Found 'Azure Key Vault should disable public network access' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/405c5871-3e91-4644-8a63-58e19d68ff5b
[2026-01-22 15:09:00Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:00Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:09:00Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:00Z] 
[INFO] 
Dry-run: would create assignment with name AzureKeyVaultshoulddisablepublicnetworkaccess-906277113 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:09:00Z] 
[INFO] 
Preparing to assign (25/30): Certificates should be issued by one of the specified non-integrated certificate authorities
[2026-01-22 15:09:00Z] 
[INFO] 
Assigning policy 'Certificates should be issued by one of the specified non-integrated certificate authorities' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:00Z] 
[SUCCESS] 
Found 'Certificates should be issued by one of the specified non-integrated certificate authorities' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/d3e82b87-6673-410b-8501-1896b688b9a3
[2026-01-22 15:09:00Z] 
[INFO] 
DEBUG: Checking parameter 'caCommonNames' against policy definition
[2026-01-22 15:09:00Z] 
[INFO] 
DEBUG: Defined parameter names: caCommonNames, effect
[2026-01-22 15:09:00Z] 
[INFO] 
DEBUG: Added parameter 'caCommonNames' = 'CN=ContosoCA CN=InternalCA' to cleaned params
[2026-01-22 15:09:00Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:00Z] 
[INFO] 
DEBUG: Defined parameter names: caCommonNames, effect
[2026-01-22 15:09:00Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:00Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesshouldbeissuedbyoneofthespecifiednonintegr-165973907 and params: 
Name                           Value
----                           -----
caCommonNames                  {CN=ContosoCA, CN=InternalCA}
effect                         Audit



[2026-01-22 15:09:00Z] 
[INFO] 
Preparing to assign (26/30): Keys should not be active for longer than the specified number of days
[2026-01-22 15:09:00Z] 
[INFO] 
Assigning policy 'Keys should not be active for longer than the specified number of days' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:00Z] 
[SUCCESS] 
Found 'Keys should not be active for longer than the specified number of days' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/c26e4b24-cf98-4c67-b48b-5a25c4c69eb9
[2026-01-22 15:09:00Z] 
[INFO] 
DEBUG: Checking parameter 'maximumValidityInDays' against policy definition
[2026-01-22 15:09:00Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:09:00Z] 
[INFO] 
DEBUG: Added parameter 'maximumValidityInDays' = '730' to cleaned params
[2026-01-22 15:09:00Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:00Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:09:00Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:00Z] 
[INFO] 
Dry-run: would create assignment with name Keysshouldnotbeactiveforlongerthanthespecifiednumbero-1296256806 and params: 
Name                           Value
----                           -----
maximumValidityInDays          730
effect                         Audit



[2026-01-22 15:09:00Z] 
[INFO] 
Preparing to assign (27/30): Certificates using RSA cryptography should have the specified minimum key size
[2026-01-22 15:09:00Z] 
[INFO] 
Assigning policy 'Certificates using RSA cryptography should have the specified minimum key size' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:00Z] 
[SUCCESS] 
Found 'Certificates using RSA cryptography should have the specified minimum key size' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/cee51871-e572-4576-855c-047c820360f0
[2026-01-22 15:09:01Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:01Z] 
[INFO] 
DEBUG: Defined parameter names: minimumRSAKeySize, effect
[2026-01-22 15:09:01Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:01Z] 
[INFO] 
DEBUG: Checking parameter 'minimumRSAKeySize' against policy definition
[2026-01-22 15:09:01Z] 
[INFO] 
DEBUG: Defined parameter names: minimumRSAKeySize, effect
[2026-01-22 15:09:01Z] 
[INFO] 
DEBUG: Added parameter 'minimumRSAKeySize' = '2048' to cleaned params
[2026-01-22 15:09:01Z] 
[INFO] 
Dry-run: would create assignment with name CertificatesusingRSAcryptographyshouldhavethespecifie-2031578458 and params: 
Name                           Value
----                           -----
minimumRSAKeySize              2048
effect                         Audit



[2026-01-22 15:09:01Z] 
[INFO] 
Preparing to assign (28/30): Secrets should have the specified maximum validity period
[2026-01-22 15:09:01Z] 
[INFO] 
Assigning policy 'Secrets should have the specified maximum validity period' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:01Z] 
[SUCCESS] 
Found 'Secrets should have the specified maximum validity period' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/342e8053-e12e-4c44-be01-c3c2f318400f
[2026-01-22 15:09:01Z] 
[INFO] 
DEBUG: Checking parameter 'maximumValidityInDays' against policy definition
[2026-01-22 15:09:01Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:09:01Z] 
[INFO] 
DEBUG: Added parameter 'maximumValidityInDays' = '1095' to cleaned params
[2026-01-22 15:09:01Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:01Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:09:01Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:01Z] 
[INFO] 
Dry-run: would create assignment with name Secretsshouldhavethespecifiedmaximumvalidityperiod-1663466362 and params: 
Name                           Value
----                           -----
maximumValidityInDays          1095
effect                         Audit



[2026-01-22 15:09:01Z] 
[INFO] 
Preparing to assign (29/30): Configure Azure Key Vaults to use private DNS zones
[2026-01-22 15:09:01Z] 
[INFO] 
Assigning policy 'Configure Azure Key Vaults to use private DNS zones' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:01Z] 
[SUCCESS] 
Found 'Configure Azure Key Vaults to use private DNS zones' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/ac673a9a-f77d-4846-b2d8-a57f8e1c01d4
[2026-01-22 15:09:02Z] 
[INFO] 
DEBUG: Checking parameter 'privateDnsZoneId' against policy definition
[2026-01-22 15:09:02Z] 
[INFO] 
DEBUG: Defined parameter names: privateDnsZoneId, effect
[2026-01-22 15:09:02Z] 
[INFO] 
DEBUG: Added parameter 'privateDnsZoneId' = '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.Network/privateDnsZones/privatelink.vaultcore.azure.net' to cleaned params
[2026-01-22 15:09:02Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:02Z] 
[INFO] 
DEBUG: Defined parameter names: privateDnsZoneId, effect
[2026-01-22 15:09:02Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'DeployIfNotExists' to cleaned params
[2026-01-22 15:09:02Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '' (Length: 0)
[2026-01-22 15:09:02Z] 
[WARN] 
Effect '' requires managed identity. Skipping assignment - provide -IdentityResourceId to enable.

[2026-01-22 15:09:02Z] 
[INFO] 
Preparing to assign (30/30): [Preview]: Configure Azure Key Vault Managed HSM to disable public network access
[2026-01-22 15:09:02Z] 
[INFO] 
Assigning policy '[Preview]: Configure Azure Key Vault Managed HSM to disable public network access' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:02Z] 
[SUCCESS] 
Found '[Preview]: Configure Azure Key Vault Managed HSM to disable public network access' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/84d327c3-164a-4685-b453-900478614456
[2026-01-22 15:09:02Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:02Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:09:02Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Modify' to cleaned params
[2026-01-22 15:09:02Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '' (Length: 0)
[2026-01-22 15:09:02Z] 
[WARN] 
Effect '' requires managed identity. Skipping assignment - provide -IdentityResourceId to enable.
[2026-01-22 15:09:02Z] 
[INFO] 
Collected 0 assignment IDs for filtering
[2026-01-22 15:09:02Z] 
[INFO] 
Wrote reports: KeyVaultPolicyImplementationReport-20260122-150902.md, KeyVaultPolicyImplementationReport-20260122-150902.json, KeyVaultPolicyImplementationReport-20260122-150902.csv
[2026-01-22 15:09:02Z] 
[SUCCESS] 
HTML report generated: ./PolicyImplementationReport-20260122-150902.html
Dry-run summary written to ./DryRunSummary.txt

[2026-01-22 15:09:02Z] 
[INFO] 
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-01-22 15:09:02Z] 
[INFO] 
                    ğŸ“‹ NEXT STEPS GUIDANCE
[2026-01-22 15:09:02Z] 
[INFO] 
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ¯ Dry-Run Validation Complete

âœ… What was validated:
  â†’ Policy definitions resolved from mapping file
  â†’ Parameter overrides validated against policy schemas
  â†’ Assignment names generated (64-char limit enforced)
  â†’ No actual Azure resources created or modified

ğŸ“‹ Recommended Next Steps:
  1. ğŸ“„ Review dry-run summary:
     
notepad ./DryRunSummary.txt
  2. âœ… Verify all policies resolved successfully (Status: DryRun)
  3. ğŸ” Check for policies requiring managed identity (DeployIfNotExists/Modify effects)
  4. ğŸ“Š Review parameter values match your requirements
  5. ğŸš€ Deploy to test environment when ready:
     
.\\AzPolicyImplScript.ps1 -ParameterFile <YOUR_PARAM_FILE> -SkipRBACCheck

âš ï¸  Common Issues to Check:
  â†’ Policies with Status='Skipped' require -IdentityResourceId parameter
  â†’ Verify parameter values don't exceed policy min/max constraints
  â†’ Check for typos in policy display names (lookup failures)

ğŸ“š Documentation:
  â†’ Parameter File Guide: PolicyParameters-QuickReference.md
  â†’ Deployment Workflow: DEPLOYMENT-WORKFLOW-GUIDE.md


ğŸ“‹ Dry-Run Summary: 
./DryRunSummary.txt


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-01-22 15:09:02Z] 
[SUCCESS] 
Completed run. Reports generated.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“„ Reports Generated:
  â€¢ HTML:     
./PolicyImplementationReport-20260122-150902.html
  â€¢ Markdown: 
KeyVaultPolicyImplementationReport-20260122-150902.md
  â€¢ JSON:     
KeyVaultPolicyImplementationReport-20260122-150902.json


[2026-01-22 15:09:02Z] 
[INFO] 
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-01-22 15:09:02Z] 
[INFO] 
                    ğŸ“‹ NEXT STEPS GUIDANCE
[2026-01-22 15:09:02Z] 
[INFO] 
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ¯ DevTest Deployment Complete (30 Policies - Audit Mode)

âœ… What was deployed:
  â†’ 30 Azure Key Vault governance policies in Audit mode
  â†’ Monitoring compliance without blocking operations
  â†’ Test environment: rg-policy-keyvault-test resource group

ğŸ“‹ Recommended Next Steps:
  1. â³ Wait 30-60 minutes for Azure Policy evaluation cycle
  2. ğŸ“Š Check compliance status:
     
.\\AzPolicyImplScript.ps1 -CheckCompliance -TriggerScan
  3. ğŸ§ª Test infrastructure validation:
     
.\\AzPolicyImplScript.ps1 -TestInfrastructure -Detailed
  4. ğŸ“ˆ Deploy full 46-policy suite when ready:
     
.\\AzPolicyImplScript.ps1 -ParameterFile .\\PolicyParameters-DevTest-Full.json

ğŸ“š Documentation:
  â†’ Testing Guide: QUICKSTART.md (lines 1-150)
  â†’ Policy List: DefinitionListExport.csv (first 30 policies)

[2026-01-22 15:09:03] [SUCCESS]   âœ… Command executed successfully
[2026-01-22 15:09:03] [INFO]   Output saved to: .\scenario-1-output-20260122-150844.txt
[2026-01-22 15:09:03] [ERROR]   âŒ Console next steps validation failed for DevTest Baseline (30 Policies)
[2026-01-22 15:09:03] [ERROR]     - Missing 'NEXT STEPS GUIDANCE' banner
[2026-01-22 15:09:03] [ERROR]     - Missing DevTest30 deployment banner
[2026-01-22 15:09:03] [ERROR]     - Missing recommendation to deploy full 46-policy suite
[2026-01-22 15:09:03] [SUCCESS]   âœ… HTML report validated for DevTest Baseline (30 Policies)
[2026-01-22 15:09:03] [SUCCESS]   âœ… No unexpected warnings/errors for DevTest Baseline (30 Policies)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-01-22 15:09:05] [INFO] SCENARIO 2: DevTest Full (46 Policies)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-01-22 15:09:05] [INFO] Executing: .\AzPolicyImplScript.ps1 -ParameterFile .\PolicyParameters-DevTest-Full.json -SkipRBACCheck -Preview

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  Azure Policy Implementation - Key Vault Governance          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[2026-01-22 15:09:05Z] 
[INFO] 
Starting Azure Policy implementation script for Key Vault policies
[2026-01-22 15:09:05Z] 
[INFO] 
Checking required PowerShell modules...
[2026-01-22 15:09:05Z] 
[SUCCESS] 
Module Az.Accounts is present
[2026-01-22 15:09:05Z] 
[SUCCESS] 
Module Az.Resources is present
[2026-01-22 15:09:05Z] 
[SUCCESS] 
Module Az.PolicyInsights is present
[2026-01-22 15:09:05Z] 
[SUCCESS] 
Module Az.Monitor is present
[2026-01-22 15:09:05Z] 
[SUCCESS] 
Module Az.KeyVault is present
[2026-01-22 15:09:05Z] 
[INFO] 
Using Azure context: theregniers@hotmail.com
[2026-01-22 15:09:05Z] 
[INFO] 
Loading policy mapping from ./PolicyNameMapping.json
[2026-01-22 15:09:05Z] 
[INFO] 
Loaded 3745 policy mappings
[2026-01-22 15:09:05Z] 
[INFO] 
Loading policy parameter overrides from .\PolicyParameters-DevTest-Full.json
[2026-01-22 15:09:05Z] 
[INFO] 
Detected deployment type: DevTestFull46 (from parameter file: PolicyParameters-DevTest-Full.json)
[2026-01-22 15:09:05Z] 
[INFO] 
Preview mode enabled: setting DryRun and skipping RBAC checks.
[2026-01-22 15:09:05Z] 
[INFO] 
DEBUG: PSBoundParameters keys: CsvPath, ParameterOverridesPath, SkipRBACCheck, Preview
[2026-01-22 15:09:05Z] 
[INFO] 
DEBUG: ScopeType value: ''
[2026-01-22 15:09:05Z] 
[INFO] 
Dry-run mode: using Subscription scope by default
[2026-01-22 15:09:05Z] 
[INFO] 
Checking current subscription context.
[2026-01-22 15:09:05Z] 
[INFO] 
Current subscription: MSDN Platforms Subscription (ab1336c7-687d-4107-b0f6-9649a0458adb)
[2026-01-22 15:09:05Z] 
[INFO] 
Dry-run mode: using current subscription context
[2026-01-22 15:09:05Z] 
[INFO] 
Preview mode: skipped RBAC permission check.
[2026-01-22 15:09:05Z] 
[INFO] 
Using policy effects from parameter file: .\PolicyParameters-DevTest-Full.json
[2026-01-22 15:09:05Z] 
[SUCCESS] 
Loaded 46 policies from parameter file: .\PolicyParameters-DevTest-Full.json

Processing 46 policies...
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

[2026-01-22 15:09:05Z] 
[INFO] 
Preparing to assign (1/46): Certificates using elliptic curve cryptography should have allowed curve names
[2026-01-22 15:09:05Z] 
[INFO] 
Assigning policy 'Certificates using elliptic curve cryptography should have allowed curve names' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:05Z] 
[SUCCESS] 
Found 'Certificates using elliptic curve cryptography should have allowed curve names' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/bd78111f-4953-4367-9fd5-7e08808b54bf
[2026-01-22 15:09:05Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:05Z] 
[INFO] 
DEBUG: Defined parameter names: allowedECNames, effect
[2026-01-22 15:09:05Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:09:05Z] 
[INFO] 
DEBUG: Checking parameter 'allowedECNames' against policy definition
[2026-01-22 15:09:05Z] 
[INFO] 
DEBUG: Defined parameter names: allowedECNames, effect
[2026-01-22 15:09:05Z] 
[INFO] 
DEBUG: Added parameter 'allowedECNames' = 'P-256 P-256K P-384 P-521' to cleaned params
[2026-01-22 15:09:05Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesusingellipticcurvecryptographyshouldhavea-1468057639 and params: 
Name                           Value
----                           -----
allowedECNames                 {P-256, P-256K, P-384, P-521}
effect                         Deny



[2026-01-22 15:09:05Z] 
[INFO] 
Preparing to assign (2/46): Configure key vaults to enable firewall
[2026-01-22 15:09:05Z] 
[INFO] 
Assigning policy 'Configure key vaults to enable firewall' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:05Z] 
[SUCCESS] 
Found 'Configure key vaults to enable firewall' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/ac673a9a-f77d-4846-b2d8-a57f8e1c01dc
[2026-01-22 15:09:06Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:06Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:09:06Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Modify' to cleaned params
[2026-01-22 15:09:06Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '' (Length: 0)
[2026-01-22 15:09:06Z] 
[WARN] 
Effect '' requires managed identity. Skipping assignment - provide -IdentityResourceId to enable.

[2026-01-22 15:09:06Z] 
[INFO] 
Preparing to assign (3/46): Azure Key Vault should use RBAC permission model
[2026-01-22 15:09:06Z] 
[INFO] 
Assigning policy 'Azure Key Vault should use RBAC permission model' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:06Z] 
[SUCCESS] 
Found 'Azure Key Vault should use RBAC permission model' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/12d4fa5e-1f9f-4c21-97a9-b99b3c6611b5
[2026-01-22 15:09:06Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:06Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:09:06Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:09:06Z] 
[INFO] 
Dry-run: would create assignment with name AzureKeyVaultshoulduseRBACpermissionmodel-307198231 and params: 
Name                           Value
----                           -----
effect                         Deny



[2026-01-22 15:09:06Z] 
[INFO] 
Preparing to assign (4/46): Keys should be the specified cryptographic type RSA or EC
[2026-01-22 15:09:06Z] 
[INFO] 
Assigning policy 'Keys should be the specified cryptographic type RSA or EC' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:06Z] 
[SUCCESS] 
Found 'Keys should be the specified cryptographic type RSA or EC' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/75c4f823-d65c-4f29-a733-01d0077fdbcb
[2026-01-22 15:09:07Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:07Z] 
[INFO] 
DEBUG: Defined parameter names: allowedKeyTypes, effect
[2026-01-22 15:09:07Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:09:07Z] 
[INFO] 
Dry-run: would create assignment with name KeysshouldbethespecifiedcryptographictypeRSAorEC-976981238 and params: 
Name                           Value
----                           -----
effect                         Deny



[2026-01-22 15:09:07Z] 
[INFO] 
Preparing to assign (5/46): Keys using elliptic curve cryptography should have the specified curve names
[2026-01-22 15:09:07Z] 
[INFO] 
Assigning policy 'Keys using elliptic curve cryptography should have the specified curve names' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:07Z] 
[SUCCESS] 
Found 'Keys using elliptic curve cryptography should have the specified curve names' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/ff25f3c8-b739-4538-9d07-3d6d25cfb255
[2026-01-22 15:09:07Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:07Z] 
[INFO] 
DEBUG: Defined parameter names: allowedECNames, effect
[2026-01-22 15:09:07Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:07Z] 
[INFO] 
DEBUG: Checking parameter 'allowedECNames' against policy definition
[2026-01-22 15:09:07Z] 
[INFO] 
DEBUG: Defined parameter names: allowedECNames, effect
[2026-01-22 15:09:07Z] 
[INFO] 
DEBUG: Added parameter 'allowedECNames' = 'P-256 P-256K P-384 P-521' to cleaned params
[2026-01-22 15:09:07Z] 
[INFO] 
Dry-run: would create assignment with name Keysusingellipticcurvecryptographyshouldhavethespecif-1437325202 and params: 
Name                           Value
----                           -----
allowedECNames                 {P-256, P-256K, P-384, P-521}
effect                         Audit



[2026-01-22 15:09:07Z] 
[INFO] 
Preparing to assign (6/46): Deploy Diagnostic Settings for Key Vault to Event Hub
[2026-01-22 15:09:07Z] 
[INFO] 
Assigning policy 'Deploy Diagnostic Settings for Key Vault to Event Hub' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:07Z] 
[SUCCESS] 
Found 'Deploy Diagnostic Settings for Key Vault to Event Hub' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/ed7c8c13-51e7-49d1-8a43-8490431a0da2
[2026-01-22 15:09:07Z] 
[INFO] 
DEBUG: Checking parameter 'eventHubLocation' against policy definition
[2026-01-22 15:09:07Z] 
[INFO] 
DEBUG: Defined parameter names: effect, profileName, eventHubRuleId, eventHubLocation, metricsEnabled, logsEnabled
[2026-01-22 15:09:07Z] 
[INFO] 
DEBUG: Added parameter 'eventHubLocation' = 'eastus' to cleaned params
[2026-01-22 15:09:07Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:07Z] 
[INFO] 
DEBUG: Defined parameter names: effect, profileName, eventHubRuleId, eventHubLocation, metricsEnabled, logsEnabled
[2026-01-22 15:09:07Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'DeployIfNotExists' to cleaned params
[2026-01-22 15:09:07Z] 
[INFO] 
DEBUG: Checking parameter 'eventHubRuleId' against policy definition
[2026-01-22 15:09:07Z] 
[INFO] 
DEBUG: Defined parameter names: effect, profileName, eventHubRuleId, eventHubLocation, metricsEnabled, logsEnabled
[2026-01-22 15:09:07Z] 
[INFO] 
DEBUG: Added parameter 'eventHubRuleId' = '' to cleaned params
[2026-01-22 15:09:07Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '' (Length: 0)
[2026-01-22 15:09:07Z] 
[WARN] 
Effect '' requires managed identity. Skipping assignment - provide -IdentityResourceId to enable.

[2026-01-22 15:09:07Z] 
[INFO] 
Preparing to assign (7/46): Keys using RSA cryptography should have a specified minimum key size
[2026-01-22 15:09:07Z] 
[INFO] 
Assigning policy 'Keys using RSA cryptography should have a specified minimum key size' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:07Z] 
[SUCCESS] 
Found 'Keys using RSA cryptography should have a specified minimum key size' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/82067dbb-e53b-4e06-b631-546d197452d9
[2026-01-22 15:09:08Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:08Z] 
[INFO] 
DEBUG: Defined parameter names: minimumRSAKeySize, effect
[2026-01-22 15:09:08Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:08Z] 
[INFO] 
DEBUG: Checking parameter 'minimumRSAKeySize' against policy definition
[2026-01-22 15:09:08Z] 
[INFO] 
DEBUG: Defined parameter names: minimumRSAKeySize, effect
[2026-01-22 15:09:08Z] 
[INFO] 
DEBUG: Added parameter 'minimumRSAKeySize' = '2048' to cleaned params
[2026-01-22 15:09:08Z] 
[INFO] 
Dry-run: would create assignment with name KeysusingRSAcryptographyshouldhaveaspecifiedminimumkey-909744685 and params: 
Name                           Value
----                           -----
minimumRSAKeySize              2048
effect                         Audit



[2026-01-22 15:09:08Z] 
[INFO] 
Preparing to assign (8/46): Deploy - Configure diagnostic settings for Azure Key Vault to Log Analytics workspace
[2026-01-22 15:09:08Z] 
[INFO] 
Assigning policy 'Deploy - Configure diagnostic settings for Azure Key Vault to Log Analytics workspace' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:08Z] 
[SUCCESS] 
Found 'Deploy - Configure diagnostic settings for Azure Key Vault to Log Analytics workspace' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/951af2fa-529b-416e-ab6e-066fd85ac459
[2026-01-22 15:09:08Z] 
[INFO] 
DEBUG: Checking parameter 'logAnalytics' against policy definition
[2026-01-22 15:09:08Z] 
[INFO] 
DEBUG: Defined parameter names: effect, diagnosticsSettingNameToUse, logAnalytics, AuditEventEnabled, AllMetricsEnabled
[2026-01-22 15:09:08Z] 
[INFO] 
DEBUG: Added parameter 'logAnalytics' = '' to cleaned params
[2026-01-22 15:09:08Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:08Z] 
[INFO] 
DEBUG: Defined parameter names: effect, diagnosticsSettingNameToUse, logAnalytics, AuditEventEnabled, AllMetricsEnabled
[2026-01-22 15:09:08Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'DeployIfNotExists' to cleaned params
[2026-01-22 15:09:08Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '' (Length: 0)
[2026-01-22 15:09:08Z] 
[WARN] 
Effect '' requires managed identity. Skipping assignment - provide -IdentityResourceId to enable.

[2026-01-22 15:09:08Z] 
[INFO] 
Preparing to assign (9/46): [Preview]: Azure Key Vault Managed HSM keys using RSA cryptography should have a specified minimum key size
[2026-01-22 15:09:08Z] 
[INFO] 
Assigning policy '[Preview]: Azure Key Vault Managed HSM keys using RSA cryptography should have a specified minimum key size' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:08Z] 
[SUCCESS] 
Found '[Preview]: Azure Key Vault Managed HSM keys using RSA cryptography should have a specified minimum key size' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/86810a98-8e91-4a44-8386-ec66d0de5d57
[2026-01-22 15:09:08Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:08Z] 
[INFO] 
DEBUG: Defined parameter names: effect, minimumRSAKeySize
[2026-01-22 15:09:08Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:08Z] 
[INFO] 
DEBUG: Checking parameter 'minimumRSAKeySize' against policy definition
[2026-01-22 15:09:08Z] 
[INFO] 
DEBUG: Defined parameter names: effect, minimumRSAKeySize
[2026-01-22 15:09:08Z] 
[INFO] 
DEBUG: Added parameter 'minimumRSAKeySize' = '2048' to cleaned params
[2026-01-22 15:09:08Z] 
[INFO] 
Dry-run: would create assignment with name PreviewAzureKeyVaultManagedHSMkeysusingRSAcryptography-998252524 and params: 
Name                           Value
----                           -----
minimumRSAKeySize              2048
effect                         Audit



[2026-01-22 15:09:08Z] 
[INFO] 
Preparing to assign (10/46): Certificates should be issued by the specified integrated certificate authority
[2026-01-22 15:09:08Z] 
[INFO] 
Assigning policy 'Certificates should be issued by the specified integrated certificate authority' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:08Z] 
[SUCCESS] 
Found 'Certificates should be issued by the specified integrated certificate authority' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/8e826246-c976-48f6-b03e-619bb92b3d82
[2026-01-22 15:09:09Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:09Z] 
[INFO] 
DEBUG: Defined parameter names: allowedCAs, effect
[2026-01-22 15:09:09Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:09Z] 
[INFO] 
DEBUG: Checking parameter 'allowedCAs' against policy definition
[2026-01-22 15:09:09Z] 
[INFO] 
DEBUG: Defined parameter names: allowedCAs, effect
[2026-01-22 15:09:09Z] 
[INFO] 
DEBUG: Added parameter 'allowedCAs' = 'DigiCert GlobalSign' to cleaned params
[2026-01-22 15:09:09Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesshouldbeissuedbythespecifiedintegratedcer-1190107367 and params: 
Name                           Value
----                           -----
allowedCAs                     {DigiCert, GlobalSign}
effect                         Audit



[2026-01-22 15:09:09Z] 
[INFO] 
Preparing to assign (11/46): Secrets should have more than the specified number of days before expiration
[2026-01-22 15:09:09Z] 
[INFO] 
Assigning policy 'Secrets should have more than the specified number of days before expiration' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:09Z] 
[SUCCESS] 
Found 'Secrets should have more than the specified number of days before expiration' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/b0eb591a-5e70-4534-a8bf-04b9c489584a
[2026-01-22 15:09:09Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:09Z] 
[INFO] 
DEBUG: Defined parameter names: minimumDaysBeforeExpiration, effect
[2026-01-22 15:09:09Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:09Z] 
[INFO] 
DEBUG: Checking parameter 'minimumDaysBeforeExpiration' against policy definition
[2026-01-22 15:09:09Z] 
[INFO] 
DEBUG: Defined parameter names: minimumDaysBeforeExpiration, effect
[2026-01-22 15:09:09Z] 
[INFO] 
DEBUG: Added parameter 'minimumDaysBeforeExpiration' = '30' to cleaned params
[2026-01-22 15:09:09Z] 
[INFO] 
Dry-run: would create assignment with name Secretsshouldhavemorethanthespecifiednumberofdaysbefo-1193127515 and params: 
Name                           Value
----                           -----
minimumDaysBeforeExpiration    30
effect                         Audit



[2026-01-22 15:09:09Z] 
[INFO] 
Preparing to assign (12/46): Configure Azure Key Vaults to use private DNS zones
[2026-01-22 15:09:09Z] 
[INFO] 
Assigning policy 'Configure Azure Key Vaults to use private DNS zones' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:09Z] 
[SUCCESS] 
Found 'Configure Azure Key Vaults to use private DNS zones' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/ac673a9a-f77d-4846-b2d8-a57f8e1c01d4
[2026-01-22 15:09:09Z] 
[INFO] 
DEBUG: Checking parameter 'privateDnsZoneId' against policy definition
[2026-01-22 15:09:09Z] 
[INFO] 
DEBUG: Defined parameter names: privateDnsZoneId, effect
[2026-01-22 15:09:09Z] 
[INFO] 
DEBUG: Added parameter 'privateDnsZoneId' = '' to cleaned params
[2026-01-22 15:09:09Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:09Z] 
[INFO] 
DEBUG: Defined parameter names: privateDnsZoneId, effect
[2026-01-22 15:09:09Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'DeployIfNotExists' to cleaned params
[2026-01-22 15:09:09Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '' (Length: 0)
[2026-01-22 15:09:09Z] 
[WARN] 
Effect '' requires managed identity. Skipping assignment - provide -IdentityResourceId to enable.

[2026-01-22 15:09:09Z] 
[INFO] 
Preparing to assign (13/46): Configure Azure Key Vaults with private endpoints
[2026-01-22 15:09:09Z] 
[INFO] 
Assigning policy 'Configure Azure Key Vaults with private endpoints' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:09Z] 
[SUCCESS] 
Found 'Configure Azure Key Vaults with private endpoints' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/9d4fad1f-5189-4a42-b29e-cf7929c6b6df
[2026-01-22 15:09:10Z] 
[INFO] 
DEBUG: Checking parameter 'privateEndpointSubnetId' against policy definition
[2026-01-22 15:09:10Z] 
[INFO] 
DEBUG: Defined parameter names: privateEndpointSubnetId, effect
[2026-01-22 15:09:10Z] 
[INFO] 
DEBUG: Added parameter 'privateEndpointSubnetId' = '' to cleaned params
[2026-01-22 15:09:10Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:10Z] 
[INFO] 
DEBUG: Defined parameter names: privateEndpointSubnetId, effect
[2026-01-22 15:09:10Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'DeployIfNotExists' to cleaned params
[2026-01-22 15:09:10Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '' (Length: 0)
[2026-01-22 15:09:10Z] 
[WARN] 
Effect '' requires managed identity. Skipping assignment - provide -IdentityResourceId to enable.

[2026-01-22 15:09:10Z] 
[INFO] 
Preparing to assign (14/46): [Preview]: Azure Key Vault Managed HSM keys should have an expiration date
[2026-01-22 15:09:10Z] 
[INFO] 
Assigning policy '[Preview]: Azure Key Vault Managed HSM keys should have an expiration date' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:10Z] 
[SUCCESS] 
Found '[Preview]: Azure Key Vault Managed HSM keys should have an expiration date' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/1d478a74-21ba-4b9f-9d8f-8e6fced0eec5
[2026-01-22 15:09:10Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:10Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:09:10Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:09:10Z] 
[INFO] 
Dry-run: would create assignment with name PreviewAzureKeyVaultManagedHSMkeysshouldhaveanexpirati-976371970 and params: 
Name                           Value
----                           -----
effect                         Deny



[2026-01-22 15:09:10Z] 
[INFO] 
Preparing to assign (15/46): Key Vault keys should have an expiration date
[2026-01-22 15:09:10Z] 
[INFO] 
Assigning policy 'Key Vault keys should have an expiration date' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:10Z] 
[SUCCESS] 
Found 'Key Vault keys should have an expiration date' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/152b15f7-8e1f-4c1f-ab71-8c010ba5dbc0
[2026-01-22 15:09:11Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:11Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:09:11Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:11Z] 
[INFO] 
Dry-run: would create assignment with name KeyVaultkeysshouldhaveanexpirationdate-386037801 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:09:11Z] 
[INFO] 
Preparing to assign (16/46): Key vaults should have soft delete enabled
[2026-01-22 15:09:11Z] 
[INFO] 
Assigning policy 'Key vaults should have soft delete enabled' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:11Z] 
[SUCCESS] 
Found 'Key vaults should have soft delete enabled' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/1e66c121-a66a-4b1f-9b83-0fd99bf0fc2d
[2026-01-22 15:09:11Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:11Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:09:11Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:11Z] 
[INFO] 
Dry-run: would create assignment with name Keyvaultsshouldhavesoftdeleteenabled-656701378 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:09:11Z] 
[INFO] 
Preparing to assign (17/46): Certificates should use allowed key types
[2026-01-22 15:09:11Z] 
[INFO] 
Assigning policy 'Certificates should use allowed key types' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:11Z] 
[SUCCESS] 
Found 'Certificates should use allowed key types' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/1151cede-290b-4ba0-8b38-0ad145ac888f
[2026-01-22 15:09:11Z] 
[INFO] 
DEBUG: Checking parameter 'allowedKeyTypes' against policy definition
[2026-01-22 15:09:11Z] 
[INFO] 
DEBUG: Defined parameter names: allowedKeyTypes, effect
[2026-01-22 15:09:11Z] 
[INFO] 
DEBUG: Added parameter 'allowedKeyTypes' = 'RSA EC' to cleaned params
[2026-01-22 15:09:11Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:11Z] 
[INFO] 
DEBUG: Defined parameter names: allowedKeyTypes, effect
[2026-01-22 15:09:11Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:09:11Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesshoulduseallowedkeytypes-246707145 and params: 
Name                           Value
----                           -----
allowedKeyTypes                {RSA, EC}
effect                         Deny



[2026-01-22 15:09:11Z] 
[INFO] 
Preparing to assign (18/46): Resource logs in Key Vault should be enabled
[2026-01-22 15:09:11Z] 
[INFO] 
Assigning policy 'Resource logs in Key Vault should be enabled' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:11Z] 
[SUCCESS] 
Found 'Resource logs in Key Vault should be enabled' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21
[2026-01-22 15:09:12Z] 
[INFO] 
DEBUG: Checking parameter 'requiredRetentionDays' against policy definition
[2026-01-22 15:09:12Z] 
[INFO] 
DEBUG: Defined parameter names: effect, requiredRetentionDays
[2026-01-22 15:09:12Z] 
[INFO] 
DEBUG: Added parameter 'requiredRetentionDays' = '90' to cleaned params
[2026-01-22 15:09:12Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:12Z] 
[INFO] 
DEBUG: Defined parameter names: effect, requiredRetentionDays
[2026-01-22 15:09:12Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'AuditIfNotExists' to cleaned params
[2026-01-22 15:09:12Z] 
[INFO] 
Dry-run: would create assignment with name ResourcelogsinKeyVaultshouldbeenabled-1683835535 and params: 
Name                           Value
----                           -----
requiredRetentionDays          90
effect                         AuditIfNotExists



[2026-01-22 15:09:12Z] 
[INFO] 
Preparing to assign (19/46): Certificates should have the specified lifetime action triggers
[2026-01-22 15:09:12Z] 
[INFO] 
Assigning policy 'Certificates should have the specified lifetime action triggers' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:12Z] 
[SUCCESS] 
Found 'Certificates should have the specified lifetime action triggers' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/12ef42cb-9903-4e39-9c26-422d29570417
[2026-01-22 15:09:12Z] 
[INFO] 
DEBUG: Checking parameter 'maximumPercentageLife' against policy definition
[2026-01-22 15:09:12Z] 
[INFO] 
DEBUG: Defined parameter names: maximumPercentageLife, minimumDaysBeforeExpiry, effect
[2026-01-22 15:09:12Z] 
[INFO] 
DEBUG: Added parameter 'maximumPercentageLife' = '80' to cleaned params
[2026-01-22 15:09:12Z] 
[INFO] 
DEBUG: Checking parameter 'minimumDaysBeforeExpiry' against policy definition
[2026-01-22 15:09:12Z] 
[INFO] 
DEBUG: Defined parameter names: maximumPercentageLife, minimumDaysBeforeExpiry, effect
[2026-01-22 15:09:12Z] 
[INFO] 
DEBUG: Added parameter 'minimumDaysBeforeExpiry' = '30' to cleaned params
[2026-01-22 15:09:12Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:12Z] 
[INFO] 
DEBUG: Defined parameter names: maximumPercentageLife, minimumDaysBeforeExpiry, effect
[2026-01-22 15:09:12Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:12Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesshouldhavethespecifiedlifetimeactiontrigg-1761965968 and params: 
Name                           Value
----                           -----
maximumPercentageLife          80
minimumDaysBeforeExpiry        30
effect                         Audit



[2026-01-22 15:09:12Z] 
[INFO] 
Preparing to assign (20/46): Secrets should not be active for longer than the specified number of days
[2026-01-22 15:09:12Z] 
[INFO] 
Assigning policy 'Secrets should not be active for longer than the specified number of days' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:12Z] 
[SUCCESS] 
Found 'Secrets should not be active for longer than the specified number of days' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/e8d99835-8a06-45ae-a8e0-87a91941ccfe
[2026-01-22 15:09:13Z] 
[INFO] 
DEBUG: Checking parameter 'maximumValidityInDays' against policy definition
[2026-01-22 15:09:13Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:09:13Z] 
[INFO] 
DEBUG: Added parameter 'maximumValidityInDays' = '1095' to cleaned params
[2026-01-22 15:09:13Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:13Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:09:13Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:13Z] 
[INFO] 
Dry-run: would create assignment with name Secretsshouldnotbeactiveforlongerthanthespecifiednumb-1452013840 and params: 
Name                           Value
----                           -----
maximumValidityInDays          1095
effect                         Audit



[2026-01-22 15:09:13Z] 
[INFO] 
Preparing to assign (21/46): Certificates should be issued by the specified non-integrated certificate authority
[2026-01-22 15:09:13Z] 
[INFO] 
Assigning policy 'Certificates should be issued by the specified non-integrated certificate authority' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:13Z] 
[SUCCESS] 
Found 'Certificates should be issued by the specified non-integrated certificate authority' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/a22f4a40-01d3-4c7d-8071-da157eeff341
[2026-01-22 15:09:13Z] 
[INFO] 
DEBUG: Checking parameter 'caCommonName' against policy definition
[2026-01-22 15:09:13Z] 
[INFO] 
DEBUG: Defined parameter names: caCommonName, effect
[2026-01-22 15:09:13Z] 
[INFO] 
DEBUG: Added parameter 'caCommonName' = 'ContosoCA' to cleaned params
[2026-01-22 15:09:13Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:13Z] 
[INFO] 
DEBUG: Defined parameter names: caCommonName, effect
[2026-01-22 15:09:13Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:13Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesshouldbeissuedbythespecifiednonintegratedc-500792775 and params: 
Name                           Value
----                           -----
caCommonName                   ContosoCA
effect                         Audit



[2026-01-22 15:09:13Z] 
[INFO] 
Preparing to assign (22/46): Certificates should have the specified maximum validity period
[2026-01-22 15:09:13Z] 
[INFO] 
Assigning policy 'Certificates should have the specified maximum validity period' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:13Z] 
[SUCCESS] 
Found 'Certificates should have the specified maximum validity period' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/0a075868-4c26-42ef-914c-5bc007359560
[2026-01-22 15:09:13Z] 
[INFO] 
DEBUG: Checking parameter 'maximumValidityInMonths' against policy definition
[2026-01-22 15:09:13Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInMonths, effect
[2026-01-22 15:09:13Z] 
[INFO] 
DEBUG: Added parameter 'maximumValidityInMonths' = '36' to cleaned params
[2026-01-22 15:09:13Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:13Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInMonths, effect
[2026-01-22 15:09:13Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:13Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesshouldhavethespecifiedmaximumvalidityperio-407807336 and params: 
Name                           Value
----                           -----
maximumValidityInMonths        36
effect                         Audit



[2026-01-22 15:09:13Z] 
[INFO] 
Preparing to assign (23/46): Keys should have more than the specified number of days before expiration
[2026-01-22 15:09:13Z] 
[INFO] 
Assigning policy 'Keys should have more than the specified number of days before expiration' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:13Z] 
[SUCCESS] 
Found 'Keys should have more than the specified number of days before expiration' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/5ff38825-c5d8-47c5-b70e-069a21955146
[2026-01-22 15:09:13Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:13Z] 
[INFO] 
DEBUG: Defined parameter names: minimumDaysBeforeExpiration, effect
[2026-01-22 15:09:13Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:13Z] 
[INFO] 
DEBUG: Checking parameter 'minimumDaysBeforeExpiration' against policy definition
[2026-01-22 15:09:13Z] 
[INFO] 
DEBUG: Defined parameter names: minimumDaysBeforeExpiration, effect
[2026-01-22 15:09:13Z] 
[INFO] 
DEBUG: Added parameter 'minimumDaysBeforeExpiration' = '30' to cleaned params
[2026-01-22 15:09:13Z] 
[INFO] 
Dry-run: would create assignment with name Keysshouldhavemorethanthespecifiednumberofdaysbeforeexp-12464927 and params: 
Name                           Value
----                           -----
minimumDaysBeforeExpiration    30
effect                         Audit



[2026-01-22 15:09:13Z] 
[INFO] 
Preparing to assign (24/46): Resource logs in Azure Key Vault Managed HSM should be enabled
[2026-01-22 15:09:13Z] 
[INFO] 
Assigning policy 'Resource logs in Azure Key Vault Managed HSM should be enabled' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:13Z] 
[SUCCESS] 
Found 'Resource logs in Azure Key Vault Managed HSM should be enabled' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/a2a5b911-5617-447e-a49e-59dbe0e0434b
[2026-01-22 15:09:14Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:14Z] 
[INFO] 
DEBUG: Defined parameter names: effect, requiredRetentionDays
[2026-01-22 15:09:14Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'AuditIfNotExists' to cleaned params
[2026-01-22 15:09:14Z] 
[INFO] 
Dry-run: would create assignment with name ResourcelogsinAzureKeyVaultManagedHSMshouldbeenabled-1874150632 and params: 
Name                           Value
----                           -----
effect                         AuditIfNotExists



[2026-01-22 15:09:14Z] 
[INFO] 
Preparing to assign (25/46): Key Vault secrets should have an expiration date
[2026-01-22 15:09:14Z] 
[INFO] 
Assigning policy 'Key Vault secrets should have an expiration date' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:14Z] 
[SUCCESS] 
Found 'Key Vault secrets should have an expiration date' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/98728c90-32c7-4049-8429-847dc0f4fe37
[2026-01-22 15:09:14Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:14Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:09:14Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:14Z] 
[INFO] 
Dry-run: would create assignment with name KeyVaultsecretsshouldhaveanexpirationdate-1232117220 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:09:14Z] 
[INFO] 
Preparing to assign (26/46): Keys should have a rotation policy ensuring that their rotation is scheduled within the specified number of days after creation.
[2026-01-22 15:09:14Z] 
[INFO] 
Assigning policy 'Keys should have a rotation policy ensuring that their rotation is scheduled within the specified number of days after creation.' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:14Z] 
[SUCCESS] 
Found 'Keys should have a rotation policy ensuring that their rotation is scheduled within the specified number of days after creation.' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/d8cf8476-a2ec-4916-896e-992351803c44
[2026-01-22 15:09:14Z] 
[INFO] 
DEBUG: Checking parameter 'maximumDaysToRotate' against policy definition
[2026-01-22 15:09:14Z] 
[INFO] 
DEBUG: Defined parameter names: maximumDaysToRotate, effect
[2026-01-22 15:09:14Z] 
[INFO] 
DEBUG: Added parameter 'maximumDaysToRotate' = '365' to cleaned params
[2026-01-22 15:09:14Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:14Z] 
[INFO] 
DEBUG: Defined parameter names: maximumDaysToRotate, effect
[2026-01-22 15:09:14Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:14Z] 
[INFO] 
Dry-run: would create assignment with name Keysshouldhavearotationpolicyensuringthattheirrotatio-1816322754 and params: 
Name                           Value
----                           -----
maximumDaysToRotate            365
effect                         Audit



[2026-01-22 15:09:14Z] 
[INFO] 
Preparing to assign (27/46): Certificates should not expire within the specified number of days
[2026-01-22 15:09:14Z] 
[INFO] 
Assigning policy 'Certificates should not expire within the specified number of days' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:14Z] 
[SUCCESS] 
Found 'Certificates should not expire within the specified number of days' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/f772fb64-8e40-40ad-87bc-7706e1949427
[2026-01-22 15:09:15Z] 
[INFO] 
DEBUG: Checking parameter 'daysToExpire' against policy definition
[2026-01-22 15:09:15Z] 
[INFO] 
DEBUG: Defined parameter names: daysToExpire, effect
[2026-01-22 15:09:15Z] 
[INFO] 
DEBUG: Added parameter 'daysToExpire' = '30' to cleaned params
[2026-01-22 15:09:15Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:15Z] 
[INFO] 
DEBUG: Defined parameter names: daysToExpire, effect
[2026-01-22 15:09:15Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:15Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesshouldnotexpirewithinthespecifiednumberof-2114192775 and params: 
Name                           Value
----                           -----
daysToExpire                   30
effect                         Audit



[2026-01-22 15:09:15Z] 
[INFO] 
Preparing to assign (28/46): Key vaults should have deletion protection enabled
[2026-01-22 15:09:15Z] 
[INFO] 
Assigning policy 'Key vaults should have deletion protection enabled' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:15Z] 
[SUCCESS] 
Found 'Key vaults should have deletion protection enabled' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/0b60c0b2-2dc2-4e1c-b5c9-abbed971de53
[2026-01-22 15:09:15Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:15Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:09:15Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:15Z] 
[INFO] 
Dry-run: would create assignment with name Keyvaultsshouldhavedeletionprotectionenabled-1439856846 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:09:15Z] 
[INFO] 
Preparing to assign (29/46): [Preview]: Azure Key Vault Managed HSM should disable public network access
[2026-01-22 15:09:15Z] 
[INFO] 
Assigning policy '[Preview]: Azure Key Vault Managed HSM should disable public network access' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:15Z] 
[SUCCESS] 
Found '[Preview]: Azure Key Vault Managed HSM should disable public network access' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/19ea9d63-adee-4431-a95e-1913c6c1c75f
[2026-01-22 15:09:15Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:15Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:09:15Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:15Z] 
[INFO] 
Dry-run: would create assignment with name PreviewAzureKeyVaultManagedHSMshoulddisablepublicnetwo-208646097 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:09:15Z] 
[INFO] 
Preparing to assign (30/46): Azure Key Vaults should use private link
[2026-01-22 15:09:15Z] 
[INFO] 
Assigning policy 'Azure Key Vaults should use private link' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:15Z] 
[SUCCESS] 
Found 'Azure Key Vaults should use private link' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/a6abeaec-4d90-4a02-805f-6b26c4d3fbe9
[2026-01-22 15:09:16Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:16Z] 
[INFO] 
DEBUG: Defined parameter names: audit_effect, effect
[2026-01-22 15:09:16Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:16Z] 
[INFO] 
Dry-run: would create assignment with name AzureKeyVaultsshoulduseprivatelink-2127082189 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:09:16Z] 
[INFO] 
Preparing to assign (31/46): Keys should be backed by a hardware security module (HSM)
[2026-01-22 15:09:16Z] 
[INFO] 
Assigning policy 'Keys should be backed by a hardware security module (HSM)' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:16Z] 
[SUCCESS] 
Found 'Keys should be backed by a hardware security module (HSM)' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/587c79fe-dd04-4a5e-9d0b-f89598c7261b
[2026-01-22 15:09:16Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:16Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:09:16Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:16Z] 
[INFO] 
Dry-run: would create assignment with name KeysshouldbebackedbyahardwaresecuritymoduleHSM-593124860 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:09:16Z] 
[INFO] 
Preparing to assign (32/46): Azure Key Vault should have firewall enabled or public network access disabled
[2026-01-22 15:09:16Z] 
[INFO] 
Assigning policy 'Azure Key Vault should have firewall enabled or public network access disabled' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:16Z] 
[SUCCESS] 
Found 'Azure Key Vault should have firewall enabled or public network access disabled' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/55615ac9-af46-4a59-874e-391cc3dfb490
[2026-01-22 15:09:16Z] 
[INFO] 
DEBUG: Checking parameter 'allowedIPAddresses' against policy definition
[2026-01-22 15:09:16Z] 
[INFO] 
DEBUG: Defined parameter names: effect, restrictIPAddresses, allowedIPAddresses, forbiddenIPAddresses
[2026-01-22 15:09:16Z] 
[INFO] 
DEBUG: Added parameter 'allowedIPAddresses' = '' to cleaned params
[2026-01-22 15:09:16Z] 
[INFO] 
DEBUG: Checking parameter 'forbiddenIPAddresses' against policy definition
[2026-01-22 15:09:16Z] 
[INFO] 
DEBUG: Defined parameter names: effect, restrictIPAddresses, allowedIPAddresses, forbiddenIPAddresses
[2026-01-22 15:09:16Z] 
[INFO] 
DEBUG: Added parameter 'forbiddenIPAddresses' = '' to cleaned params
[2026-01-22 15:09:16Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:16Z] 
[INFO] 
DEBUG: Defined parameter names: effect, restrictIPAddresses, allowedIPAddresses, forbiddenIPAddresses
[2026-01-22 15:09:16Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:17Z] 
[INFO] 
Dry-run: would create assignment with name AzureKeyVaultshouldhavefirewallenabledorpublicnetwork-1396884516 and params: 
Name                           Value
----                           -----
allowedIPAddresses             {}
forbiddenIPAddresses           {}
effect                         Audit



[2026-01-22 15:09:17Z] 
[INFO] 
Preparing to assign (33/46): Keys should have the specified maximum validity period
[2026-01-22 15:09:17Z] 
[INFO] 
Assigning policy 'Keys should have the specified maximum validity period' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:17Z] 
[SUCCESS] 
Found 'Keys should have the specified maximum validity period' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/49a22571-d204-4c91-a7b6-09b1a586fbc9
[2026-01-22 15:09:17Z] 
[INFO] 
DEBUG: Checking parameter 'maximumValidityInDays' against policy definition
[2026-01-22 15:09:17Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:09:17Z] 
[INFO] 
DEBUG: Added parameter 'maximumValidityInDays' = '1095' to cleaned params
[2026-01-22 15:09:17Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:17Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:09:17Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:17Z] 
[INFO] 
Dry-run: would create assignment with name Keysshouldhavethespecifiedmaximumvalidityperiod-906231923 and params: 
Name                           Value
----                           -----
maximumValidityInDays          1095
effect                         Audit



[2026-01-22 15:09:17Z] 
[INFO] 
Preparing to assign (34/46): Secrets should have content type set
[2026-01-22 15:09:17Z] 
[INFO] 
Assigning policy 'Secrets should have content type set' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:17Z] 
[SUCCESS] 
Found 'Secrets should have content type set' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/75262d3e-ba4a-4f43-85f8-9f72c090e5e3
[2026-01-22 15:09:17Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:17Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:09:17Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:17Z] 
[INFO] 
Dry-run: would create assignment with name Secretsshouldhavecontenttypeset-1186338756 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:09:17Z] 
[INFO] 
Preparing to assign (35/46): Azure Key Vault should disable public network access
[2026-01-22 15:09:17Z] 
[INFO] 
Assigning policy 'Azure Key Vault should disable public network access' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:17Z] 
[SUCCESS] 
Found 'Azure Key Vault should disable public network access' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/405c5871-3e91-4644-8a63-58e19d68ff5b
[2026-01-22 15:09:17Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:17Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:09:17Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:17Z] 
[INFO] 
Dry-run: would create assignment with name AzureKeyVaultshoulddisablepublicnetworkaccess-906277113 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:09:17Z] 
[INFO] 
Preparing to assign (36/46): [Preview]: Azure Key Vault Managed HSM Keys should have more than the specified number of days before expiration
[2026-01-22 15:09:17Z] 
[INFO] 
Assigning policy '[Preview]: Azure Key Vault Managed HSM Keys should have more than the specified number of days before expiration' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:17Z] 
[SUCCESS] 
Found '[Preview]: Azure Key Vault Managed HSM Keys should have more than the specified number of days before expiration' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/ad27588c-0198-4c84-81ef-08efd0274653
[2026-01-22 15:09:18Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:18Z] 
[INFO] 
DEBUG: Defined parameter names: effect, minimumDaysBeforeExpiration
[2026-01-22 15:09:18Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:18Z] 
[INFO] 
DEBUG: Checking parameter 'minimumDaysBeforeExpiration' against policy definition
[2026-01-22 15:09:18Z] 
[INFO] 
DEBUG: Defined parameter names: effect, minimumDaysBeforeExpiration
[2026-01-22 15:09:18Z] 
[INFO] 
DEBUG: Added parameter 'minimumDaysBeforeExpiration' = '30' to cleaned params
[2026-01-22 15:09:18Z] 
[INFO] 
Dry-run: would create assignment with name PreviewAzureKeyVaultManagedHSMKeysshouldhavemorethant-1035226701 and params: 
Name                           Value
----                           -----
minimumDaysBeforeExpiration    30
effect                         Audit



[2026-01-22 15:09:18Z] 
[INFO] 
Preparing to assign (37/46): Certificates should be issued by one of the specified non-integrated certificate authorities
[2026-01-22 15:09:18Z] 
[INFO] 
Assigning policy 'Certificates should be issued by one of the specified non-integrated certificate authorities' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:18Z] 
[SUCCESS] 
Found 'Certificates should be issued by one of the specified non-integrated certificate authorities' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/d3e82b87-6673-410b-8501-1896b688b9a3
[2026-01-22 15:09:18Z] 
[INFO] 
DEBUG: Checking parameter 'caCommonNames' against policy definition
[2026-01-22 15:09:18Z] 
[INFO] 
DEBUG: Defined parameter names: caCommonNames, effect
[2026-01-22 15:09:18Z] 
[INFO] 
DEBUG: Added parameter 'caCommonNames' = 'ContosoCA FabrikamCA' to cleaned params
[2026-01-22 15:09:18Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:18Z] 
[INFO] 
DEBUG: Defined parameter names: caCommonNames, effect
[2026-01-22 15:09:18Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:18Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesshouldbeissuedbyoneofthespecifiednonintegr-165973907 and params: 
Name                           Value
----                           -----
caCommonNames                  {ContosoCA, FabrikamCA}
effect                         Audit



[2026-01-22 15:09:18Z] 
[INFO] 
Preparing to assign (38/46): Keys should not be active for longer than the specified number of days
[2026-01-22 15:09:18Z] 
[INFO] 
Assigning policy 'Keys should not be active for longer than the specified number of days' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:18Z] 
[SUCCESS] 
Found 'Keys should not be active for longer than the specified number of days' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/c26e4b24-cf98-4c67-b48b-5a25c4c69eb9
[2026-01-22 15:09:18Z] 
[INFO] 
DEBUG: Checking parameter 'maximumValidityInDays' against policy definition
[2026-01-22 15:09:18Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:09:18Z] 
[INFO] 
DEBUG: Added parameter 'maximumValidityInDays' = '1095' to cleaned params
[2026-01-22 15:09:18Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:18Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:09:18Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:18Z] 
[INFO] 
Dry-run: would create assignment with name Keysshouldnotbeactiveforlongerthanthespecifiednumbero-1296256806 and params: 
Name                           Value
----                           -----
maximumValidityInDays          1095
effect                         Audit



[2026-01-22 15:09:18Z] 
[INFO] 
Preparing to assign (39/46): Certificates using RSA cryptography should have the specified minimum key size
[2026-01-22 15:09:18Z] 
[INFO] 
Assigning policy 'Certificates using RSA cryptography should have the specified minimum key size' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:18Z] 
[SUCCESS] 
Found 'Certificates using RSA cryptography should have the specified minimum key size' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/cee51871-e572-4576-855c-047c820360f0
[2026-01-22 15:09:19Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:19Z] 
[INFO] 
DEBUG: Defined parameter names: minimumRSAKeySize, effect
[2026-01-22 15:09:19Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:19Z] 
[INFO] 
DEBUG: Checking parameter 'minimumRSAKeySize' against policy definition
[2026-01-22 15:09:19Z] 
[INFO] 
DEBUG: Defined parameter names: minimumRSAKeySize, effect
[2026-01-22 15:09:19Z] 
[INFO] 
DEBUG: Added parameter 'minimumRSAKeySize' = '2048' to cleaned params
[2026-01-22 15:09:19Z] 
[INFO] 
Dry-run: would create assignment with name CertificatesusingRSAcryptographyshouldhavethespecifie-2031578458 and params: 
Name                           Value
----                           -----
minimumRSAKeySize              2048
effect                         Audit



[2026-01-22 15:09:19Z] 
[INFO] 
Preparing to assign (40/46): Secrets should have the specified maximum validity period
[2026-01-22 15:09:19Z] 
[INFO] 
Assigning policy 'Secrets should have the specified maximum validity period' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:19Z] 
[SUCCESS] 
Found 'Secrets should have the specified maximum validity period' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/342e8053-e12e-4c44-be01-c3c2f318400f
[2026-01-22 15:09:19Z] 
[INFO] 
DEBUG: Checking parameter 'maximumValidityInDays' against policy definition
[2026-01-22 15:09:19Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:09:19Z] 
[INFO] 
DEBUG: Added parameter 'maximumValidityInDays' = '1095' to cleaned params
[2026-01-22 15:09:19Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:19Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:09:19Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:19Z] 
[INFO] 
Dry-run: would create assignment with name Secretsshouldhavethespecifiedmaximumvalidityperiod-1663466362 and params: 
Name                           Value
----                           -----
maximumValidityInDays          1095
effect                         Audit



[2026-01-22 15:09:19Z] 
[INFO] 
Preparing to assign (41/46): Deploy - Configure diagnostic settings to an Event Hub to be enabled on Azure Key Vault Managed HSM
[2026-01-22 15:09:19Z] 
[INFO] 
Assigning policy 'Deploy - Configure diagnostic settings to an Event Hub to be enabled on Azure Key Vault Managed HSM' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:19Z] 
[SUCCESS] 
Found 'Deploy - Configure diagnostic settings to an Event Hub to be enabled on Azure Key Vault Managed HSM' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/a6d2c800-5230-4a40-bff3-8268b4987d42
[2026-01-22 15:09:20Z] 
[INFO] 
DEBUG: Checking parameter 'eventHubLocation' against policy definition
[2026-01-22 15:09:20Z] 
[INFO] 
DEBUG: Defined parameter names: effect, profileName, eventHubRuleId, eventHubLocation, metricsEnabled, logsEnabled
[2026-01-22 15:09:20Z] 
[INFO] 
DEBUG: Added parameter 'eventHubLocation' = 'eastus' to cleaned params
[2026-01-22 15:09:20Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:20Z] 
[INFO] 
DEBUG: Defined parameter names: effect, profileName, eventHubRuleId, eventHubLocation, metricsEnabled, logsEnabled
[2026-01-22 15:09:20Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'DeployIfNotExists' to cleaned params
[2026-01-22 15:09:20Z] 
[INFO] 
DEBUG: Checking parameter 'eventHubRuleId' against policy definition
[2026-01-22 15:09:20Z] 
[INFO] 
DEBUG: Defined parameter names: effect, profileName, eventHubRuleId, eventHubLocation, metricsEnabled, logsEnabled
[2026-01-22 15:09:20Z] 
[INFO] 
DEBUG: Added parameter 'eventHubRuleId' = '' to cleaned params
[2026-01-22 15:09:20Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '' (Length: 0)
[2026-01-22 15:09:20Z] 
[WARN] 
Effect '' requires managed identity. Skipping assignment - provide -IdentityResourceId to enable.

[2026-01-22 15:09:20Z] 
[INFO] 
Preparing to assign (42/46): [Preview]: Azure Key Vault Managed HSM keys using elliptic curve cryptography should have the specified curve names
[2026-01-22 15:09:20Z] 
[INFO] 
Assigning policy '[Preview]: Azure Key Vault Managed HSM keys using elliptic curve cryptography should have the specified curve names' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:20Z] 
[SUCCESS] 
Found '[Preview]: Azure Key Vault Managed HSM keys using elliptic curve cryptography should have the specified curve names' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/e58fd0c1-feac-4d12-92db-0a7e9421f53e
[2026-01-22 15:09:20Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:20Z] 
[INFO] 
DEBUG: Defined parameter names: allowedECNames, effect
[2026-01-22 15:09:20Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:20Z] 
[INFO] 
DEBUG: Checking parameter 'allowedECNames' against policy definition
[2026-01-22 15:09:20Z] 
[INFO] 
DEBUG: Defined parameter names: allowedECNames, effect
[2026-01-22 15:09:20Z] 
[INFO] 
DEBUG: Added parameter 'allowedECNames' = 'P-256 P-256K P-384 P-521' to cleaned params
[2026-01-22 15:09:20Z] 
[INFO] 
Dry-run: would create assignment with name PreviewAzureKeyVaultManagedHSMkeysusingellipticcurvecr-518169623 and params: 
Name                           Value
----                           -----
allowedECNames                 {P-256, P-256K, P-384, P-521}
effect                         Audit



[2026-01-22 15:09:20Z] 
[INFO] 
Preparing to assign (43/46): Azure Key Vault Managed HSM should have purge protection enabled
[2026-01-22 15:09:20Z] 
[INFO] 
Assigning policy 'Azure Key Vault Managed HSM should have purge protection enabled' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:20Z] 
[SUCCESS] 
Found 'Azure Key Vault Managed HSM should have purge protection enabled' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/c39ba22d-4428-4149-b981-70acb31fc383
[2026-01-22 15:09:20Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:20Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:09:20Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:20Z] 
[INFO] 
Dry-run: would create assignment with name AzureKeyVaultManagedHSMshouldhavepurgeprotectionenabl-1494992807 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:09:20Z] 
[INFO] 
Preparing to assign (44/46): [Preview]: Configure Azure Key Vault Managed HSM to disable public network access
[2026-01-22 15:09:20Z] 
[INFO] 
Assigning policy '[Preview]: Configure Azure Key Vault Managed HSM to disable public network access' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:20Z] 
[SUCCESS] 
Found '[Preview]: Configure Azure Key Vault Managed HSM to disable public network access' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/84d327c3-164a-4685-b453-900478614456
[2026-01-22 15:09:21Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:21Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:09:21Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Modify' to cleaned params
[2026-01-22 15:09:21Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '' (Length: 0)
[2026-01-22 15:09:21Z] 
[WARN] 
Effect '' requires managed identity. Skipping assignment - provide -IdentityResourceId to enable.

[2026-01-22 15:09:21Z] 
[INFO] 
Preparing to assign (45/46): [Preview]: Configure Azure Key Vault Managed HSM with private endpoints
[2026-01-22 15:09:21Z] 
[INFO] 
Assigning policy '[Preview]: Configure Azure Key Vault Managed HSM with private endpoints' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:21Z] 
[SUCCESS] 
Found '[Preview]: Configure Azure Key Vault Managed HSM with private endpoints' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/d1d6d8bb-cc7c-420f-8c7d-6f6f5279a844
[2026-01-22 15:09:21Z] 
[INFO] 
DEBUG: Checking parameter 'privateEndpointSubnetId' against policy definition
[2026-01-22 15:09:21Z] 
[INFO] 
DEBUG: Defined parameter names: privateEndpointSubnetId, effect
[2026-01-22 15:09:21Z] 
[INFO] 
DEBUG: Added parameter 'privateEndpointSubnetId' = '' to cleaned params
[2026-01-22 15:09:21Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:21Z] 
[INFO] 
DEBUG: Defined parameter names: privateEndpointSubnetId, effect
[2026-01-22 15:09:21Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'DeployIfNotExists' to cleaned params
[2026-01-22 15:09:21Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '' (Length: 0)
[2026-01-22 15:09:21Z] 
[WARN] 
Effect '' requires managed identity. Skipping assignment - provide -IdentityResourceId to enable.

[2026-01-22 15:09:21Z] 
[INFO] 
Preparing to assign (46/46): [Preview]: Azure Key Vault Managed HSM should use private link
[2026-01-22 15:09:21Z] 
[INFO] 
Assigning policy '[Preview]: Azure Key Vault Managed HSM should use private link' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:21Z] 
[SUCCESS] 
Found '[Preview]: Azure Key Vault Managed HSM should use private link' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/59fee2f4-d439-4f1b-9b9a-982e1474bfd8
[2026-01-22 15:09:21Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:21Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:09:21Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:21Z] 
[INFO] 
Dry-run: would create assignment with name PreviewAzureKeyVaultManagedHSMshoulduseprivatelink-504701151 and params: 
Name                           Value
----                           -----
effect                         Audit


[2026-01-22 15:09:21Z] 
[INFO] 
Collected 0 assignment IDs for filtering
[2026-01-22 15:09:21Z] 
[INFO] 
Wrote reports: KeyVaultPolicyImplementationReport-20260122-150921.md, KeyVaultPolicyImplementationReport-20260122-150921.json, KeyVaultPolicyImplementationReport-20260122-150921.csv
[2026-01-22 15:09:21Z] 
[SUCCESS] 
HTML report generated: ./PolicyImplementationReport-20260122-150921.html
Dry-run summary written to ./DryRunSummary.txt

[2026-01-22 15:09:21Z] 
[INFO] 
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-01-22 15:09:21Z] 
[INFO] 
                    ğŸ“‹ NEXT STEPS GUIDANCE
[2026-01-22 15:09:21Z] 
[INFO] 
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ¯ Dry-Run Validation Complete

âœ… What was validated:
  â†’ Policy definitions resolved from mapping file
  â†’ Parameter overrides validated against policy schemas
  â†’ Assignment names generated (64-char limit enforced)
  â†’ No actual Azure resources created or modified

ğŸ“‹ Recommended Next Steps:
  1. ğŸ“„ Review dry-run summary:
     
notepad ./DryRunSummary.txt
  2. âœ… Verify all policies resolved successfully (Status: DryRun)
  3. ğŸ” Check for policies requiring managed identity (DeployIfNotExists/Modify effects)
  4. ğŸ“Š Review parameter values match your requirements
  5. ğŸš€ Deploy to test environment when ready:
     
.\\AzPolicyImplScript.ps1 -ParameterFile <YOUR_PARAM_FILE> -SkipRBACCheck

âš ï¸  Common Issues to Check:
  â†’ Policies with Status='Skipped' require -IdentityResourceId parameter
  â†’ Verify parameter values don't exceed policy min/max constraints
  â†’ Check for typos in policy display names (lookup failures)

ğŸ“š Documentation:
  â†’ Parameter File Guide: PolicyParameters-QuickReference.md
  â†’ Deployment Workflow: DEPLOYMENT-WORKFLOW-GUIDE.md


ğŸ“‹ Dry-Run Summary: 
./DryRunSummary.txt


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-01-22 15:09:21Z] 
[SUCCESS] 
Completed run. Reports generated.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“„ Reports Generated:
  â€¢ HTML:     
./PolicyImplementationReport-20260122-150921.html
  â€¢ Markdown: 
KeyVaultPolicyImplementationReport-20260122-150921.md
  â€¢ JSON:     
KeyVaultPolicyImplementationReport-20260122-150921.json


[2026-01-22 15:09:21Z] 
[INFO] 
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-01-22 15:09:21Z] 
[INFO] 
                    ğŸ“‹ NEXT STEPS GUIDANCE
[2026-01-22 15:09:21Z] 
[INFO] 
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ¯ DevTest Full Deployment Complete (46 Policies - Audit Mode)

âœ… What was deployed:
  â†’ All 46 Azure Key Vault governance policies in Audit mode
  â†’ Comprehensive compliance monitoring (certificates, keys, secrets, vaults)
  â†’ Test environment: Safe to experiment without production impact

ğŸ“‹ Recommended Next Steps:
  1. â³ Wait 30-60 minutes for Azure Policy evaluation cycle
  2. ğŸ“Š Generate compliance report with remediation guidance:
     
.\\AzPolicyImplScript.ps1 -CheckCompliance -TriggerScan
  3. ğŸ§ª Test auto-remediation (8 DeployIfNotExists policies):
     
.\\AzPolicyImplScript.ps1 -TestAutoRemediation
     âš ï¸  Warning: Takes 30-60 minutes (Azure Policy evaluation lag)
  4. ğŸš€ Deploy to Production when validated:
     
.\\AzPolicyImplScript.ps1 -ParameterFile .\\PolicyParameters-Production.json

ğŸ“š Documentation:
  â†’ Pre-Deployment Checklist: PRE-DEPLOYMENT-CHECKLIST.md (700+ lines)
  â†’ Email Alerts Setup: EMAIL-ALERT-CONFIGURATION.md (900+ lines)

[2026-01-22 15:09:21] [SUCCESS]   âœ… Command executed successfully
[2026-01-22 15:09:21] [INFO]   Output saved to: .\scenario-2-output-20260122-150905.txt
[2026-01-22 15:09:21] [ERROR]   âŒ Console next steps validation failed for DevTest Full (46 Policies)
[2026-01-22 15:09:21] [ERROR]     - Missing 'NEXT STEPS GUIDANCE' banner
[2026-01-22 15:09:21] [ERROR]     - Missing DevTestFull46 deployment banner
[2026-01-22 15:09:21] [ERROR]     - Missing auto-remediation testing recommendation
[2026-01-22 15:09:21] [SUCCESS]   âœ… HTML report validated for DevTest Full (46 Policies)
[2026-01-22 15:09:21] [SUCCESS]   âœ… No unexpected warnings/errors for DevTest Full (46 Policies)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-01-22 15:09:23] [INFO] SCENARIO 3: DevTest Auto-Remediation (8 Policies)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-01-22 15:09:24] [WARN] âš ï¸  User input required for this scenario:
[2026-01-22 15:09:24] [WARN]     Replace <MANAGED_IDENTITY_ID> with:
[2026-01-22 15:09:24] [WARN]     /subscriptions/<subscription-id>/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation
[2026-01-22 15:09:24] [INFO]   Using managed identity: /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation
[2026-01-22 15:09:24] [INFO] Executing: .\AzPolicyImplScript.ps1 -ParameterFile .\PolicyParameters-DevTest-Full-Remediation.json -IdentityResourceId '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation' -SkipRBACCheck -Preview

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  Azure Policy Implementation - Key Vault Governance          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[2026-01-22 15:09:24Z] 
[INFO] 
Starting Azure Policy implementation script for Key Vault policies
[2026-01-22 15:09:24Z] 
[INFO] 
Checking required PowerShell modules...
[2026-01-22 15:09:24Z] 
[SUCCESS] 
Module Az.Accounts is present
[2026-01-22 15:09:24Z] 
[SUCCESS] 
Module Az.Resources is present
[2026-01-22 15:09:24Z] 
[SUCCESS] 
Module Az.PolicyInsights is present
[2026-01-22 15:09:24Z] 
[SUCCESS] 
Module Az.Monitor is present
[2026-01-22 15:09:24Z] 
[SUCCESS] 
Module Az.KeyVault is present
[2026-01-22 15:09:24Z] 
[INFO] 
Using Azure context: theregniers@hotmail.com
[2026-01-22 15:09:24Z] 
[INFO] 
Loading policy mapping from ./PolicyNameMapping.json
[2026-01-22 15:09:24Z] 
[INFO] 
Loaded 3745 policy mappings
[2026-01-22 15:09:24Z] 
[INFO] 
Loading policy parameter overrides from .\PolicyParameters-DevTest-Full-Remediation.json
[2026-01-22 15:09:24Z] 
[INFO] 
Detected deployment type: DevTestRemediation (from parameter file: PolicyParameters-DevTest-Full-Remediation.json)
[2026-01-22 15:09:24Z] 
[INFO] 
Preview mode enabled: setting DryRun and skipping RBAC checks.
[2026-01-22 15:09:24Z] 
[INFO] 
DEBUG: PSBoundParameters keys: CsvPath, ParameterOverridesPath, IdentityResourceId, Preview, SkipRBACCheck
[2026-01-22 15:09:24Z] 
[INFO] 
DEBUG: ScopeType value: ''
[2026-01-22 15:09:24Z] 
[INFO] 
Dry-run mode: using Subscription scope by default
[2026-01-22 15:09:24Z] 
[INFO] 
Checking current subscription context.
[2026-01-22 15:09:24Z] 
[INFO] 
Current subscription: MSDN Platforms Subscription (ab1336c7-687d-4107-b0f6-9649a0458adb)
[2026-01-22 15:09:24Z] 
[INFO] 
Dry-run mode: using current subscription context
[2026-01-22 15:09:24Z] 
[INFO] 
Preview mode: skipped RBAC permission check.
[2026-01-22 15:09:24Z] 
[INFO] 
Using policy effects from parameter file: .\PolicyParameters-DevTest-Full-Remediation.json
[2026-01-22 15:09:24Z] 
[SUCCESS] 
Loaded 46 policies from parameter file: .\PolicyParameters-DevTest-Full-Remediation.json

Processing 46 policies...
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

[2026-01-22 15:09:24Z] 
[INFO] 
Preparing to assign (1/46): Certificates using elliptic curve cryptography should have allowed curve names
[2026-01-22 15:09:24Z] 
[INFO] 
Assigning policy 'Certificates using elliptic curve cryptography should have allowed curve names' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:24Z] 
[SUCCESS] 
Found 'Certificates using elliptic curve cryptography should have allowed curve names' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/bd78111f-4953-4367-9fd5-7e08808b54bf
[2026-01-22 15:09:24Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:24Z] 
[INFO] 
DEBUG: Defined parameter names: allowedECNames, effect
[2026-01-22 15:09:24Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:24Z] 
[INFO] 
DEBUG: Checking parameter 'allowedECNames' against policy definition
[2026-01-22 15:09:24Z] 
[INFO] 
DEBUG: Defined parameter names: allowedECNames, effect
[2026-01-22 15:09:24Z] 
[INFO] 
DEBUG: Added parameter 'allowedECNames' = 'P-256 P-256K P-384 P-521' to cleaned params
[2026-01-22 15:09:24Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesusingellipticcurvecryptographyshouldhavea-1468057639 and params: 
Name                           Value
----                           -----
allowedECNames                 {P-256, P-256K, P-384, P-521}
effect                         Audit



[2026-01-22 15:09:24Z] 
[INFO] 
Preparing to assign (2/46): Configure key vaults to enable firewall
[2026-01-22 15:09:25Z] 
[INFO] 
Assigning policy 'Configure key vaults to enable firewall' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:25Z] 
[SUCCESS] 
Found 'Configure key vaults to enable firewall' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/ac673a9a-f77d-4846-b2d8-a57f8e1c01dc
[2026-01-22 15:09:25Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:25Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:09:25Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Modify' to cleaned params
[2026-01-22 15:09:25Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation' (Length: 169)
[2026-01-22 15:09:25Z] 
[INFO] 
Policy requires managed identity. Using: /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 28a0fe2d-1db4-4c3e-9a58-142d0f38e709. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 28a0fe2d-1db4-4c3e-9a58-142d0f38e709'.'
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 93298d06-3fff-4626-8e13-397bf9bd4c30. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 93298d06-3fff-4626-8e13-397bf9bd4c30'.'
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 218094f2-2976-4255-a15c-4008e6c8a18b. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 218094f2-2976-4255-a15c-4008e6c8a18b'.'
[2026-01-22 15:09:28Z] 
[INFO] 
Added user-assigned identity: /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation (using default location: eastus)
[2026-01-22 15:09:28Z] 
[INFO] 
Dry-run: would create assignment with name Configurekeyvaultstoenablefirewall-2078747040 and params: 
Name                           Value
----                           -----
effect                         Modify



[2026-01-22 15:09:28Z] 
[INFO] 
Preparing to assign (3/46): Azure Key Vault should use RBAC permission model
[2026-01-22 15:09:28Z] 
[INFO] 
Assigning policy 'Azure Key Vault should use RBAC permission model' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:28Z] 
[SUCCESS] 
Found 'Azure Key Vault should use RBAC permission model' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/12d4fa5e-1f9f-4c21-97a9-b99b3c6611b5
[2026-01-22 15:09:28Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:28Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:09:28Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:28Z] 
[INFO] 
Dry-run: would create assignment with name AzureKeyVaultshoulduseRBACpermissionmodel-307198231 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:09:28Z] 
[INFO] 
Preparing to assign (4/46): Keys should be the specified cryptographic type RSA or EC
[2026-01-22 15:09:28Z] 
[INFO] 
Assigning policy 'Keys should be the specified cryptographic type RSA or EC' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:28Z] 
[SUCCESS] 
Found 'Keys should be the specified cryptographic type RSA or EC' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/75c4f823-d65c-4f29-a733-01d0077fdbcb
[2026-01-22 15:09:28Z] 
[INFO] 
DEBUG: Checking parameter 'cryptographicType' against policy definition
[2026-01-22 15:09:28Z] 
[INFO] 
DEBUG: Defined parameter names: allowedKeyTypes, effect
[2026-01-22 15:09:28Z] 
[WARN] 
DEBUG: Parameter 'cryptographicType' NOT FOUND in policy definition - SKIPPED
[2026-01-22 15:09:28Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:28Z] 
[INFO] 
DEBUG: Defined parameter names: allowedKeyTypes, effect
[2026-01-22 15:09:28Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:28Z] 
[WARN] 
Parameter 'cryptographicType' not defined in policy. Skipping to avoid UndefinedPolicyParameter error.
[2026-01-22 15:09:28Z] 
[INFO] 
Dry-run: would create assignment with name KeysshouldbethespecifiedcryptographictypeRSAorEC-976981238 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:09:28Z] 
[INFO] 
Preparing to assign (5/46): Keys using elliptic curve cryptography should have the specified curve names
[2026-01-22 15:09:28Z] 
[INFO] 
Assigning policy 'Keys using elliptic curve cryptography should have the specified curve names' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:28Z] 
[SUCCESS] 
Found 'Keys using elliptic curve cryptography should have the specified curve names' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/ff25f3c8-b739-4538-9d07-3d6d25cfb255
[2026-01-22 15:09:29Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:29Z] 
[INFO] 
DEBUG: Defined parameter names: allowedECNames, effect
[2026-01-22 15:09:29Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:29Z] 
[INFO] 
DEBUG: Checking parameter 'allowedECNames' against policy definition
[2026-01-22 15:09:29Z] 
[INFO] 
DEBUG: Defined parameter names: allowedECNames, effect
[2026-01-22 15:09:29Z] 
[INFO] 
DEBUG: Added parameter 'allowedECNames' = 'P-256 P-256K P-384 P-521' to cleaned params
[2026-01-22 15:09:29Z] 
[INFO] 
Dry-run: would create assignment with name Keysusingellipticcurvecryptographyshouldhavethespecif-1437325202 and params: 
Name                           Value
----                           -----
allowedECNames                 {P-256, P-256K, P-384, P-521}
effect                         Audit



[2026-01-22 15:09:29Z] 
[INFO] 
Preparing to assign (6/46): Deploy Diagnostic Settings for Key Vault to Event Hub
[2026-01-22 15:09:29Z] 
[INFO] 
Assigning policy 'Deploy Diagnostic Settings for Key Vault to Event Hub' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:29Z] 
[SUCCESS] 
Found 'Deploy Diagnostic Settings for Key Vault to Event Hub' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/ed7c8c13-51e7-49d1-8a43-8490431a0da2
[2026-01-22 15:09:29Z] 
[INFO] 
DEBUG: Checking parameter 'eventHubLocation' against policy definition
[2026-01-22 15:09:29Z] 
[INFO] 
DEBUG: Defined parameter names: effect, profileName, eventHubRuleId, eventHubLocation, metricsEnabled, logsEnabled
[2026-01-22 15:09:29Z] 
[INFO] 
DEBUG: Added parameter 'eventHubLocation' = 'eastus' to cleaned params
[2026-01-22 15:09:29Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:29Z] 
[INFO] 
DEBUG: Defined parameter names: effect, profileName, eventHubRuleId, eventHubLocation, metricsEnabled, logsEnabled
[2026-01-22 15:09:29Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'DeployIfNotExists' to cleaned params
[2026-01-22 15:09:29Z] 
[INFO] 
DEBUG: Checking parameter 'eventHubRuleId' against policy definition
[2026-01-22 15:09:29Z] 
[INFO] 
DEBUG: Defined parameter names: effect, profileName, eventHubRuleId, eventHubLocation, metricsEnabled, logsEnabled
[2026-01-22 15:09:29Z] 
[INFO] 
DEBUG: Added parameter 'eventHubRuleId' = '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.EventHub/namespaces/eh-policy-test-3464/authorizationrules/RootManageSharedAccessKey' to cleaned params
[2026-01-22 15:09:29Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation' (Length: 169)
[2026-01-22 15:09:29Z] 
[INFO] 
Policy requires managed identity. Using: /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 28a0fe2d-1db4-4c3e-9a58-142d0f38e709. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 28a0fe2d-1db4-4c3e-9a58-142d0f38e709'.'
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 93298d06-3fff-4626-8e13-397bf9bd4c30. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 93298d06-3fff-4626-8e13-397bf9bd4c30'.'
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 218094f2-2976-4255-a15c-4008e6c8a18b. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 218094f2-2976-4255-a15c-4008e6c8a18b'.'
[2026-01-22 15:09:30Z] 
[INFO] 
Added user-assigned identity: /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation (using default location: eastus)
[2026-01-22 15:09:30Z] 
[INFO] 
Dry-run: would create assignment with name DeployDiagnosticSettingsforKeyVaulttoEventHub-215019929 and params: 
Name                           Value
----                           -----
eventHubLocation               eastus
effect                         DeployIfNotExists
eventHubRuleId                 /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.EventHub/namespaces/eh-â€¦



[2026-01-22 15:09:30Z] 
[INFO] 
Preparing to assign (7/46): Keys using RSA cryptography should have a specified minimum key size
[2026-01-22 15:09:30Z] 
[INFO] 
Assigning policy 'Keys using RSA cryptography should have a specified minimum key size' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:30Z] 
[SUCCESS] 
Found 'Keys using RSA cryptography should have a specified minimum key size' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/82067dbb-e53b-4e06-b631-546d197452d9
[2026-01-22 15:09:31Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:31Z] 
[INFO] 
DEBUG: Defined parameter names: minimumRSAKeySize, effect
[2026-01-22 15:09:31Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:31Z] 
[INFO] 
DEBUG: Checking parameter 'minimumRSAKeySize' against policy definition
[2026-01-22 15:09:31Z] 
[INFO] 
DEBUG: Defined parameter names: minimumRSAKeySize, effect
[2026-01-22 15:09:31Z] 
[INFO] 
DEBUG: Added parameter 'minimumRSAKeySize' = '2048' to cleaned params
[2026-01-22 15:09:31Z] 
[INFO] 
Dry-run: would create assignment with name KeysusingRSAcryptographyshouldhaveaspecifiedminimumkey-909744685 and params: 
Name                           Value
----                           -----
minimumRSAKeySize              2048
effect                         Audit



[2026-01-22 15:09:31Z] 
[INFO] 
Preparing to assign (8/46): Deploy - Configure diagnostic settings for Azure Key Vault to Log Analytics workspace
[2026-01-22 15:09:31Z] 
[INFO] 
Assigning policy 'Deploy - Configure diagnostic settings for Azure Key Vault to Log Analytics workspace' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:31Z] 
[SUCCESS] 
Found 'Deploy - Configure diagnostic settings for Azure Key Vault to Log Analytics workspace' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/951af2fa-529b-416e-ab6e-066fd85ac459
[2026-01-22 15:09:31Z] 
[INFO] 
DEBUG: Checking parameter 'logAnalytics' against policy definition
[2026-01-22 15:09:31Z] 
[INFO] 
DEBUG: Defined parameter names: effect, diagnosticsSettingNameToUse, logAnalytics, AuditEventEnabled, AllMetricsEnabled
[2026-01-22 15:09:31Z] 
[INFO] 
DEBUG: Added parameter 'logAnalytics' = '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.OperationalInsights/workspaces/law-policy-test-6874' to cleaned params
[2026-01-22 15:09:31Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:31Z] 
[INFO] 
DEBUG: Defined parameter names: effect, diagnosticsSettingNameToUse, logAnalytics, AuditEventEnabled, AllMetricsEnabled
[2026-01-22 15:09:31Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'DeployIfNotExists' to cleaned params
[2026-01-22 15:09:31Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation' (Length: 169)
[2026-01-22 15:09:31Z] 
[INFO] 
Policy requires managed identity. Using: /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 28a0fe2d-1db4-4c3e-9a58-142d0f38e709. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 28a0fe2d-1db4-4c3e-9a58-142d0f38e709'.'
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 93298d06-3fff-4626-8e13-397bf9bd4c30. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 93298d06-3fff-4626-8e13-397bf9bd4c30'.'
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 218094f2-2976-4255-a15c-4008e6c8a18b. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 218094f2-2976-4255-a15c-4008e6c8a18b'.'
[2026-01-22 15:09:32Z] 
[INFO] 
Added user-assigned identity: /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation (using default location: eastus)
[2026-01-22 15:09:32Z] 
[INFO] 
Dry-run: would create assignment with name DeployConfigurediagnosticsettingsforAzureKeyVaulttoLog-821297124 and params: 
Name                           Value
----                           -----
effect                         DeployIfNotExists
logAnalytics                   /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.OperationalInsights/worâ€¦



[2026-01-22 15:09:32Z] 
[INFO] 
Preparing to assign (9/46): [Preview]: Azure Key Vault Managed HSM keys using RSA cryptography should have a specified minimum key size
[2026-01-22 15:09:32Z] 
[INFO] 
Assigning policy '[Preview]: Azure Key Vault Managed HSM keys using RSA cryptography should have a specified minimum key size' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:32Z] 
[SUCCESS] 
Found '[Preview]: Azure Key Vault Managed HSM keys using RSA cryptography should have a specified minimum key size' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/86810a98-8e91-4a44-8386-ec66d0de5d57
[2026-01-22 15:09:32Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:32Z] 
[INFO] 
DEBUG: Defined parameter names: effect, minimumRSAKeySize
[2026-01-22 15:09:32Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:32Z] 
[INFO] 
DEBUG: Checking parameter 'minimumRSAKeySize' against policy definition
[2026-01-22 15:09:32Z] 
[INFO] 
DEBUG: Defined parameter names: effect, minimumRSAKeySize
[2026-01-22 15:09:32Z] 
[INFO] 
DEBUG: Added parameter 'minimumRSAKeySize' = '2048' to cleaned params
[2026-01-22 15:09:32Z] 
[INFO] 
Dry-run: would create assignment with name PreviewAzureKeyVaultManagedHSMkeysusingRSAcryptography-998252524 and params: 
Name                           Value
----                           -----
minimumRSAKeySize              2048
effect                         Audit



[2026-01-22 15:09:32Z] 
[INFO] 
Preparing to assign (10/46): Certificates should be issued by the specified integrated certificate authority
[2026-01-22 15:09:32Z] 
[INFO] 
Assigning policy 'Certificates should be issued by the specified integrated certificate authority' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:32Z] 
[SUCCESS] 
Found 'Certificates should be issued by the specified integrated certificate authority' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/8e826246-c976-48f6-b03e-619bb92b3d82
[2026-01-22 15:09:33Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:33Z] 
[INFO] 
DEBUG: Defined parameter names: allowedCAs, effect
[2026-01-22 15:09:33Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:33Z] 
[INFO] 
DEBUG: Checking parameter 'allowedCAs' against policy definition
[2026-01-22 15:09:33Z] 
[INFO] 
DEBUG: Defined parameter names: allowedCAs, effect
[2026-01-22 15:09:33Z] 
[INFO] 
DEBUG: Added parameter 'allowedCAs' = 'DigiCert GlobalSign' to cleaned params
[2026-01-22 15:09:33Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesshouldbeissuedbythespecifiedintegratedcer-1190107367 and params: 
Name                           Value
----                           -----
allowedCAs                     {DigiCert, GlobalSign}
effect                         Audit



[2026-01-22 15:09:33Z] 
[INFO] 
Preparing to assign (11/46): Secrets should have more than the specified number of days before expiration
[2026-01-22 15:09:33Z] 
[INFO] 
Assigning policy 'Secrets should have more than the specified number of days before expiration' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:33Z] 
[SUCCESS] 
Found 'Secrets should have more than the specified number of days before expiration' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/b0eb591a-5e70-4534-a8bf-04b9c489584a
[2026-01-22 15:09:33Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:33Z] 
[INFO] 
DEBUG: Defined parameter names: minimumDaysBeforeExpiration, effect
[2026-01-22 15:09:33Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:33Z] 
[INFO] 
DEBUG: Checking parameter 'minimumDaysBeforeExpiration' against policy definition
[2026-01-22 15:09:33Z] 
[INFO] 
DEBUG: Defined parameter names: minimumDaysBeforeExpiration, effect
[2026-01-22 15:09:33Z] 
[INFO] 
DEBUG: Added parameter 'minimumDaysBeforeExpiration' = '30' to cleaned params
[2026-01-22 15:09:33Z] 
[INFO] 
Dry-run: would create assignment with name Secretsshouldhavemorethanthespecifiednumberofdaysbefo-1193127515 and params: 
Name                           Value
----                           -----
minimumDaysBeforeExpiration    30
effect                         Audit



[2026-01-22 15:09:33Z] 
[INFO] 
Preparing to assign (12/46): Configure Azure Key Vaults to use private DNS zones
[2026-01-22 15:09:33Z] 
[INFO] 
Assigning policy 'Configure Azure Key Vaults to use private DNS zones' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:33Z] 
[SUCCESS] 
Found 'Configure Azure Key Vaults to use private DNS zones' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/ac673a9a-f77d-4846-b2d8-a57f8e1c01d4
[2026-01-22 15:09:34Z] 
[INFO] 
DEBUG: Checking parameter 'privateDnsZoneId' against policy definition
[2026-01-22 15:09:34Z] 
[INFO] 
DEBUG: Defined parameter names: privateDnsZoneId, effect
[2026-01-22 15:09:34Z] 
[INFO] 
DEBUG: Added parameter 'privateDnsZoneId' = '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.Network/privateDnsZones/privatelink.vaultcore.azure.net' to cleaned params
[2026-01-22 15:09:34Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:34Z] 
[INFO] 
DEBUG: Defined parameter names: privateDnsZoneId, effect
[2026-01-22 15:09:34Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'DeployIfNotExists' to cleaned params
[2026-01-22 15:09:34Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation' (Length: 169)
[2026-01-22 15:09:34Z] 
[INFO] 
Policy requires managed identity. Using: /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 28a0fe2d-1db4-4c3e-9a58-142d0f38e709. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 28a0fe2d-1db4-4c3e-9a58-142d0f38e709'.'
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 93298d06-3fff-4626-8e13-397bf9bd4c30. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 93298d06-3fff-4626-8e13-397bf9bd4c30'.'
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 218094f2-2976-4255-a15c-4008e6c8a18b. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 218094f2-2976-4255-a15c-4008e6c8a18b'.'
[2026-01-22 15:09:34Z] 
[INFO] 
Added user-assigned identity: /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation (using default location: eastus)
[2026-01-22 15:09:34Z] 
[INFO] 
Dry-run: would create assignment with name ConfigureAzureKeyVaultstouseprivateDNSzones-1754477011 and params: 
Name                           Value
----                           -----
effect                         DeployIfNotExists
privateDnsZoneId               /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.Network/privateDnsZonesâ€¦



[2026-01-22 15:09:34Z] 
[INFO] 
Preparing to assign (13/46): [Preview]: Azure Key Vault Managed HSM keys should have an expiration date
[2026-01-22 15:09:34Z] 
[INFO] 
Assigning policy '[Preview]: Azure Key Vault Managed HSM keys should have an expiration date' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:34Z] 
[SUCCESS] 
Found '[Preview]: Azure Key Vault Managed HSM keys should have an expiration date' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/1d478a74-21ba-4b9f-9d8f-8e6fced0eec5
[2026-01-22 15:09:34Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:34Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:09:34Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:34Z] 
[INFO] 
Dry-run: would create assignment with name PreviewAzureKeyVaultManagedHSMkeysshouldhaveanexpirati-976371970 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:09:34Z] 
[INFO] 
Preparing to assign (14/46): Configure Azure Key Vaults with private endpoints
[2026-01-22 15:09:34Z] 
[INFO] 
Assigning policy 'Configure Azure Key Vaults with private endpoints' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:34Z] 
[SUCCESS] 
Found 'Configure Azure Key Vaults with private endpoints' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/9d4fad1f-5189-4a42-b29e-cf7929c6b6df
[2026-01-22 15:09:35Z] 
[INFO] 
DEBUG: Checking parameter 'privateEndpointSubnetId' against policy definition
[2026-01-22 15:09:35Z] 
[INFO] 
DEBUG: Defined parameter names: privateEndpointSubnetId, effect
[2026-01-22 15:09:35Z] 
[INFO] 
DEBUG: Added parameter 'privateEndpointSubnetId' = '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-keyvault-test/providers/Microsoft.Network/virtualNetworks/vnet-policy-test/subnets/subnet-keyvault' to cleaned params
[2026-01-22 15:09:35Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:35Z] 
[INFO] 
DEBUG: Defined parameter names: privateEndpointSubnetId, effect
[2026-01-22 15:09:35Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'DeployIfNotExists' to cleaned params
[2026-01-22 15:09:35Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation' (Length: 169)
[2026-01-22 15:09:35Z] 
[INFO] 
Policy requires managed identity. Using: /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 28a0fe2d-1db4-4c3e-9a58-142d0f38e709. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 28a0fe2d-1db4-4c3e-9a58-142d0f38e709'.'
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 93298d06-3fff-4626-8e13-397bf9bd4c30. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 93298d06-3fff-4626-8e13-397bf9bd4c30'.'
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 218094f2-2976-4255-a15c-4008e6c8a18b. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 218094f2-2976-4255-a15c-4008e6c8a18b'.'
[2026-01-22 15:09:35Z] 
[INFO] 
Added user-assigned identity: /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation (using default location: eastus)
[2026-01-22 15:09:35Z] 
[INFO] 
Dry-run: would create assignment with name ConfigureAzureKeyVaultswithprivateendpoints-1664094028 and params: 
Name                           Value
----                           -----
effect                         DeployIfNotExists
privateEndpointSubnetId        /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-keyvault-test/providers/Microsoft.Network/virtualNetworâ€¦



[2026-01-22 15:09:35Z] 
[INFO] 
Preparing to assign (15/46): Key vaults should have soft delete enabled
[2026-01-22 15:09:35Z] 
[INFO] 
Assigning policy 'Key vaults should have soft delete enabled' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:36Z] 
[SUCCESS] 
Found 'Key vaults should have soft delete enabled' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/1e66c121-a66a-4b1f-9b83-0fd99bf0fc2d
[2026-01-22 15:09:36Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:36Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:09:36Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:36Z] 
[INFO] 
Dry-run: would create assignment with name Keyvaultsshouldhavesoftdeleteenabled-656701378 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:09:36Z] 
[INFO] 
Preparing to assign (16/46): Certificates should use allowed key types
[2026-01-22 15:09:36Z] 
[INFO] 
Assigning policy 'Certificates should use allowed key types' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:36Z] 
[SUCCESS] 
Found 'Certificates should use allowed key types' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/1151cede-290b-4ba0-8b38-0ad145ac888f
[2026-01-22 15:09:36Z] 
[INFO] 
DEBUG: Checking parameter 'allowedKeyTypes' against policy definition
[2026-01-22 15:09:36Z] 
[INFO] 
DEBUG: Defined parameter names: allowedKeyTypes, effect
[2026-01-22 15:09:36Z] 
[INFO] 
DEBUG: Added parameter 'allowedKeyTypes' = 'RSA EC' to cleaned params
[2026-01-22 15:09:36Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:36Z] 
[INFO] 
DEBUG: Defined parameter names: allowedKeyTypes, effect
[2026-01-22 15:09:36Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:36Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesshoulduseallowedkeytypes-246707145 and params: 
Name                           Value
----                           -----
allowedKeyTypes                {RSA, EC}
effect                         Audit



[2026-01-22 15:09:36Z] 
[INFO] 
Preparing to assign (17/46): Resource logs in Key Vault should be enabled
[2026-01-22 15:09:36Z] 
[INFO] 
Assigning policy 'Resource logs in Key Vault should be enabled' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:36Z] 
[SUCCESS] 
Found 'Resource logs in Key Vault should be enabled' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21
[2026-01-22 15:09:36Z] 
[INFO] 
DEBUG: Checking parameter 'requiredRetentionDays' against policy definition
[2026-01-22 15:09:36Z] 
[INFO] 
DEBUG: Defined parameter names: effect, requiredRetentionDays
[2026-01-22 15:09:36Z] 
[INFO] 
DEBUG: Added parameter 'requiredRetentionDays' = '90' to cleaned params
[2026-01-22 15:09:36Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:36Z] 
[INFO] 
DEBUG: Defined parameter names: effect, requiredRetentionDays
[2026-01-22 15:09:36Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'AuditIfNotExists' to cleaned params
[2026-01-22 15:09:36Z] 
[INFO] 
Dry-run: would create assignment with name ResourcelogsinKeyVaultshouldbeenabled-1683835535 and params: 
Name                           Value
----                           -----
requiredRetentionDays          90
effect                         AuditIfNotExists



[2026-01-22 15:09:36Z] 
[INFO] 
Preparing to assign (18/46): Certificates should have the specified lifetime action triggers
[2026-01-22 15:09:36Z] 
[INFO] 
Assigning policy 'Certificates should have the specified lifetime action triggers' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:36Z] 
[SUCCESS] 
Found 'Certificates should have the specified lifetime action triggers' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/12ef42cb-9903-4e39-9c26-422d29570417
[2026-01-22 15:09:37Z] 
[INFO] 
DEBUG: Checking parameter 'maximumPercentageLife' against policy definition
[2026-01-22 15:09:37Z] 
[INFO] 
DEBUG: Defined parameter names: maximumPercentageLife, minimumDaysBeforeExpiry, effect
[2026-01-22 15:09:37Z] 
[INFO] 
DEBUG: Added parameter 'maximumPercentageLife' = '80' to cleaned params
[2026-01-22 15:09:37Z] 
[INFO] 
DEBUG: Checking parameter 'minimumDaysBeforeExpiry' against policy definition
[2026-01-22 15:09:37Z] 
[INFO] 
DEBUG: Defined parameter names: maximumPercentageLife, minimumDaysBeforeExpiry, effect
[2026-01-22 15:09:37Z] 
[INFO] 
DEBUG: Added parameter 'minimumDaysBeforeExpiry' = '30' to cleaned params
[2026-01-22 15:09:37Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:37Z] 
[INFO] 
DEBUG: Defined parameter names: maximumPercentageLife, minimumDaysBeforeExpiry, effect
[2026-01-22 15:09:37Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:37Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesshouldhavethespecifiedlifetimeactiontrigg-1761965968 and params: 
Name                           Value
----                           -----
maximumPercentageLife          80
minimumDaysBeforeExpiry        30
effect                         Audit



[2026-01-22 15:09:37Z] 
[INFO] 
Preparing to assign (19/46): Secrets should not be active for longer than the specified number of days
[2026-01-22 15:09:37Z] 
[INFO] 
Assigning policy 'Secrets should not be active for longer than the specified number of days' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:37Z] 
[SUCCESS] 
Found 'Secrets should not be active for longer than the specified number of days' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/e8d99835-8a06-45ae-a8e0-87a91941ccfe
[2026-01-22 15:09:37Z] 
[INFO] 
DEBUG: Checking parameter 'maximumValidityInDays' against policy definition
[2026-01-22 15:09:37Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:09:37Z] 
[INFO] 
DEBUG: Added parameter 'maximumValidityInDays' = '1095' to cleaned params
[2026-01-22 15:09:37Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:37Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:09:37Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:37Z] 
[INFO] 
Dry-run: would create assignment with name Secretsshouldnotbeactiveforlongerthanthespecifiednumb-1452013840 and params: 
Name                           Value
----                           -----
maximumValidityInDays          1095
effect                         Audit



[2026-01-22 15:09:37Z] 
[INFO] 
Preparing to assign (20/46): Certificates should be issued by the specified non-integrated certificate authority
[2026-01-22 15:09:37Z] 
[INFO] 
Assigning policy 'Certificates should be issued by the specified non-integrated certificate authority' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:37Z] 
[SUCCESS] 
Found 'Certificates should be issued by the specified non-integrated certificate authority' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/a22f4a40-01d3-4c7d-8071-da157eeff341
[2026-01-22 15:09:38Z] 
[INFO] 
DEBUG: Checking parameter 'caCommonName' against policy definition
[2026-01-22 15:09:38Z] 
[INFO] 
DEBUG: Defined parameter names: caCommonName, effect
[2026-01-22 15:09:38Z] 
[INFO] 
DEBUG: Added parameter 'caCommonName' = 'ContosoCA' to cleaned params
[2026-01-22 15:09:38Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:38Z] 
[INFO] 
DEBUG: Defined parameter names: caCommonName, effect
[2026-01-22 15:09:38Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:38Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesshouldbeissuedbythespecifiednonintegratedc-500792775 and params: 
Name                           Value
----                           -----
caCommonName                   ContosoCA
effect                         Audit



[2026-01-22 15:09:38Z] 
[INFO] 
Preparing to assign (21/46): Certificates should have the specified maximum validity period
[2026-01-22 15:09:38Z] 
[INFO] 
Assigning policy 'Certificates should have the specified maximum validity period' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:38Z] 
[SUCCESS] 
Found 'Certificates should have the specified maximum validity period' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/0a075868-4c26-42ef-914c-5bc007359560
[2026-01-22 15:09:38Z] 
[INFO] 
DEBUG: Checking parameter 'maximumValidityInMonths' against policy definition
[2026-01-22 15:09:38Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInMonths, effect
[2026-01-22 15:09:38Z] 
[INFO] 
DEBUG: Added parameter 'maximumValidityInMonths' = '36' to cleaned params
[2026-01-22 15:09:38Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:38Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInMonths, effect
[2026-01-22 15:09:38Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:38Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesshouldhavethespecifiedmaximumvalidityperio-407807336 and params: 
Name                           Value
----                           -----
maximumValidityInMonths        36
effect                         Audit



[2026-01-22 15:09:38Z] 
[INFO] 
Preparing to assign (22/46): Keys should have more than the specified number of days before expiration
[2026-01-22 15:09:38Z] 
[INFO] 
Assigning policy 'Keys should have more than the specified number of days before expiration' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:38Z] 
[SUCCESS] 
Found 'Keys should have more than the specified number of days before expiration' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/5ff38825-c5d8-47c5-b70e-069a21955146
[2026-01-22 15:09:39Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:39Z] 
[INFO] 
DEBUG: Defined parameter names: minimumDaysBeforeExpiration, effect
[2026-01-22 15:09:39Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:39Z] 
[INFO] 
DEBUG: Checking parameter 'minimumDaysBeforeExpiration' against policy definition
[2026-01-22 15:09:39Z] 
[INFO] 
DEBUG: Defined parameter names: minimumDaysBeforeExpiration, effect
[2026-01-22 15:09:39Z] 
[INFO] 
DEBUG: Added parameter 'minimumDaysBeforeExpiration' = '30' to cleaned params
[2026-01-22 15:09:39Z] 
[INFO] 
Dry-run: would create assignment with name Keysshouldhavemorethanthespecifiednumberofdaysbeforeexp-12464927 and params: 
Name                           Value
----                           -----
minimumDaysBeforeExpiration    30
effect                         Audit



[2026-01-22 15:09:39Z] 
[INFO] 
Preparing to assign (23/46): Resource logs in Azure Key Vault Managed HSM should be enabled
[2026-01-22 15:09:39Z] 
[INFO] 
Assigning policy 'Resource logs in Azure Key Vault Managed HSM should be enabled' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:39Z] 
[SUCCESS] 
Found 'Resource logs in Azure Key Vault Managed HSM should be enabled' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/a2a5b911-5617-447e-a49e-59dbe0e0434b
[2026-01-22 15:09:39Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:39Z] 
[INFO] 
DEBUG: Defined parameter names: effect, requiredRetentionDays
[2026-01-22 15:09:39Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'AuditIfNotExists' to cleaned params
[2026-01-22 15:09:39Z] 
[INFO] 
Dry-run: would create assignment with name ResourcelogsinAzureKeyVaultManagedHSMshouldbeenabled-1874150632 and params: 
Name                           Value
----                           -----
effect                         AuditIfNotExists



[2026-01-22 15:09:39Z] 
[INFO] 
Preparing to assign (24/46): Key Vault keys should have an expiration date
[2026-01-22 15:09:39Z] 
[INFO] 
Assigning policy 'Key Vault keys should have an expiration date' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:39Z] 
[SUCCESS] 
Found 'Key Vault keys should have an expiration date' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/152b15f7-8e1f-4c1f-ab71-8c010ba5dbc0
[2026-01-22 15:09:39Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:39Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:09:39Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:39Z] 
[INFO] 
Dry-run: would create assignment with name KeyVaultkeysshouldhaveanexpirationdate-386037801 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:09:39Z] 
[INFO] 
Preparing to assign (25/46): Keys should have a rotation policy ensuring that their rotation is scheduled within the specified number of days after creation.
[2026-01-22 15:09:39Z] 
[INFO] 
Assigning policy 'Keys should have a rotation policy ensuring that their rotation is scheduled within the specified number of days after creation.' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:39Z] 
[SUCCESS] 
Found 'Keys should have a rotation policy ensuring that their rotation is scheduled within the specified number of days after creation.' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/d8cf8476-a2ec-4916-896e-992351803c44
[2026-01-22 15:09:40Z] 
[INFO] 
DEBUG: Checking parameter 'maximumDaysToRotate' against policy definition
[2026-01-22 15:09:40Z] 
[INFO] 
DEBUG: Defined parameter names: maximumDaysToRotate, effect
[2026-01-22 15:09:40Z] 
[INFO] 
DEBUG: Added parameter 'maximumDaysToRotate' = '365' to cleaned params
[2026-01-22 15:09:40Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:40Z] 
[INFO] 
DEBUG: Defined parameter names: maximumDaysToRotate, effect
[2026-01-22 15:09:40Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:40Z] 
[INFO] 
Dry-run: would create assignment with name Keysshouldhavearotationpolicyensuringthattheirrotatio-1816322754 and params: 
Name                           Value
----                           -----
maximumDaysToRotate            365
effect                         Audit



[2026-01-22 15:09:40Z] 
[INFO] 
Preparing to assign (26/46): Certificates should not expire within the specified number of days
[2026-01-22 15:09:40Z] 
[INFO] 
Assigning policy 'Certificates should not expire within the specified number of days' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:40Z] 
[SUCCESS] 
Found 'Certificates should not expire within the specified number of days' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/f772fb64-8e40-40ad-87bc-7706e1949427
[2026-01-22 15:09:40Z] 
[INFO] 
DEBUG: Checking parameter 'daysToExpire' against policy definition
[2026-01-22 15:09:40Z] 
[INFO] 
DEBUG: Defined parameter names: daysToExpire, effect
[2026-01-22 15:09:40Z] 
[INFO] 
DEBUG: Added parameter 'daysToExpire' = '30' to cleaned params
[2026-01-22 15:09:40Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:40Z] 
[INFO] 
DEBUG: Defined parameter names: daysToExpire, effect
[2026-01-22 15:09:40Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:40Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesshouldnotexpirewithinthespecifiednumberof-2114192775 and params: 
Name                           Value
----                           -----
daysToExpire                   30
effect                         Audit



[2026-01-22 15:09:40Z] 
[INFO] 
Preparing to assign (27/46): Key vaults should have deletion protection enabled
[2026-01-22 15:09:40Z] 
[INFO] 
Assigning policy 'Key vaults should have deletion protection enabled' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:40Z] 
[SUCCESS] 
Found 'Key vaults should have deletion protection enabled' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/0b60c0b2-2dc2-4e1c-b5c9-abbed971de53
[2026-01-22 15:09:40Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:40Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:09:40Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:40Z] 
[INFO] 
Dry-run: would create assignment with name Keyvaultsshouldhavedeletionprotectionenabled-1439856846 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:09:40Z] 
[INFO] 
Preparing to assign (28/46): [Preview]: Azure Key Vault Managed HSM should disable public network access
[2026-01-22 15:09:40Z] 
[INFO] 
Assigning policy '[Preview]: Azure Key Vault Managed HSM should disable public network access' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:40Z] 
[SUCCESS] 
Found '[Preview]: Azure Key Vault Managed HSM should disable public network access' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/19ea9d63-adee-4431-a95e-1913c6c1c75f
[2026-01-22 15:09:41Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:41Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:09:41Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:41Z] 
[INFO] 
Dry-run: would create assignment with name PreviewAzureKeyVaultManagedHSMshoulddisablepublicnetwo-208646097 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:09:41Z] 
[INFO] 
Preparing to assign (29/46): Azure Key Vaults should use private link
[2026-01-22 15:09:41Z] 
[INFO] 
Assigning policy 'Azure Key Vaults should use private link' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:41Z] 
[SUCCESS] 
Found 'Azure Key Vaults should use private link' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/a6abeaec-4d90-4a02-805f-6b26c4d3fbe9
[2026-01-22 15:09:41Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:41Z] 
[INFO] 
DEBUG: Defined parameter names: audit_effect, effect
[2026-01-22 15:09:41Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:41Z] 
[INFO] 
Dry-run: would create assignment with name AzureKeyVaultsshoulduseprivatelink-2127082189 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:09:41Z] 
[INFO] 
Preparing to assign (30/46): Keys should be backed by a hardware security module (HSM)
[2026-01-22 15:09:41Z] 
[INFO] 
Assigning policy 'Keys should be backed by a hardware security module (HSM)' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:41Z] 
[SUCCESS] 
Found 'Keys should be backed by a hardware security module (HSM)' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/587c79fe-dd04-4a5e-9d0b-f89598c7261b
[2026-01-22 15:09:41Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:41Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:09:41Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:41Z] 
[INFO] 
Dry-run: would create assignment with name KeysshouldbebackedbyahardwaresecuritymoduleHSM-593124860 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:09:41Z] 
[INFO] 
Preparing to assign (31/46): Azure Key Vault should have firewall enabled or public network access disabled
[2026-01-22 15:09:41Z] 
[INFO] 
Assigning policy 'Azure Key Vault should have firewall enabled or public network access disabled' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:41Z] 
[SUCCESS] 
Found 'Azure Key Vault should have firewall enabled or public network access disabled' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/55615ac9-af46-4a59-874e-391cc3dfb490
[2026-01-22 15:09:42Z] 
[INFO] 
DEBUG: Checking parameter 'allowedIPAddresses' against policy definition
[2026-01-22 15:09:42Z] 
[INFO] 
DEBUG: Defined parameter names: effect, restrictIPAddresses, allowedIPAddresses, forbiddenIPAddresses
[2026-01-22 15:09:42Z] 
[INFO] 
DEBUG: Added parameter 'allowedIPAddresses' = '' to cleaned params
[2026-01-22 15:09:42Z] 
[INFO] 
DEBUG: Checking parameter 'forbiddenIPAddresses' against policy definition
[2026-01-22 15:09:42Z] 
[INFO] 
DEBUG: Defined parameter names: effect, restrictIPAddresses, allowedIPAddresses, forbiddenIPAddresses
[2026-01-22 15:09:42Z] 
[INFO] 
DEBUG: Added parameter 'forbiddenIPAddresses' = '' to cleaned params
[2026-01-22 15:09:42Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:42Z] 
[INFO] 
DEBUG: Defined parameter names: effect, restrictIPAddresses, allowedIPAddresses, forbiddenIPAddresses
[2026-01-22 15:09:42Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:42Z] 
[INFO] 
Dry-run: would create assignment with name AzureKeyVaultshouldhavefirewallenabledorpublicnetwork-1396884516 and params: 
Name                           Value
----                           -----
allowedIPAddresses             {}
forbiddenIPAddresses           {}
effect                         Audit



[2026-01-22 15:09:42Z] 
[INFO] 
Preparing to assign (32/46): Keys should have the specified maximum validity period
[2026-01-22 15:09:42Z] 
[INFO] 
Assigning policy 'Keys should have the specified maximum validity period' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:42Z] 
[SUCCESS] 
Found 'Keys should have the specified maximum validity period' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/49a22571-d204-4c91-a7b6-09b1a586fbc9
[2026-01-22 15:09:42Z] 
[INFO] 
DEBUG: Checking parameter 'maximumValidityInDays' against policy definition
[2026-01-22 15:09:42Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:09:42Z] 
[INFO] 
DEBUG: Added parameter 'maximumValidityInDays' = '1095' to cleaned params
[2026-01-22 15:09:42Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:42Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:09:42Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:42Z] 
[INFO] 
Dry-run: would create assignment with name Keysshouldhavethespecifiedmaximumvalidityperiod-906231923 and params: 
Name                           Value
----                           -----
maximumValidityInDays          1095
effect                         Audit



[2026-01-22 15:09:42Z] 
[INFO] 
Preparing to assign (33/46): Secrets should have content type set
[2026-01-22 15:09:42Z] 
[INFO] 
Assigning policy 'Secrets should have content type set' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:42Z] 
[SUCCESS] 
Found 'Secrets should have content type set' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/75262d3e-ba4a-4f43-85f8-9f72c090e5e3
[2026-01-22 15:09:42Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:42Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:09:42Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:42Z] 
[INFO] 
Dry-run: would create assignment with name Secretsshouldhavecontenttypeset-1186338756 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:09:42Z] 
[INFO] 
Preparing to assign (34/46): Azure Key Vault should disable public network access
[2026-01-22 15:09:42Z] 
[INFO] 
Assigning policy 'Azure Key Vault should disable public network access' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:42Z] 
[SUCCESS] 
Found 'Azure Key Vault should disable public network access' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/405c5871-3e91-4644-8a63-58e19d68ff5b
[2026-01-22 15:09:43Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:43Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:09:43Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:43Z] 
[INFO] 
Dry-run: would create assignment with name AzureKeyVaultshoulddisablepublicnetworkaccess-906277113 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:09:43Z] 
[INFO] 
Preparing to assign (35/46): [Preview]: Azure Key Vault Managed HSM Keys should have more than the specified number of days before expiration
[2026-01-22 15:09:43Z] 
[INFO] 
Assigning policy '[Preview]: Azure Key Vault Managed HSM Keys should have more than the specified number of days before expiration' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:43Z] 
[SUCCESS] 
Found '[Preview]: Azure Key Vault Managed HSM Keys should have more than the specified number of days before expiration' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/ad27588c-0198-4c84-81ef-08efd0274653
[2026-01-22 15:09:43Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:43Z] 
[INFO] 
DEBUG: Defined parameter names: effect, minimumDaysBeforeExpiration
[2026-01-22 15:09:43Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:43Z] 
[INFO] 
DEBUG: Checking parameter 'minimumDaysBeforeExpiration' against policy definition
[2026-01-22 15:09:43Z] 
[INFO] 
DEBUG: Defined parameter names: effect, minimumDaysBeforeExpiration
[2026-01-22 15:09:43Z] 
[INFO] 
DEBUG: Added parameter 'minimumDaysBeforeExpiration' = '30' to cleaned params
[2026-01-22 15:09:43Z] 
[INFO] 
Dry-run: would create assignment with name PreviewAzureKeyVaultManagedHSMKeysshouldhavemorethant-1035226701 and params: 
Name                           Value
----                           -----
minimumDaysBeforeExpiration    30
effect                         Audit



[2026-01-22 15:09:43Z] 
[INFO] 
Preparing to assign (36/46): Certificates should be issued by one of the specified non-integrated certificate authorities
[2026-01-22 15:09:43Z] 
[INFO] 
Assigning policy 'Certificates should be issued by one of the specified non-integrated certificate authorities' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:43Z] 
[SUCCESS] 
Found 'Certificates should be issued by one of the specified non-integrated certificate authorities' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/d3e82b87-6673-410b-8501-1896b688b9a3
[2026-01-22 15:09:44Z] 
[INFO] 
DEBUG: Checking parameter 'caCommonNames' against policy definition
[2026-01-22 15:09:44Z] 
[INFO] 
DEBUG: Defined parameter names: caCommonNames, effect
[2026-01-22 15:09:44Z] 
[INFO] 
DEBUG: Added parameter 'caCommonNames' = 'ContosoCA FabrikamCA' to cleaned params
[2026-01-22 15:09:44Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:44Z] 
[INFO] 
DEBUG: Defined parameter names: caCommonNames, effect
[2026-01-22 15:09:44Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:44Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesshouldbeissuedbyoneofthespecifiednonintegr-165973907 and params: 
Name                           Value
----                           -----
caCommonNames                  {ContosoCA, FabrikamCA}
effect                         Audit



[2026-01-22 15:09:44Z] 
[INFO] 
Preparing to assign (37/46): [Preview]: Configure Azure Key Vault Managed HSM to disable public network access
[2026-01-22 15:09:44Z] 
[INFO] 
Assigning policy '[Preview]: Configure Azure Key Vault Managed HSM to disable public network access' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:44Z] 
[SUCCESS] 
Found '[Preview]: Configure Azure Key Vault Managed HSM to disable public network access' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/84d327c3-164a-4685-b453-900478614456
[2026-01-22 15:09:44Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:44Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:09:44Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Modify' to cleaned params
[2026-01-22 15:09:44Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation' (Length: 169)
[2026-01-22 15:09:44Z] 
[INFO] 
Policy requires managed identity. Using: /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 28a0fe2d-1db4-4c3e-9a58-142d0f38e709. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 28a0fe2d-1db4-4c3e-9a58-142d0f38e709'.'
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 93298d06-3fff-4626-8e13-397bf9bd4c30. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 93298d06-3fff-4626-8e13-397bf9bd4c30'.'
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 218094f2-2976-4255-a15c-4008e6c8a18b. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 218094f2-2976-4255-a15c-4008e6c8a18b'.'
[2026-01-22 15:09:45Z] 
[INFO] 
Added user-assigned identity: /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation (using default location: eastus)
[2026-01-22 15:09:45Z] 
[INFO] 
Dry-run: would create assignment with name PreviewConfigureAzureKeyVaultManagedHSMtodisablepublic-937554689 and params: 
Name                           Value
----                           -----
effect                         Modify



[2026-01-22 15:09:45Z] 
[INFO] 
Preparing to assign (38/46): Keys should not be active for longer than the specified number of days
[2026-01-22 15:09:45Z] 
[INFO] 
Assigning policy 'Keys should not be active for longer than the specified number of days' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:45Z] 
[SUCCESS] 
Found 'Keys should not be active for longer than the specified number of days' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/c26e4b24-cf98-4c67-b48b-5a25c4c69eb9
[2026-01-22 15:09:45Z] 
[INFO] 
DEBUG: Checking parameter 'maximumValidityInDays' against policy definition
[2026-01-22 15:09:45Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:09:45Z] 
[INFO] 
DEBUG: Added parameter 'maximumValidityInDays' = '1095' to cleaned params
[2026-01-22 15:09:45Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:45Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:09:45Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:45Z] 
[INFO] 
Dry-run: would create assignment with name Keysshouldnotbeactiveforlongerthanthespecifiednumbero-1296256806 and params: 
Name                           Value
----                           -----
maximumValidityInDays          1095
effect                         Audit



[2026-01-22 15:09:45Z] 
[INFO] 
Preparing to assign (39/46): Certificates using RSA cryptography should have the specified minimum key size
[2026-01-22 15:09:45Z] 
[INFO] 
Assigning policy 'Certificates using RSA cryptography should have the specified minimum key size' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:45Z] 
[SUCCESS] 
Found 'Certificates using RSA cryptography should have the specified minimum key size' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/cee51871-e572-4576-855c-047c820360f0
[2026-01-22 15:09:45Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:45Z] 
[INFO] 
DEBUG: Defined parameter names: minimumRSAKeySize, effect
[2026-01-22 15:09:45Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:45Z] 
[INFO] 
DEBUG: Checking parameter 'minimumRSAKeySize' against policy definition
[2026-01-22 15:09:45Z] 
[INFO] 
DEBUG: Defined parameter names: minimumRSAKeySize, effect
[2026-01-22 15:09:45Z] 
[INFO] 
DEBUG: Added parameter 'minimumRSAKeySize' = '2048' to cleaned params
[2026-01-22 15:09:45Z] 
[INFO] 
Dry-run: would create assignment with name CertificatesusingRSAcryptographyshouldhavethespecifie-2031578458 and params: 
Name                           Value
----                           -----
minimumRSAKeySize              2048
effect                         Audit



[2026-01-22 15:09:45Z] 
[INFO] 
Preparing to assign (40/46): Secrets should have the specified maximum validity period
[2026-01-22 15:09:45Z] 
[INFO] 
Assigning policy 'Secrets should have the specified maximum validity period' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:45Z] 
[SUCCESS] 
Found 'Secrets should have the specified maximum validity period' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/342e8053-e12e-4c44-be01-c3c2f318400f
[2026-01-22 15:09:46Z] 
[INFO] 
DEBUG: Checking parameter 'maximumValidityInDays' against policy definition
[2026-01-22 15:09:46Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:09:46Z] 
[INFO] 
DEBUG: Added parameter 'maximumValidityInDays' = '1095' to cleaned params
[2026-01-22 15:09:46Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:46Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:09:46Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:46Z] 
[INFO] 
Dry-run: would create assignment with name Secretsshouldhavethespecifiedmaximumvalidityperiod-1663466362 and params: 
Name                           Value
----                           -----
maximumValidityInDays          1095
effect                         Audit



[2026-01-22 15:09:46Z] 
[INFO] 
Preparing to assign (41/46): Deploy - Configure diagnostic settings to an Event Hub to be enabled on Azure Key Vault Managed HSM
[2026-01-22 15:09:46Z] 
[INFO] 
Assigning policy 'Deploy - Configure diagnostic settings to an Event Hub to be enabled on Azure Key Vault Managed HSM' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:46Z] 
[SUCCESS] 
Found 'Deploy - Configure diagnostic settings to an Event Hub to be enabled on Azure Key Vault Managed HSM' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/a6d2c800-5230-4a40-bff3-8268b4987d42
[2026-01-22 15:09:46Z] 
[INFO] 
DEBUG: Checking parameter 'eventHubLocation' against policy definition
[2026-01-22 15:09:46Z] 
[INFO] 
DEBUG: Defined parameter names: effect, profileName, eventHubRuleId, eventHubLocation, metricsEnabled, logsEnabled
[2026-01-22 15:09:46Z] 
[INFO] 
DEBUG: Added parameter 'eventHubLocation' = 'eastus' to cleaned params
[2026-01-22 15:09:46Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:46Z] 
[INFO] 
DEBUG: Defined parameter names: effect, profileName, eventHubRuleId, eventHubLocation, metricsEnabled, logsEnabled
[2026-01-22 15:09:46Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'DeployIfNotExists' to cleaned params
[2026-01-22 15:09:46Z] 
[INFO] 
DEBUG: Checking parameter 'eventHubRuleId' against policy definition
[2026-01-22 15:09:46Z] 
[INFO] 
DEBUG: Defined parameter names: effect, profileName, eventHubRuleId, eventHubLocation, metricsEnabled, logsEnabled
[2026-01-22 15:09:46Z] 
[INFO] 
DEBUG: Added parameter 'eventHubRuleId' = '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.EventHub/namespaces/eh-policy-test-3464/authorizationrules/RootManageSharedAccessKey' to cleaned params
[2026-01-22 15:09:46Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation' (Length: 169)
[2026-01-22 15:09:46Z] 
[INFO] 
Policy requires managed identity. Using: /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 28a0fe2d-1db4-4c3e-9a58-142d0f38e709. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 28a0fe2d-1db4-4c3e-9a58-142d0f38e709'.'
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 93298d06-3fff-4626-8e13-397bf9bd4c30. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 93298d06-3fff-4626-8e13-397bf9bd4c30'.'
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 218094f2-2976-4255-a15c-4008e6c8a18b. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 218094f2-2976-4255-a15c-4008e6c8a18b'.'
[2026-01-22 15:09:47Z] 
[INFO] 
Added user-assigned identity: /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation (using default location: eastus)
[2026-01-22 15:09:47Z] 
[INFO] 
Dry-run: would create assignment with name DeployConfigurediagnosticsettingstoanEventHubtobeenabl-909645055 and params: 
Name                           Value
----                           -----
eventHubLocation               eastus
effect                         DeployIfNotExists
eventHubRuleId                 /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.EventHub/namespaces/eh-â€¦



[2026-01-22 15:09:47Z] 
[INFO] 
Preparing to assign (42/46): [Preview]: Azure Key Vault Managed HSM keys using elliptic curve cryptography should have the specified curve names
[2026-01-22 15:09:47Z] 
[INFO] 
Assigning policy '[Preview]: Azure Key Vault Managed HSM keys using elliptic curve cryptography should have the specified curve names' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:47Z] 
[SUCCESS] 
Found '[Preview]: Azure Key Vault Managed HSM keys using elliptic curve cryptography should have the specified curve names' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/e58fd0c1-feac-4d12-92db-0a7e9421f53e
[2026-01-22 15:09:47Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:47Z] 
[INFO] 
DEBUG: Defined parameter names: allowedECNames, effect
[2026-01-22 15:09:47Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:47Z] 
[INFO] 
DEBUG: Checking parameter 'allowedECNames' against policy definition
[2026-01-22 15:09:47Z] 
[INFO] 
DEBUG: Defined parameter names: allowedECNames, effect
[2026-01-22 15:09:47Z] 
[INFO] 
DEBUG: Added parameter 'allowedECNames' = 'P-256 P-256K P-384 P-521' to cleaned params
[2026-01-22 15:09:47Z] 
[INFO] 
Dry-run: would create assignment with name PreviewAzureKeyVaultManagedHSMkeysusingellipticcurvecr-518169623 and params: 
Name                           Value
----                           -----
allowedECNames                 {P-256, P-256K, P-384, P-521}
effect                         Audit



[2026-01-22 15:09:47Z] 
[INFO] 
Preparing to assign (43/46): Azure Key Vault Managed HSM should have purge protection enabled
[2026-01-22 15:09:47Z] 
[INFO] 
Assigning policy 'Azure Key Vault Managed HSM should have purge protection enabled' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:47Z] 
[SUCCESS] 
Found 'Azure Key Vault Managed HSM should have purge protection enabled' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/c39ba22d-4428-4149-b981-70acb31fc383
[2026-01-22 15:09:48Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:48Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:09:48Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:48Z] 
[INFO] 
Dry-run: would create assignment with name AzureKeyVaultManagedHSMshouldhavepurgeprotectionenabl-1494992807 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:09:48Z] 
[INFO] 
Preparing to assign (44/46): Key Vault secrets should have an expiration date
[2026-01-22 15:09:48Z] 
[INFO] 
Assigning policy 'Key Vault secrets should have an expiration date' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:48Z] 
[SUCCESS] 
Found 'Key Vault secrets should have an expiration date' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/98728c90-32c7-4049-8429-847dc0f4fe37
[2026-01-22 15:09:48Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:48Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:09:48Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:48Z] 
[INFO] 
Dry-run: would create assignment with name KeyVaultsecretsshouldhaveanexpirationdate-1232117220 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:09:48Z] 
[INFO] 
Preparing to assign (45/46): [Preview]: Configure Azure Key Vault Managed HSM with private endpoints
[2026-01-22 15:09:48Z] 
[INFO] 
Assigning policy '[Preview]: Configure Azure Key Vault Managed HSM with private endpoints' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:48Z] 
[SUCCESS] 
Found '[Preview]: Configure Azure Key Vault Managed HSM with private endpoints' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/d1d6d8bb-cc7c-420f-8c7d-6f6f5279a844
[2026-01-22 15:09:48Z] 
[INFO] 
DEBUG: Checking parameter 'privateEndpointSubnetId' against policy definition
[2026-01-22 15:09:48Z] 
[INFO] 
DEBUG: Defined parameter names: privateEndpointSubnetId, effect
[2026-01-22 15:09:48Z] 
[INFO] 
DEBUG: Added parameter 'privateEndpointSubnetId' = '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-keyvault-test/providers/Microsoft.Network/virtualNetworks/vnet-policy-test/subnets/subnet-keyvault' to cleaned params
[2026-01-22 15:09:48Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:48Z] 
[INFO] 
DEBUG: Defined parameter names: privateEndpointSubnetId, effect
[2026-01-22 15:09:48Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'DeployIfNotExists' to cleaned params
[2026-01-22 15:09:48Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation' (Length: 169)
[2026-01-22 15:09:48Z] 
[INFO] 
Policy requires managed identity. Using: /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 28a0fe2d-1db4-4c3e-9a58-142d0f38e709. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 28a0fe2d-1db4-4c3e-9a58-142d0f38e709'.'
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 93298d06-3fff-4626-8e13-397bf9bd4c30. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 93298d06-3fff-4626-8e13-397bf9bd4c30'.'
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 218094f2-2976-4255-a15c-4008e6c8a18b. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 218094f2-2976-4255-a15c-4008e6c8a18b'.'
[2026-01-22 15:09:49Z] 
[INFO] 
Added user-assigned identity: /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation (using default location: eastus)
[2026-01-22 15:09:49Z] 
[INFO] 
Dry-run: would create assignment with name PreviewConfigureAzureKeyVaultManagedHSMwithprivateendp-732076577 and params: 
Name                           Value
----                           -----
effect                         DeployIfNotExists
privateEndpointSubnetId        /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-keyvault-test/providers/Microsoft.Network/virtualNetworâ€¦



[2026-01-22 15:09:49Z] 
[INFO] 
Preparing to assign (46/46): [Preview]: Azure Key Vault Managed HSM should use private link
[2026-01-22 15:09:49Z] 
[INFO] 
Assigning policy '[Preview]: Azure Key Vault Managed HSM should use private link' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:49Z] 
[SUCCESS] 
Found '[Preview]: Azure Key Vault Managed HSM should use private link' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/59fee2f4-d439-4f1b-9b9a-982e1474bfd8
[2026-01-22 15:09:50Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:50Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:09:50Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:50Z] 
[INFO] 
Dry-run: would create assignment with name PreviewAzureKeyVaultManagedHSMshoulduseprivatelink-504701151 and params: 
Name                           Value
----                           -----
effect                         Audit


[2026-01-22 15:09:50Z] 
[INFO] 
Collected 0 assignment IDs for filtering
[2026-01-22 15:09:50Z] 
[INFO] 
Wrote reports: KeyVaultPolicyImplementationReport-20260122-150950.md, KeyVaultPolicyImplementationReport-20260122-150950.json, KeyVaultPolicyImplementationReport-20260122-150950.csv
[2026-01-22 15:09:50Z] 
[SUCCESS] 
HTML report generated: ./PolicyImplementationReport-20260122-150950.html
Dry-run summary written to ./DryRunSummary.txt

[2026-01-22 15:09:50Z] 
[INFO] 
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-01-22 15:09:50Z] 
[INFO] 
                    ğŸ“‹ NEXT STEPS GUIDANCE
[2026-01-22 15:09:50Z] 
[INFO] 
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ¯ Dry-Run Validation Complete

âœ… What was validated:
  â†’ Policy definitions resolved from mapping file
  â†’ Parameter overrides validated against policy schemas
  â†’ Assignment names generated (64-char limit enforced)
  â†’ No actual Azure resources created or modified

ğŸ“‹ Recommended Next Steps:
  1. ğŸ“„ Review dry-run summary:
     
notepad ./DryRunSummary.txt
  2. âœ… Verify all policies resolved successfully (Status: DryRun)
  3. ğŸ” Check for policies requiring managed identity (DeployIfNotExists/Modify effects)
  4. ğŸ“Š Review parameter values match your requirements
  5. ğŸš€ Deploy to test environment when ready:
     
.\\AzPolicyImplScript.ps1 -ParameterFile <YOUR_PARAM_FILE> -SkipRBACCheck

âš ï¸  Common Issues to Check:
  â†’ Policies with Status='Skipped' require -IdentityResourceId parameter
  â†’ Verify parameter values don't exceed policy min/max constraints
  â†’ Check for typos in policy display names (lookup failures)

ğŸ“š Documentation:
  â†’ Parameter File Guide: PolicyParameters-QuickReference.md
  â†’ Deployment Workflow: DEPLOYMENT-WORKFLOW-GUIDE.md


ğŸ“‹ Dry-Run Summary: 
./DryRunSummary.txt


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-01-22 15:09:50Z] 
[SUCCESS] 
Completed run. Reports generated.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“„ Reports Generated:
  â€¢ HTML:     
./PolicyImplementationReport-20260122-150950.html
  â€¢ Markdown: 
KeyVaultPolicyImplementationReport-20260122-150950.md
  â€¢ JSON:     
KeyVaultPolicyImplementationReport-20260122-150950.json


[2026-01-22 15:09:50Z] 
[INFO] 
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-01-22 15:09:50Z] 
[INFO] 
                    ğŸ“‹ NEXT STEPS GUIDANCE
[2026-01-22 15:09:50Z] 
[INFO] 
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ¯ Auto-Remediation Deployment Complete (8 Policies - DeployIfNotExists)

âœ… What was deployed:
  â†’ 8 auto-remediation policies (DeployIfNotExists/Modify effects)
  â†’ Managed identity assigned: Contributor role for automatic fixes
  â†’ Policies: Diagnostic settings, Private Endpoints, Soft Delete, Purge Protection

âš ï¸  CRITICAL: Remediation Timeline
  â†’ Azure Policy creates remediation tasks in 10-15 minutes
  â†’ Remediation completes in 2-10 minutes after task creation
  â†’ Total wait time: 15-30 minutes minimum

ğŸ“‹ Recommended Next Steps:
  1. â³ Wait 15-30 minutes for auto-remediation tasks to complete
  2. ğŸ“Š Monitor remediation status:
     
Get-AzPolicyRemediation -Scope '/subscriptions/YOUR_SUB_ID'
  3. âœ… Verify resources were remediated:
     
.\\AzPolicyImplScript.ps1 -CheckCompliance -TriggerScan
  4. ğŸ“‹ Review remediation tasks in HTML report

ğŸ› Troubleshooting Remediation Failures:
  â†’ Check managed identity has Contributor role
  â†’ Verify no Azure Policy conflicts (conflicting assignments)
  â†’ Review Azure Activity Log for error details

[2026-01-22 15:09:50] [SUCCESS]   âœ… Command executed successfully
[2026-01-22 15:09:50] [INFO]   Output saved to: .\scenario-3-output-20260122-150924.txt
[2026-01-22 15:09:50] [ERROR]   âŒ Console next steps validation failed for DevTest Auto-Remediation (8 Policies)
[2026-01-22 15:09:50] [ERROR]     - Missing 'NEXT STEPS GUIDANCE' banner
[2026-01-22 15:09:50] [ERROR]     - Missing auto-remediation deployment banner
[2026-01-22 15:09:50] [ERROR]     - Missing remediation timing guidance
[2026-01-22 15:09:50] [SUCCESS]   âœ… HTML report validated for DevTest Auto-Remediation (8 Policies)
[2026-01-22 15:09:50] [SUCCESS]   âœ… No unexpected warnings/errors for DevTest Auto-Remediation (8 Policies)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-01-22 15:09:52] [INFO] SCENARIO 4: Production Audit (46 Policies)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-01-22 15:09:52] [INFO] Executing: .\AzPolicyImplScript.ps1 -ParameterFile .\PolicyParameters-Production.json -SkipRBACCheck -Preview

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  Azure Policy Implementation - Key Vault Governance          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[2026-01-22 15:09:52Z] 
[INFO] 
Starting Azure Policy implementation script for Key Vault policies
[2026-01-22 15:09:52Z] 
[INFO] 
Checking required PowerShell modules...
[2026-01-22 15:09:52Z] 
[SUCCESS] 
Module Az.Accounts is present
[2026-01-22 15:09:52Z] 
[SUCCESS] 
Module Az.Resources is present
[2026-01-22 15:09:52Z] 
[SUCCESS] 
Module Az.PolicyInsights is present
[2026-01-22 15:09:52Z] 
[SUCCESS] 
Module Az.Monitor is present
[2026-01-22 15:09:52Z] 
[SUCCESS] 
Module Az.KeyVault is present
[2026-01-22 15:09:52Z] 
[INFO] 
Using Azure context: theregniers@hotmail.com
[2026-01-22 15:09:52Z] 
[INFO] 
Loading policy mapping from ./PolicyNameMapping.json
[2026-01-22 15:09:52Z] 
[INFO] 
Loaded 3745 policy mappings
[2026-01-22 15:09:52Z] 
[INFO] 
Loading policy parameter overrides from .\PolicyParameters-Production.json
[2026-01-22 15:09:52Z] 
[INFO] 
Detected deployment type: ProductionAudit (from parameter file: PolicyParameters-Production.json)
[2026-01-22 15:09:52Z] 
[INFO] 
Preview mode enabled: setting DryRun and skipping RBAC checks.
[2026-01-22 15:09:52Z] 
[INFO] 
DEBUG: PSBoundParameters keys: CsvPath, ParameterOverridesPath, SkipRBACCheck, Preview
[2026-01-22 15:09:52Z] 
[INFO] 
DEBUG: ScopeType value: ''
[2026-01-22 15:09:52Z] 
[INFO] 
Dry-run mode: using Subscription scope by default
[2026-01-22 15:09:52Z] 
[INFO] 
Checking current subscription context.
[2026-01-22 15:09:52Z] 
[INFO] 
Current subscription: MSDN Platforms Subscription (ab1336c7-687d-4107-b0f6-9649a0458adb)
[2026-01-22 15:09:52Z] 
[INFO] 
Dry-run mode: using current subscription context
[2026-01-22 15:09:52Z] 
[INFO] 
Preview mode: skipped RBAC permission check.
[2026-01-22 15:09:52Z] 
[INFO] 
Using policy effects from parameter file: .\PolicyParameters-Production.json

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  â„¹ï¸  Production Configuration Detected (Audit Mode)            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  Using production parameters in Audit mode (recommended first step)
  No resources will be blocked during this deployment

[2026-01-22 15:09:52Z] 
[SUCCESS] 
Loaded 46 policies from parameter file: .\PolicyParameters-Production.json

Processing 46 policies...
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

[2026-01-22 15:09:52Z] 
[INFO] 
Preparing to assign (1/46): Certificates using elliptic curve cryptography should have allowed curve names
[2026-01-22 15:09:52Z] 
[INFO] 
Assigning policy 'Certificates using elliptic curve cryptography should have allowed curve names' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:52Z] 
[SUCCESS] 
Found 'Certificates using elliptic curve cryptography should have allowed curve names' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/bd78111f-4953-4367-9fd5-7e08808b54bf
[2026-01-22 15:09:52Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:52Z] 
[INFO] 
DEBUG: Defined parameter names: allowedECNames, effect
[2026-01-22 15:09:52Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:09:52Z] 
[INFO] 
DEBUG: Checking parameter 'allowedECNames' against policy definition
[2026-01-22 15:09:52Z] 
[INFO] 
DEBUG: Defined parameter names: allowedECNames, effect
[2026-01-22 15:09:52Z] 
[INFO] 
DEBUG: Added parameter 'allowedECNames' = 'P-256 P-256K P-384 P-521' to cleaned params
[2026-01-22 15:09:52Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesusingellipticcurvecryptographyshouldhavea-1468057639 and params: 
Name                           Value
----                           -----
allowedECNames                 {P-256, P-256K, P-384, P-521}
effect                         Deny



[2026-01-22 15:09:52Z] 
[INFO] 
Preparing to assign (2/46): Configure key vaults to enable firewall
[2026-01-22 15:09:52Z] 
[INFO] 
Assigning policy 'Configure key vaults to enable firewall' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:52Z] 
[SUCCESS] 
Found 'Configure key vaults to enable firewall' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/ac673a9a-f77d-4846-b2d8-a57f8e1c01dc
[2026-01-22 15:09:53Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:53Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:09:53Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Modify' to cleaned params
[2026-01-22 15:09:53Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '' (Length: 0)
[2026-01-22 15:09:53Z] 
[WARN] 
Effect '' requires managed identity. Skipping assignment - provide -IdentityResourceId to enable.

[2026-01-22 15:09:53Z] 
[INFO] 
Preparing to assign (3/46): Azure Key Vault should use RBAC permission model
[2026-01-22 15:09:53Z] 
[INFO] 
Assigning policy 'Azure Key Vault should use RBAC permission model' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:53Z] 
[SUCCESS] 
Found 'Azure Key Vault should use RBAC permission model' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/12d4fa5e-1f9f-4c21-97a9-b99b3c6611b5
[2026-01-22 15:09:53Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:53Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:09:53Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:09:53Z] 
[INFO] 
Dry-run: would create assignment with name AzureKeyVaultshoulduseRBACpermissionmodel-307198231 and params: 
Name                           Value
----                           -----
effect                         Deny



[2026-01-22 15:09:53Z] 
[INFO] 
Preparing to assign (4/46): Keys should be the specified cryptographic type RSA or EC
[2026-01-22 15:09:53Z] 
[INFO] 
Assigning policy 'Keys should be the specified cryptographic type RSA or EC' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:53Z] 
[SUCCESS] 
Found 'Keys should be the specified cryptographic type RSA or EC' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/75c4f823-d65c-4f29-a733-01d0077fdbcb
[2026-01-22 15:09:53Z] 
[INFO] 
DEBUG: Checking parameter 'allowedKeyTypes' against policy definition
[2026-01-22 15:09:53Z] 
[INFO] 
DEBUG: Defined parameter names: allowedKeyTypes, effect
[2026-01-22 15:09:53Z] 
[INFO] 
DEBUG: Added parameter 'allowedKeyTypes' = 'RSA EC' to cleaned params
[2026-01-22 15:09:53Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:53Z] 
[INFO] 
DEBUG: Defined parameter names: allowedKeyTypes, effect
[2026-01-22 15:09:53Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:09:53Z] 
[INFO] 
Dry-run: would create assignment with name KeysshouldbethespecifiedcryptographictypeRSAorEC-976981238 and params: 
Name                           Value
----                           -----
allowedKeyTypes                {RSA, EC}
effect                         Deny



[2026-01-22 15:09:53Z] 
[INFO] 
Preparing to assign (5/46): Keys using elliptic curve cryptography should have the specified curve names
[2026-01-22 15:09:53Z] 
[INFO] 
Assigning policy 'Keys using elliptic curve cryptography should have the specified curve names' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:53Z] 
[SUCCESS] 
Found 'Keys using elliptic curve cryptography should have the specified curve names' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/ff25f3c8-b739-4538-9d07-3d6d25cfb255
[2026-01-22 15:09:54Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:54Z] 
[INFO] 
DEBUG: Defined parameter names: allowedECNames, effect
[2026-01-22 15:09:54Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:09:54Z] 
[INFO] 
DEBUG: Checking parameter 'allowedECNames' against policy definition
[2026-01-22 15:09:54Z] 
[INFO] 
DEBUG: Defined parameter names: allowedECNames, effect
[2026-01-22 15:09:54Z] 
[INFO] 
DEBUG: Added parameter 'allowedECNames' = 'P-256 P-256K P-384 P-521' to cleaned params
[2026-01-22 15:09:54Z] 
[INFO] 
Dry-run: would create assignment with name Keysusingellipticcurvecryptographyshouldhavethespecif-1437325202 and params: 
Name                           Value
----                           -----
allowedECNames                 {P-256, P-256K, P-384, P-521}
effect                         Deny



[2026-01-22 15:09:54Z] 
[INFO] 
Preparing to assign (6/46): Deploy Diagnostic Settings for Key Vault to Event Hub
[2026-01-22 15:09:54Z] 
[INFO] 
Assigning policy 'Deploy Diagnostic Settings for Key Vault to Event Hub' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:54Z] 
[SUCCESS] 
Found 'Deploy Diagnostic Settings for Key Vault to Event Hub' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/ed7c8c13-51e7-49d1-8a43-8490431a0da2
[2026-01-22 15:09:54Z] 
[INFO] 
DEBUG: Checking parameter 'eventHubLocation' against policy definition
[2026-01-22 15:09:54Z] 
[INFO] 
DEBUG: Defined parameter names: effect, profileName, eventHubRuleId, eventHubLocation, metricsEnabled, logsEnabled
[2026-01-22 15:09:54Z] 
[INFO] 
DEBUG: Added parameter 'eventHubLocation' = 'eastus' to cleaned params
[2026-01-22 15:09:54Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:54Z] 
[INFO] 
DEBUG: Defined parameter names: effect, profileName, eventHubRuleId, eventHubLocation, metricsEnabled, logsEnabled
[2026-01-22 15:09:54Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'DeployIfNotExists' to cleaned params
[2026-01-22 15:09:54Z] 
[INFO] 
DEBUG: Checking parameter 'eventHubRuleId' against policy definition
[2026-01-22 15:09:54Z] 
[INFO] 
DEBUG: Defined parameter names: effect, profileName, eventHubRuleId, eventHubLocation, metricsEnabled, logsEnabled
[2026-01-22 15:09:54Z] 
[INFO] 
DEBUG: Added parameter 'eventHubRuleId' = '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.EventHub/namespaces/eh-policy-test-3464/authorizationrules/RootManageSharedAccessKey' to cleaned params
[2026-01-22 15:09:54Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '' (Length: 0)
[2026-01-22 15:09:54Z] 
[WARN] 
Effect '' requires managed identity. Skipping assignment - provide -IdentityResourceId to enable.

[2026-01-22 15:09:54Z] 
[INFO] 
Preparing to assign (7/46): Keys using RSA cryptography should have a specified minimum key size
[2026-01-22 15:09:54Z] 
[INFO] 
Assigning policy 'Keys using RSA cryptography should have a specified minimum key size' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:54Z] 
[SUCCESS] 
Found 'Keys using RSA cryptography should have a specified minimum key size' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/82067dbb-e53b-4e06-b631-546d197452d9
[2026-01-22 15:09:55Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:55Z] 
[INFO] 
DEBUG: Defined parameter names: minimumRSAKeySize, effect
[2026-01-22 15:09:55Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:09:55Z] 
[INFO] 
DEBUG: Checking parameter 'minimumRSAKeySize' against policy definition
[2026-01-22 15:09:55Z] 
[INFO] 
DEBUG: Defined parameter names: minimumRSAKeySize, effect
[2026-01-22 15:09:55Z] 
[INFO] 
DEBUG: Added parameter 'minimumRSAKeySize' = '4096' to cleaned params
[2026-01-22 15:09:55Z] 
[INFO] 
Dry-run: would create assignment with name KeysusingRSAcryptographyshouldhaveaspecifiedminimumkey-909744685 and params: 
Name                           Value
----                           -----
minimumRSAKeySize              4096
effect                         Deny



[2026-01-22 15:09:55Z] 
[INFO] 
Preparing to assign (8/46): Deploy - Configure diagnostic settings for Azure Key Vault to Log Analytics workspace
[2026-01-22 15:09:55Z] 
[INFO] 
Assigning policy 'Deploy - Configure diagnostic settings for Azure Key Vault to Log Analytics workspace' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:55Z] 
[SUCCESS] 
Found 'Deploy - Configure diagnostic settings for Azure Key Vault to Log Analytics workspace' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/951af2fa-529b-416e-ab6e-066fd85ac459
[2026-01-22 15:09:55Z] 
[INFO] 
DEBUG: Checking parameter 'logAnalytics' against policy definition
[2026-01-22 15:09:55Z] 
[INFO] 
DEBUG: Defined parameter names: effect, diagnosticsSettingNameToUse, logAnalytics, AuditEventEnabled, AllMetricsEnabled
[2026-01-22 15:09:55Z] 
[INFO] 
DEBUG: Added parameter 'logAnalytics' = '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.OperationalInsights/workspaces/law-policy-test-6874' to cleaned params
[2026-01-22 15:09:55Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:55Z] 
[INFO] 
DEBUG: Defined parameter names: effect, diagnosticsSettingNameToUse, logAnalytics, AuditEventEnabled, AllMetricsEnabled
[2026-01-22 15:09:55Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'DeployIfNotExists' to cleaned params
[2026-01-22 15:09:55Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '' (Length: 0)
[2026-01-22 15:09:55Z] 
[WARN] 
Effect '' requires managed identity. Skipping assignment - provide -IdentityResourceId to enable.

[2026-01-22 15:09:55Z] 
[INFO] 
Preparing to assign (9/46): [Preview]: Azure Key Vault Managed HSM keys using RSA cryptography should have a specified minimum key size
[2026-01-22 15:09:55Z] 
[INFO] 
Assigning policy '[Preview]: Azure Key Vault Managed HSM keys using RSA cryptography should have a specified minimum key size' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:55Z] 
[SUCCESS] 
Found '[Preview]: Azure Key Vault Managed HSM keys using RSA cryptography should have a specified minimum key size' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/86810a98-8e91-4a44-8386-ec66d0de5d57
[2026-01-22 15:09:55Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:55Z] 
[INFO] 
DEBUG: Defined parameter names: effect, minimumRSAKeySize
[2026-01-22 15:09:55Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:55Z] 
[INFO] 
DEBUG: Checking parameter 'minimumRSAKeySize' against policy definition
[2026-01-22 15:09:55Z] 
[INFO] 
DEBUG: Defined parameter names: effect, minimumRSAKeySize
[2026-01-22 15:09:55Z] 
[INFO] 
DEBUG: Added parameter 'minimumRSAKeySize' = '4096' to cleaned params
[2026-01-22 15:09:55Z] 
[INFO] 
Dry-run: would create assignment with name PreviewAzureKeyVaultManagedHSMkeysusingRSAcryptography-998252524 and params: 
Name                           Value
----                           -----
minimumRSAKeySize              4096
effect                         Audit



[2026-01-22 15:09:55Z] 
[INFO] 
Preparing to assign (10/46): Certificates should be issued by the specified integrated certificate authority
[2026-01-22 15:09:55Z] 
[INFO] 
Assigning policy 'Certificates should be issued by the specified integrated certificate authority' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:55Z] 
[SUCCESS] 
Found 'Certificates should be issued by the specified integrated certificate authority' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/8e826246-c976-48f6-b03e-619bb92b3d82
[2026-01-22 15:09:55Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:55Z] 
[INFO] 
DEBUG: Defined parameter names: allowedCAs, effect
[2026-01-22 15:09:55Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:55Z] 
[INFO] 
DEBUG: Checking parameter 'allowedCAs' against policy definition
[2026-01-22 15:09:55Z] 
[INFO] 
DEBUG: Defined parameter names: allowedCAs, effect
[2026-01-22 15:09:55Z] 
[INFO] 
DEBUG: Added parameter 'allowedCAs' = 'DigiCert GlobalSign' to cleaned params
[2026-01-22 15:09:55Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesshouldbeissuedbythespecifiedintegratedcer-1190107367 and params: 
Name                           Value
----                           -----
allowedCAs                     {DigiCert, GlobalSign}
effect                         Audit



[2026-01-22 15:09:56Z] 
[INFO] 
Preparing to assign (11/46): Secrets should have more than the specified number of days before expiration
[2026-01-22 15:09:56Z] 
[INFO] 
Assigning policy 'Secrets should have more than the specified number of days before expiration' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:56Z] 
[SUCCESS] 
Found 'Secrets should have more than the specified number of days before expiration' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/b0eb591a-5e70-4534-a8bf-04b9c489584a
[2026-01-22 15:09:56Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:56Z] 
[INFO] 
DEBUG: Defined parameter names: minimumDaysBeforeExpiration, effect
[2026-01-22 15:09:56Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:56Z] 
[INFO] 
DEBUG: Checking parameter 'minimumDaysBeforeExpiration' against policy definition
[2026-01-22 15:09:56Z] 
[INFO] 
DEBUG: Defined parameter names: minimumDaysBeforeExpiration, effect
[2026-01-22 15:09:56Z] 
[INFO] 
DEBUG: Added parameter 'minimumDaysBeforeExpiration' = '90' to cleaned params
[2026-01-22 15:09:56Z] 
[INFO] 
Dry-run: would create assignment with name Secretsshouldhavemorethanthespecifiednumberofdaysbefo-1193127515 and params: 
Name                           Value
----                           -----
minimumDaysBeforeExpiration    90
effect                         Audit



[2026-01-22 15:09:56Z] 
[INFO] 
Preparing to assign (12/46): Configure Azure Key Vaults to use private DNS zones
[2026-01-22 15:09:56Z] 
[INFO] 
Assigning policy 'Configure Azure Key Vaults to use private DNS zones' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:56Z] 
[SUCCESS] 
Found 'Configure Azure Key Vaults to use private DNS zones' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/ac673a9a-f77d-4846-b2d8-a57f8e1c01d4
[2026-01-22 15:09:56Z] 
[INFO] 
DEBUG: Checking parameter 'privateDnsZoneId' against policy definition
[2026-01-22 15:09:56Z] 
[INFO] 
DEBUG: Defined parameter names: privateDnsZoneId, effect
[2026-01-22 15:09:56Z] 
[INFO] 
DEBUG: Added parameter 'privateDnsZoneId' = '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.Network/privateDnsZones/privatelink.vaultcore.azure.net' to cleaned params
[2026-01-22 15:09:56Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:56Z] 
[INFO] 
DEBUG: Defined parameter names: privateDnsZoneId, effect
[2026-01-22 15:09:56Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'DeployIfNotExists' to cleaned params
[2026-01-22 15:09:56Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '' (Length: 0)
[2026-01-22 15:09:56Z] 
[WARN] 
Effect '' requires managed identity. Skipping assignment - provide -IdentityResourceId to enable.

[2026-01-22 15:09:56Z] 
[INFO] 
Preparing to assign (13/46): Configure Azure Key Vaults with private endpoints
[2026-01-22 15:09:56Z] 
[INFO] 
Assigning policy 'Configure Azure Key Vaults with private endpoints' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:56Z] 
[SUCCESS] 
Found 'Configure Azure Key Vaults with private endpoints' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/9d4fad1f-5189-4a42-b29e-cf7929c6b6df
[2026-01-22 15:09:57Z] 
[INFO] 
DEBUG: Checking parameter 'privateEndpointSubnetId' against policy definition
[2026-01-22 15:09:57Z] 
[INFO] 
DEBUG: Defined parameter names: privateEndpointSubnetId, effect
[2026-01-22 15:09:57Z] 
[INFO] 
DEBUG: Added parameter 'privateEndpointSubnetId' = '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-keyvault-test/providers/Microsoft.Network/virtualNetworks/vnet-policy-test/subnets/subnet-keyvault' to cleaned params
[2026-01-22 15:09:57Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:57Z] 
[INFO] 
DEBUG: Defined parameter names: privateEndpointSubnetId, effect
[2026-01-22 15:09:57Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'DeployIfNotExists' to cleaned params
[2026-01-22 15:09:57Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '' (Length: 0)
[2026-01-22 15:09:57Z] 
[WARN] 
Effect '' requires managed identity. Skipping assignment - provide -IdentityResourceId to enable.

[2026-01-22 15:09:57Z] 
[INFO] 
Preparing to assign (14/46): [Preview]: Azure Key Vault Managed HSM keys should have an expiration date
[2026-01-22 15:09:57Z] 
[INFO] 
Assigning policy '[Preview]: Azure Key Vault Managed HSM keys should have an expiration date' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:57Z] 
[SUCCESS] 
Found '[Preview]: Azure Key Vault Managed HSM keys should have an expiration date' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/1d478a74-21ba-4b9f-9d8f-8e6fced0eec5
[2026-01-22 15:09:57Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:57Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:09:57Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:09:57Z] 
[INFO] 
Dry-run: would create assignment with name PreviewAzureKeyVaultManagedHSMkeysshouldhaveanexpirati-976371970 and params: 
Name                           Value
----                           -----
effect                         Deny



[2026-01-22 15:09:57Z] 
[INFO] 
Preparing to assign (15/46): Key Vault keys should have an expiration date
[2026-01-22 15:09:57Z] 
[INFO] 
Assigning policy 'Key Vault keys should have an expiration date' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:57Z] 
[SUCCESS] 
Found 'Key Vault keys should have an expiration date' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/152b15f7-8e1f-4c1f-ab71-8c010ba5dbc0
[2026-01-22 15:09:58Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:58Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:09:58Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:09:58Z] 
[INFO] 
Dry-run: would create assignment with name KeyVaultkeysshouldhaveanexpirationdate-386037801 and params: 
Name                           Value
----                           -----
effect                         Deny



[2026-01-22 15:09:58Z] 
[INFO] 
Preparing to assign (16/46): Key vaults should have soft delete enabled
[2026-01-22 15:09:58Z] 
[INFO] 
Assigning policy 'Key vaults should have soft delete enabled' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:58Z] 
[SUCCESS] 
Found 'Key vaults should have soft delete enabled' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/1e66c121-a66a-4b1f-9b83-0fd99bf0fc2d
[2026-01-22 15:09:58Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:58Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:09:58Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:58Z] 
[INFO] 
Dry-run: would create assignment with name Keyvaultsshouldhavesoftdeleteenabled-656701378 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:09:58Z] 
[INFO] 
Preparing to assign (17/46): Certificates should use allowed key types
[2026-01-22 15:09:58Z] 
[INFO] 
Assigning policy 'Certificates should use allowed key types' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:58Z] 
[SUCCESS] 
Found 'Certificates should use allowed key types' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/1151cede-290b-4ba0-8b38-0ad145ac888f
[2026-01-22 15:09:58Z] 
[INFO] 
DEBUG: Checking parameter 'allowedKeyTypes' against policy definition
[2026-01-22 15:09:58Z] 
[INFO] 
DEBUG: Defined parameter names: allowedKeyTypes, effect
[2026-01-22 15:09:58Z] 
[INFO] 
DEBUG: Added parameter 'allowedKeyTypes' = 'RSA EC' to cleaned params
[2026-01-22 15:09:58Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:58Z] 
[INFO] 
DEBUG: Defined parameter names: allowedKeyTypes, effect
[2026-01-22 15:09:58Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:09:58Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesshoulduseallowedkeytypes-246707145 and params: 
Name                           Value
----                           -----
allowedKeyTypes                {RSA, EC}
effect                         Deny



[2026-01-22 15:09:58Z] 
[INFO] 
Preparing to assign (18/46): Resource logs in Key Vault should be enabled
[2026-01-22 15:09:58Z] 
[INFO] 
Assigning policy 'Resource logs in Key Vault should be enabled' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:58Z] 
[SUCCESS] 
Found 'Resource logs in Key Vault should be enabled' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21
[2026-01-22 15:09:58Z] 
[INFO] 
DEBUG: Checking parameter 'requiredRetentionDays' against policy definition
[2026-01-22 15:09:58Z] 
[INFO] 
DEBUG: Defined parameter names: effect, requiredRetentionDays
[2026-01-22 15:09:58Z] 
[INFO] 
DEBUG: Added parameter 'requiredRetentionDays' = '365' to cleaned params
[2026-01-22 15:09:58Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:58Z] 
[INFO] 
DEBUG: Defined parameter names: effect, requiredRetentionDays
[2026-01-22 15:09:58Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'AuditIfNotExists' to cleaned params
[2026-01-22 15:09:58Z] 
[INFO] 
Dry-run: would create assignment with name ResourcelogsinKeyVaultshouldbeenabled-1683835535 and params: 
Name                           Value
----                           -----
requiredRetentionDays          365
effect                         AuditIfNotExists



[2026-01-22 15:09:58Z] 
[INFO] 
Preparing to assign (19/46): Certificates should have the specified lifetime action triggers
[2026-01-22 15:09:58Z] 
[INFO] 
Assigning policy 'Certificates should have the specified lifetime action triggers' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:58Z] 
[SUCCESS] 
Found 'Certificates should have the specified lifetime action triggers' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/12ef42cb-9903-4e39-9c26-422d29570417
[2026-01-22 15:09:59Z] 
[INFO] 
DEBUG: Checking parameter 'maximumPercentageLife' against policy definition
[2026-01-22 15:09:59Z] 
[INFO] 
DEBUG: Defined parameter names: maximumPercentageLife, minimumDaysBeforeExpiry, effect
[2026-01-22 15:09:59Z] 
[INFO] 
DEBUG: Added parameter 'maximumPercentageLife' = '80' to cleaned params
[2026-01-22 15:09:59Z] 
[INFO] 
DEBUG: Checking parameter 'minimumDaysBeforeExpiry' against policy definition
[2026-01-22 15:09:59Z] 
[INFO] 
DEBUG: Defined parameter names: maximumPercentageLife, minimumDaysBeforeExpiry, effect
[2026-01-22 15:09:59Z] 
[INFO] 
DEBUG: Added parameter 'minimumDaysBeforeExpiry' = '90' to cleaned params
[2026-01-22 15:09:59Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:59Z] 
[INFO] 
DEBUG: Defined parameter names: maximumPercentageLife, minimumDaysBeforeExpiry, effect
[2026-01-22 15:09:59Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:09:59Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesshouldhavethespecifiedlifetimeactiontrigg-1761965968 and params: 
Name                           Value
----                           -----
maximumPercentageLife          80
minimumDaysBeforeExpiry        90
effect                         Deny



[2026-01-22 15:09:59Z] 
[INFO] 
Preparing to assign (20/46): Secrets should not be active for longer than the specified number of days
[2026-01-22 15:09:59Z] 
[INFO] 
Assigning policy 'Secrets should not be active for longer than the specified number of days' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:59Z] 
[SUCCESS] 
Found 'Secrets should not be active for longer than the specified number of days' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/e8d99835-8a06-45ae-a8e0-87a91941ccfe
[2026-01-22 15:09:59Z] 
[INFO] 
DEBUG: Checking parameter 'maximumValidityInDays' against policy definition
[2026-01-22 15:09:59Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:09:59Z] 
[INFO] 
DEBUG: Added parameter 'maximumValidityInDays' = '365' to cleaned params
[2026-01-22 15:09:59Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:59Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:09:59Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:59Z] 
[INFO] 
Dry-run: would create assignment with name Secretsshouldnotbeactiveforlongerthanthespecifiednumb-1452013840 and params: 
Name                           Value
----                           -----
maximumValidityInDays          365
effect                         Audit



[2026-01-22 15:09:59Z] 
[INFO] 
Preparing to assign (21/46): Certificates should be issued by the specified non-integrated certificate authority
[2026-01-22 15:09:59Z] 
[INFO] 
Assigning policy 'Certificates should be issued by the specified non-integrated certificate authority' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:59Z] 
[SUCCESS] 
Found 'Certificates should be issued by the specified non-integrated certificate authority' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/a22f4a40-01d3-4c7d-8071-da157eeff341
[2026-01-22 15:09:59Z] 
[INFO] 
DEBUG: Checking parameter 'caCommonName' against policy definition
[2026-01-22 15:09:59Z] 
[INFO] 
DEBUG: Defined parameter names: caCommonName, effect
[2026-01-22 15:09:59Z] 
[INFO] 
DEBUG: Added parameter 'caCommonName' = 'ContosoCA' to cleaned params
[2026-01-22 15:09:59Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:09:59Z] 
[INFO] 
DEBUG: Defined parameter names: caCommonName, effect
[2026-01-22 15:09:59Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:09:59Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesshouldbeissuedbythespecifiednonintegratedc-500792775 and params: 
Name                           Value
----                           -----
caCommonName                   ContosoCA
effect                         Audit



[2026-01-22 15:09:59Z] 
[INFO] 
Preparing to assign (22/46): Certificates should have the specified maximum validity period
[2026-01-22 15:09:59Z] 
[INFO] 
Assigning policy 'Certificates should have the specified maximum validity period' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:09:59Z] 
[SUCCESS] 
Found 'Certificates should have the specified maximum validity period' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/0a075868-4c26-42ef-914c-5bc007359560
[2026-01-22 15:10:00Z] 
[INFO] 
DEBUG: Checking parameter 'maximumValidityInMonths' against policy definition
[2026-01-22 15:10:00Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInMonths, effect
[2026-01-22 15:10:00Z] 
[INFO] 
DEBUG: Added parameter 'maximumValidityInMonths' = '12' to cleaned params
[2026-01-22 15:10:00Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:00Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInMonths, effect
[2026-01-22 15:10:00Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:10:00Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesshouldhavethespecifiedmaximumvalidityperio-407807336 and params: 
Name                           Value
----                           -----
maximumValidityInMonths        12
effect                         Deny



[2026-01-22 15:10:00Z] 
[INFO] 
Preparing to assign (23/46): [Preview]: Azure Key Vault Managed HSM should use private link
[2026-01-22 15:10:00Z] 
[INFO] 
Assigning policy '[Preview]: Azure Key Vault Managed HSM should use private link' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:00Z] 
[SUCCESS] 
Found '[Preview]: Azure Key Vault Managed HSM should use private link' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/59fee2f4-d439-4f1b-9b9a-982e1474bfd8
[2026-01-22 15:10:00Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:00Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:10:00Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:00Z] 
[INFO] 
Dry-run: would create assignment with name PreviewAzureKeyVaultManagedHSMshoulduseprivatelink-504701151 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:10:00Z] 
[INFO] 
Preparing to assign (24/46): Key vaults should have deletion protection enabled
[2026-01-22 15:10:00Z] 
[INFO] 
Assigning policy 'Key vaults should have deletion protection enabled' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:00Z] 
[SUCCESS] 
Found 'Key vaults should have deletion protection enabled' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/0b60c0b2-2dc2-4e1c-b5c9-abbed971de53
[2026-01-22 15:10:00Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:00Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:10:00Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:10:00Z] 
[INFO] 
Dry-run: would create assignment with name Keyvaultsshouldhavedeletionprotectionenabled-1439856846 and params: 
Name                           Value
----                           -----
effect                         Deny



[2026-01-22 15:10:00Z] 
[INFO] 
Preparing to assign (25/46): Resource logs in Azure Key Vault Managed HSM should be enabled
[2026-01-22 15:10:00Z] 
[INFO] 
Assigning policy 'Resource logs in Azure Key Vault Managed HSM should be enabled' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:00Z] 
[SUCCESS] 
Found 'Resource logs in Azure Key Vault Managed HSM should be enabled' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/a2a5b911-5617-447e-a49e-59dbe0e0434b
[2026-01-22 15:10:01Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:01Z] 
[INFO] 
DEBUG: Defined parameter names: effect, requiredRetentionDays
[2026-01-22 15:10:01Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'AuditIfNotExists' to cleaned params
[2026-01-22 15:10:01Z] 
[INFO] 
Dry-run: would create assignment with name ResourcelogsinAzureKeyVaultManagedHSMshouldbeenabled-1874150632 and params: 
Name                           Value
----                           -----
effect                         AuditIfNotExists



[2026-01-22 15:10:01Z] 
[INFO] 
Preparing to assign (26/46): Key Vault secrets should have an expiration date
[2026-01-22 15:10:01Z] 
[INFO] 
Assigning policy 'Key Vault secrets should have an expiration date' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:01Z] 
[SUCCESS] 
Found 'Key Vault secrets should have an expiration date' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/98728c90-32c7-4049-8429-847dc0f4fe37
[2026-01-22 15:10:01Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:01Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:10:01Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:10:01Z] 
[INFO] 
Dry-run: would create assignment with name KeyVaultsecretsshouldhaveanexpirationdate-1232117220 and params: 
Name                           Value
----                           -----
effect                         Deny



[2026-01-22 15:10:01Z] 
[INFO] 
Preparing to assign (27/46): Keys should have a rotation policy ensuring that their rotation is scheduled within the specified number of days after creation.
[2026-01-22 15:10:01Z] 
[INFO] 
Assigning policy 'Keys should have a rotation policy ensuring that their rotation is scheduled within the specified number of days after creation.' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:01Z] 
[SUCCESS] 
Found 'Keys should have a rotation policy ensuring that their rotation is scheduled within the specified number of days after creation.' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/d8cf8476-a2ec-4916-896e-992351803c44
[2026-01-22 15:10:01Z] 
[INFO] 
DEBUG: Checking parameter 'maximumDaysToRotate' against policy definition
[2026-01-22 15:10:01Z] 
[INFO] 
DEBUG: Defined parameter names: maximumDaysToRotate, effect
[2026-01-22 15:10:01Z] 
[INFO] 
DEBUG: Added parameter 'maximumDaysToRotate' = '90' to cleaned params
[2026-01-22 15:10:01Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:01Z] 
[INFO] 
DEBUG: Defined parameter names: maximumDaysToRotate, effect
[2026-01-22 15:10:01Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:01Z] 
[INFO] 
Dry-run: would create assignment with name Keysshouldhavearotationpolicyensuringthattheirrotatio-1816322754 and params: 
Name                           Value
----                           -----
maximumDaysToRotate            90
effect                         Audit



[2026-01-22 15:10:01Z] 
[INFO] 
Preparing to assign (28/46): Certificates should not expire within the specified number of days
[2026-01-22 15:10:01Z] 
[INFO] 
Assigning policy 'Certificates should not expire within the specified number of days' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:01Z] 
[SUCCESS] 
Found 'Certificates should not expire within the specified number of days' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/f772fb64-8e40-40ad-87bc-7706e1949427
[2026-01-22 15:10:02Z] 
[INFO] 
DEBUG: Checking parameter 'daysToExpire' against policy definition
[2026-01-22 15:10:02Z] 
[INFO] 
DEBUG: Defined parameter names: daysToExpire, effect
[2026-01-22 15:10:02Z] 
[INFO] 
DEBUG: Added parameter 'daysToExpire' = '90' to cleaned params
[2026-01-22 15:10:02Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:02Z] 
[INFO] 
DEBUG: Defined parameter names: daysToExpire, effect
[2026-01-22 15:10:02Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:02Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesshouldnotexpirewithinthespecifiednumberof-2114192775 and params: 
Name                           Value
----                           -----
daysToExpire                   90
effect                         Audit



[2026-01-22 15:10:02Z] 
[INFO] 
Preparing to assign (29/46): [Preview]: Azure Key Vault Managed HSM should disable public network access
[2026-01-22 15:10:02Z] 
[INFO] 
Assigning policy '[Preview]: Azure Key Vault Managed HSM should disable public network access' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:02Z] 
[SUCCESS] 
Found '[Preview]: Azure Key Vault Managed HSM should disable public network access' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/19ea9d63-adee-4431-a95e-1913c6c1c75f
[2026-01-22 15:10:02Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:02Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:10:02Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:02Z] 
[INFO] 
Dry-run: would create assignment with name PreviewAzureKeyVaultManagedHSMshoulddisablepublicnetwo-208646097 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:10:02Z] 
[INFO] 
Preparing to assign (30/46): Azure Key Vaults should use private link
[2026-01-22 15:10:02Z] 
[INFO] 
Assigning policy 'Azure Key Vaults should use private link' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:02Z] 
[SUCCESS] 
Found 'Azure Key Vaults should use private link' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/a6abeaec-4d90-4a02-805f-6b26c4d3fbe9
[2026-01-22 15:10:02Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:02Z] 
[INFO] 
DEBUG: Defined parameter names: audit_effect, effect
[2026-01-22 15:10:02Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:02Z] 
[INFO] 
Dry-run: would create assignment with name AzureKeyVaultsshoulduseprivatelink-2127082189 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:10:02Z] 
[INFO] 
Preparing to assign (31/46): Keys should be backed by a hardware security module (HSM)
[2026-01-22 15:10:02Z] 
[INFO] 
Assigning policy 'Keys should be backed by a hardware security module (HSM)' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:02Z] 
[SUCCESS] 
Found 'Keys should be backed by a hardware security module (HSM)' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/587c79fe-dd04-4a5e-9d0b-f89598c7261b
[2026-01-22 15:10:03Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:03Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:10:03Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:03Z] 
[INFO] 
Dry-run: would create assignment with name KeysshouldbebackedbyahardwaresecuritymoduleHSM-593124860 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:10:03Z] 
[INFO] 
Preparing to assign (32/46): Azure Key Vault should have firewall enabled or public network access disabled
[2026-01-22 15:10:03Z] 
[INFO] 
Assigning policy 'Azure Key Vault should have firewall enabled or public network access disabled' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:03Z] 
[SUCCESS] 
Found 'Azure Key Vault should have firewall enabled or public network access disabled' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/55615ac9-af46-4a59-874e-391cc3dfb490
[2026-01-22 15:10:03Z] 
[INFO] 
DEBUG: Checking parameter 'allowedIPAddresses' against policy definition
[2026-01-22 15:10:03Z] 
[INFO] 
DEBUG: Defined parameter names: effect, restrictIPAddresses, allowedIPAddresses, forbiddenIPAddresses
[2026-01-22 15:10:03Z] 
[INFO] 
DEBUG: Added parameter 'allowedIPAddresses' = '0.0.0.0/0' to cleaned params
[2026-01-22 15:10:03Z] 
[INFO] 
DEBUG: Checking parameter 'forbiddenIPAddresses' against policy definition
[2026-01-22 15:10:03Z] 
[INFO] 
DEBUG: Defined parameter names: effect, restrictIPAddresses, allowedIPAddresses, forbiddenIPAddresses
[2026-01-22 15:10:03Z] 
[INFO] 
DEBUG: Added parameter 'forbiddenIPAddresses' = '' to cleaned params
[2026-01-22 15:10:03Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:03Z] 
[INFO] 
DEBUG: Defined parameter names: effect, restrictIPAddresses, allowedIPAddresses, forbiddenIPAddresses
[2026-01-22 15:10:03Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:03Z] 
[INFO] 
Dry-run: would create assignment with name AzureKeyVaultshouldhavefirewallenabledorpublicnetwork-1396884516 and params: 
Name                           Value
----                           -----
allowedIPAddresses             {0.0.0.0/0}
forbiddenIPAddresses           {}
effect                         Audit



[2026-01-22 15:10:03Z] 
[INFO] 
Preparing to assign (33/46): Keys should have the specified maximum validity period
[2026-01-22 15:10:03Z] 
[INFO] 
Assigning policy 'Keys should have the specified maximum validity period' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:03Z] 
[SUCCESS] 
Found 'Keys should have the specified maximum validity period' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/49a22571-d204-4c91-a7b6-09b1a586fbc9
[2026-01-22 15:10:03Z] 
[INFO] 
DEBUG: Checking parameter 'maximumValidityInDays' against policy definition
[2026-01-22 15:10:03Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:10:03Z] 
[INFO] 
DEBUG: Added parameter 'maximumValidityInDays' = '365' to cleaned params
[2026-01-22 15:10:03Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:03Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:10:03Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:10:03Z] 
[INFO] 
Dry-run: would create assignment with name Keysshouldhavethespecifiedmaximumvalidityperiod-906231923 and params: 
Name                           Value
----                           -----
maximumValidityInDays          365
effect                         Deny



[2026-01-22 15:10:03Z] 
[INFO] 
Preparing to assign (34/46): Secrets should have content type set
[2026-01-22 15:10:03Z] 
[INFO] 
Assigning policy 'Secrets should have content type set' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:03Z] 
[SUCCESS] 
Found 'Secrets should have content type set' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/75262d3e-ba4a-4f43-85f8-9f72c090e5e3
[2026-01-22 15:10:04Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:04Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:10:04Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:04Z] 
[INFO] 
Dry-run: would create assignment with name Secretsshouldhavecontenttypeset-1186338756 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:10:04Z] 
[INFO] 
Preparing to assign (35/46): Azure Key Vault should disable public network access
[2026-01-22 15:10:04Z] 
[INFO] 
Assigning policy 'Azure Key Vault should disable public network access' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:04Z] 
[SUCCESS] 
Found 'Azure Key Vault should disable public network access' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/405c5871-3e91-4644-8a63-58e19d68ff5b
[2026-01-22 15:10:04Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:04Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:10:04Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:10:04Z] 
[INFO] 
Dry-run: would create assignment with name AzureKeyVaultshoulddisablepublicnetworkaccess-906277113 and params: 
Name                           Value
----                           -----
effect                         Deny



[2026-01-22 15:10:04Z] 
[INFO] 
Preparing to assign (36/46): [Preview]: Azure Key Vault Managed HSM Keys should have more than the specified number of days before expiration
[2026-01-22 15:10:04Z] 
[INFO] 
Assigning policy '[Preview]: Azure Key Vault Managed HSM Keys should have more than the specified number of days before expiration' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:04Z] 
[SUCCESS] 
Found '[Preview]: Azure Key Vault Managed HSM Keys should have more than the specified number of days before expiration' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/ad27588c-0198-4c84-81ef-08efd0274653
[2026-01-22 15:10:04Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:04Z] 
[INFO] 
DEBUG: Defined parameter names: effect, minimumDaysBeforeExpiration
[2026-01-22 15:10:04Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:04Z] 
[INFO] 
DEBUG: Checking parameter 'minimumDaysBeforeExpiration' against policy definition
[2026-01-22 15:10:04Z] 
[INFO] 
DEBUG: Defined parameter names: effect, minimumDaysBeforeExpiration
[2026-01-22 15:10:04Z] 
[INFO] 
DEBUG: Added parameter 'minimumDaysBeforeExpiration' = '30' to cleaned params
[2026-01-22 15:10:04Z] 
[INFO] 
Dry-run: would create assignment with name PreviewAzureKeyVaultManagedHSMKeysshouldhavemorethant-1035226701 and params: 
Name                           Value
----                           -----
minimumDaysBeforeExpiration    30
effect                         Audit



[2026-01-22 15:10:04Z] 
[INFO] 
Preparing to assign (37/46): Certificates should be issued by one of the specified non-integrated certificate authorities
[2026-01-22 15:10:04Z] 
[INFO] 
Assigning policy 'Certificates should be issued by one of the specified non-integrated certificate authorities' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:04Z] 
[SUCCESS] 
Found 'Certificates should be issued by one of the specified non-integrated certificate authorities' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/d3e82b87-6673-410b-8501-1896b688b9a3
[2026-01-22 15:10:05Z] 
[INFO] 
DEBUG: Checking parameter 'caCommonNames' against policy definition
[2026-01-22 15:10:05Z] 
[INFO] 
DEBUG: Defined parameter names: caCommonNames, effect
[2026-01-22 15:10:05Z] 
[INFO] 
DEBUG: Added parameter 'caCommonNames' = 'ContosoCA FabrikamCA' to cleaned params
[2026-01-22 15:10:05Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:05Z] 
[INFO] 
DEBUG: Defined parameter names: caCommonNames, effect
[2026-01-22 15:10:05Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:05Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesshouldbeissuedbyoneofthespecifiednonintegr-165973907 and params: 
Name                           Value
----                           -----
caCommonNames                  {ContosoCA, FabrikamCA}
effect                         Audit



[2026-01-22 15:10:05Z] 
[INFO] 
Preparing to assign (38/46): Keys should not be active for longer than the specified number of days
[2026-01-22 15:10:05Z] 
[INFO] 
Assigning policy 'Keys should not be active for longer than the specified number of days' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:05Z] 
[SUCCESS] 
Found 'Keys should not be active for longer than the specified number of days' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/c26e4b24-cf98-4c67-b48b-5a25c4c69eb9
[2026-01-22 15:10:05Z] 
[INFO] 
DEBUG: Checking parameter 'maximumValidityInDays' against policy definition
[2026-01-22 15:10:05Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:10:05Z] 
[INFO] 
DEBUG: Added parameter 'maximumValidityInDays' = '365' to cleaned params
[2026-01-22 15:10:05Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:05Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:10:05Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:05Z] 
[INFO] 
Dry-run: would create assignment with name Keysshouldnotbeactiveforlongerthanthespecifiednumbero-1296256806 and params: 
Name                           Value
----                           -----
maximumValidityInDays          365
effect                         Audit



[2026-01-22 15:10:05Z] 
[INFO] 
Preparing to assign (39/46): Certificates using RSA cryptography should have the specified minimum key size
[2026-01-22 15:10:05Z] 
[INFO] 
Assigning policy 'Certificates using RSA cryptography should have the specified minimum key size' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:05Z] 
[SUCCESS] 
Found 'Certificates using RSA cryptography should have the specified minimum key size' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/cee51871-e572-4576-855c-047c820360f0
[2026-01-22 15:10:05Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:05Z] 
[INFO] 
DEBUG: Defined parameter names: minimumRSAKeySize, effect
[2026-01-22 15:10:05Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:10:05Z] 
[INFO] 
DEBUG: Checking parameter 'minimumRSAKeySize' against policy definition
[2026-01-22 15:10:05Z] 
[INFO] 
DEBUG: Defined parameter names: minimumRSAKeySize, effect
[2026-01-22 15:10:05Z] 
[INFO] 
DEBUG: Added parameter 'minimumRSAKeySize' = '2048' to cleaned params
[2026-01-22 15:10:05Z] 
[INFO] 
Dry-run: would create assignment with name CertificatesusingRSAcryptographyshouldhavethespecifie-2031578458 and params: 
Name                           Value
----                           -----
minimumRSAKeySize              2048
effect                         Deny



[2026-01-22 15:10:05Z] 
[INFO] 
Preparing to assign (40/46): Secrets should have the specified maximum validity period
[2026-01-22 15:10:05Z] 
[INFO] 
Assigning policy 'Secrets should have the specified maximum validity period' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:05Z] 
[SUCCESS] 
Found 'Secrets should have the specified maximum validity period' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/342e8053-e12e-4c44-be01-c3c2f318400f
[2026-01-22 15:10:06Z] 
[INFO] 
DEBUG: Checking parameter 'maximumValidityInDays' against policy definition
[2026-01-22 15:10:06Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:10:06Z] 
[INFO] 
DEBUG: Added parameter 'maximumValidityInDays' = '365' to cleaned params
[2026-01-22 15:10:06Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:06Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:10:06Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:10:06Z] 
[INFO] 
Dry-run: would create assignment with name Secretsshouldhavethespecifiedmaximumvalidityperiod-1663466362 and params: 
Name                           Value
----                           -----
maximumValidityInDays          365
effect                         Deny



[2026-01-22 15:10:06Z] 
[INFO] 
Preparing to assign (41/46): Deploy - Configure diagnostic settings to an Event Hub to be enabled on Azure Key Vault Managed HSM
[2026-01-22 15:10:06Z] 
[INFO] 
Assigning policy 'Deploy - Configure diagnostic settings to an Event Hub to be enabled on Azure Key Vault Managed HSM' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:06Z] 
[SUCCESS] 
Found 'Deploy - Configure diagnostic settings to an Event Hub to be enabled on Azure Key Vault Managed HSM' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/a6d2c800-5230-4a40-bff3-8268b4987d42
[2026-01-22 15:10:06Z] 
[INFO] 
DEBUG: Checking parameter 'eventHubLocation' against policy definition
[2026-01-22 15:10:06Z] 
[INFO] 
DEBUG: Defined parameter names: effect, profileName, eventHubRuleId, eventHubLocation, metricsEnabled, logsEnabled
[2026-01-22 15:10:06Z] 
[INFO] 
DEBUG: Added parameter 'eventHubLocation' = 'eastus' to cleaned params
[2026-01-22 15:10:06Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:06Z] 
[INFO] 
DEBUG: Defined parameter names: effect, profileName, eventHubRuleId, eventHubLocation, metricsEnabled, logsEnabled
[2026-01-22 15:10:06Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'DeployIfNotExists' to cleaned params
[2026-01-22 15:10:06Z] 
[INFO] 
DEBUG: Checking parameter 'eventHubRuleId' against policy definition
[2026-01-22 15:10:06Z] 
[INFO] 
DEBUG: Defined parameter names: effect, profileName, eventHubRuleId, eventHubLocation, metricsEnabled, logsEnabled
[2026-01-22 15:10:06Z] 
[INFO] 
DEBUG: Added parameter 'eventHubRuleId' = '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.EventHub/namespaces/eh-policy-test-3464/authorizationrules/RootManageSharedAccessKey' to cleaned params
[2026-01-22 15:10:06Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '' (Length: 0)
[2026-01-22 15:10:06Z] 
[WARN] 
Effect '' requires managed identity. Skipping assignment - provide -IdentityResourceId to enable.

[2026-01-22 15:10:06Z] 
[INFO] 
Preparing to assign (42/46): [Preview]: Azure Key Vault Managed HSM keys using elliptic curve cryptography should have the specified curve names
[2026-01-22 15:10:06Z] 
[INFO] 
Assigning policy '[Preview]: Azure Key Vault Managed HSM keys using elliptic curve cryptography should have the specified curve names' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:06Z] 
[SUCCESS] 
Found '[Preview]: Azure Key Vault Managed HSM keys using elliptic curve cryptography should have the specified curve names' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/e58fd0c1-feac-4d12-92db-0a7e9421f53e
[2026-01-22 15:10:07Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:07Z] 
[INFO] 
DEBUG: Defined parameter names: allowedECNames, effect
[2026-01-22 15:10:07Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:07Z] 
[INFO] 
DEBUG: Checking parameter 'allowedECNames' against policy definition
[2026-01-22 15:10:07Z] 
[INFO] 
DEBUG: Defined parameter names: allowedECNames, effect
[2026-01-22 15:10:07Z] 
[INFO] 
DEBUG: Added parameter 'allowedECNames' = 'P-256 P-256K P-384 P-521' to cleaned params
[2026-01-22 15:10:07Z] 
[INFO] 
Dry-run: would create assignment with name PreviewAzureKeyVaultManagedHSMkeysusingellipticcurvecr-518169623 and params: 
Name                           Value
----                           -----
allowedECNames                 {P-256, P-256K, P-384, P-521}
effect                         Audit



[2026-01-22 15:10:07Z] 
[INFO] 
Preparing to assign (43/46): Azure Key Vault Managed HSM should have purge protection enabled
[2026-01-22 15:10:07Z] 
[INFO] 
Assigning policy 'Azure Key Vault Managed HSM should have purge protection enabled' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:07Z] 
[SUCCESS] 
Found 'Azure Key Vault Managed HSM should have purge protection enabled' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/c39ba22d-4428-4149-b981-70acb31fc383
[2026-01-22 15:10:07Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:07Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:10:07Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:10:07Z] 
[INFO] 
Dry-run: would create assignment with name AzureKeyVaultManagedHSMshouldhavepurgeprotectionenabl-1494992807 and params: 
Name                           Value
----                           -----
effect                         Deny



[2026-01-22 15:10:07Z] 
[INFO] 
Preparing to assign (44/46): [Preview]: Configure Azure Key Vault Managed HSM to disable public network access
[2026-01-22 15:10:07Z] 
[INFO] 
Assigning policy '[Preview]: Configure Azure Key Vault Managed HSM to disable public network access' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:07Z] 
[SUCCESS] 
Found '[Preview]: Configure Azure Key Vault Managed HSM to disable public network access' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/84d327c3-164a-4685-b453-900478614456
[2026-01-22 15:10:07Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:07Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:10:07Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Modify' to cleaned params
[2026-01-22 15:10:07Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '' (Length: 0)
[2026-01-22 15:10:07Z] 
[WARN] 
Effect '' requires managed identity. Skipping assignment - provide -IdentityResourceId to enable.

[2026-01-22 15:10:07Z] 
[INFO] 
Preparing to assign (45/46): [Preview]: Configure Azure Key Vault Managed HSM with private endpoints
[2026-01-22 15:10:07Z] 
[INFO] 
Assigning policy '[Preview]: Configure Azure Key Vault Managed HSM with private endpoints' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:07Z] 
[SUCCESS] 
Found '[Preview]: Configure Azure Key Vault Managed HSM with private endpoints' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/d1d6d8bb-cc7c-420f-8c7d-6f6f5279a844
[2026-01-22 15:10:08Z] 
[INFO] 
DEBUG: Checking parameter 'privateEndpointSubnetId' against policy definition
[2026-01-22 15:10:08Z] 
[INFO] 
DEBUG: Defined parameter names: privateEndpointSubnetId, effect
[2026-01-22 15:10:08Z] 
[INFO] 
DEBUG: Added parameter 'privateEndpointSubnetId' = '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-keyvault-test/providers/Microsoft.Network/virtualNetworks/vnet-policy-test/subnets/subnet-keyvault' to cleaned params
[2026-01-22 15:10:08Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:08Z] 
[INFO] 
DEBUG: Defined parameter names: privateEndpointSubnetId, effect
[2026-01-22 15:10:08Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'DeployIfNotExists' to cleaned params
[2026-01-22 15:10:08Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '' (Length: 0)
[2026-01-22 15:10:08Z] 
[WARN] 
Effect '' requires managed identity. Skipping assignment - provide -IdentityResourceId to enable.

[2026-01-22 15:10:08Z] 
[INFO] 
Preparing to assign (46/46): Keys should have more than the specified number of days before expiration
[2026-01-22 15:10:08Z] 
[INFO] 
Assigning policy 'Keys should have more than the specified number of days before expiration' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:08Z] 
[SUCCESS] 
Found 'Keys should have more than the specified number of days before expiration' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/5ff38825-c5d8-47c5-b70e-069a21955146
[2026-01-22 15:10:08Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:08Z] 
[INFO] 
DEBUG: Defined parameter names: minimumDaysBeforeExpiration, effect
[2026-01-22 15:10:08Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:08Z] 
[INFO] 
DEBUG: Checking parameter 'minimumDaysBeforeExpiration' against policy definition
[2026-01-22 15:10:08Z] 
[INFO] 
DEBUG: Defined parameter names: minimumDaysBeforeExpiration, effect
[2026-01-22 15:10:08Z] 
[INFO] 
DEBUG: Added parameter 'minimumDaysBeforeExpiration' = '90' to cleaned params
[2026-01-22 15:10:08Z] 
[INFO] 
Dry-run: would create assignment with name Keysshouldhavemorethanthespecifiednumberofdaysbeforeexp-12464927 and params: 
Name                           Value
----                           -----
minimumDaysBeforeExpiration    90
effect                         Audit


[2026-01-22 15:10:08Z] 
[INFO] 
Collected 0 assignment IDs for filtering
[2026-01-22 15:10:08Z] 
[INFO] 
Wrote reports: KeyVaultPolicyImplementationReport-20260122-151008.md, KeyVaultPolicyImplementationReport-20260122-151008.json, KeyVaultPolicyImplementationReport-20260122-151008.csv
[2026-01-22 15:10:08Z] 
[SUCCESS] 
HTML report generated: ./PolicyImplementationReport-20260122-151008.html
Dry-run summary written to ./DryRunSummary.txt

[2026-01-22 15:10:08Z] 
[INFO] 
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-01-22 15:10:08Z] 
[INFO] 
                    ğŸ“‹ NEXT STEPS GUIDANCE
[2026-01-22 15:10:08Z] 
[INFO] 
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ¯ Dry-Run Validation Complete

âœ… What was validated:
  â†’ Policy definitions resolved from mapping file
  â†’ Parameter overrides validated against policy schemas
  â†’ Assignment names generated (64-char limit enforced)
  â†’ No actual Azure resources created or modified

ğŸ“‹ Recommended Next Steps:
  1. ğŸ“„ Review dry-run summary:
     
notepad ./DryRunSummary.txt
  2. âœ… Verify all policies resolved successfully (Status: DryRun)
  3. ğŸ” Check for policies requiring managed identity (DeployIfNotExists/Modify effects)
  4. ğŸ“Š Review parameter values match your requirements
  5. ğŸš€ Deploy to test environment when ready:
     
.\\AzPolicyImplScript.ps1 -ParameterFile <YOUR_PARAM_FILE> -SkipRBACCheck

âš ï¸  Common Issues to Check:
  â†’ Policies with Status='Skipped' require -IdentityResourceId parameter
  â†’ Verify parameter values don't exceed policy min/max constraints
  â†’ Check for typos in policy display names (lookup failures)

ğŸ“š Documentation:
  â†’ Parameter File Guide: PolicyParameters-QuickReference.md
  â†’ Deployment Workflow: DEPLOYMENT-WORKFLOW-GUIDE.md


ğŸ“‹ Dry-Run Summary: 
./DryRunSummary.txt


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-01-22 15:10:08Z] 
[SUCCESS] 
Completed run. Reports generated.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“„ Reports Generated:
  â€¢ HTML:     
./PolicyImplementationReport-20260122-151008.html
  â€¢ Markdown: 
KeyVaultPolicyImplementationReport-20260122-151008.md
  â€¢ JSON:     
KeyVaultPolicyImplementationReport-20260122-151008.json


[2026-01-22 15:10:08Z] 
[INFO] 
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-01-22 15:10:08Z] 
[INFO] 
                    ğŸ“‹ NEXT STEPS GUIDANCE
[2026-01-22 15:10:08Z] 
[INFO] 
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ¯ Production Deployment Complete (46 Policies - Audit Mode)

âœ… What was deployed:
  â†’ All 46 Azure Key Vault governance policies in AUDIT mode
  â†’ Production environment: Monitoring compliance without blocking operations
  â†’ Zero operational impact: Existing resources unaffected

âš ï¸  IMPORTANT: Audit Phase Best Practices
  â†’ Recommended monitoring period: 30-90 days before moving to Deny mode
  â†’ Weekly compliance reviews recommended
  â†’ Stakeholder communication: Notify teams of upcoming Deny enforcement

ğŸ“‹ Recommended Next Steps:
  1. â³ Wait 30-60 minutes for Azure Policy evaluation cycle
  2. ğŸ“Š Generate weekly compliance reports:
     
.\\AzPolicyImplScript.ps1 -CheckCompliance -TriggerScan
  3. ğŸ“§ Configure email alerts for non-compliance:
     See: EMAIL-ALERT-CONFIGURATION.md
  4. âœ… Remediate non-compliant resources using HTML report guidance
  5. ğŸš¨ After 30-90 days, upgrade to Deny mode:
     
.\\AzPolicyImplScript.ps1 -ParameterFile .\\PolicyParameters-Production.json
     (Update effect parameters to 'Deny' in JSON file first)

ğŸ“š Critical Documentation:
  â†’ Pre-Deployment Checklist: PRE-DEPLOYMENT-CHECKLIST.md
  â†’ Email Alert Setup: EMAIL-ALERT-CONFIGURATION.md
  â†’ Deployment Prerequisites: DEPLOYMENT-PREREQUISITES.md

[2026-01-22 15:10:08] [SUCCESS]   âœ… Command executed successfully
[2026-01-22 15:10:08] [INFO]   Output saved to: .\scenario-4-output-20260122-150952.txt
[2026-01-22 15:10:08] [ERROR]   âŒ Console next steps validation failed for Production Audit (46 Policies)
[2026-01-22 15:10:08] [ERROR]     - Missing 'NEXT STEPS GUIDANCE' banner
[2026-01-22 15:10:08] [ERROR]     - Missing Production Audit deployment banner
[2026-01-22 15:10:08] [ERROR]     - Missing 30-90 day monitoring recommendation
[2026-01-22 15:10:08] [SUCCESS]   âœ… HTML report validated for Production Audit (46 Policies)
[2026-01-22 15:10:08] [SUCCESS]   âœ… No unexpected warnings/errors for Production Audit (46 Policies)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-01-22 15:10:10] [INFO] SCENARIO 5: Production Deny (46 Policies - Maximum Enforcement)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-01-22 15:10:10] [INFO] Executing: .\AzPolicyImplScript.ps1 -ParameterFile .\PolicyParameters-Production-Deny.json -SkipRBACCheck -Preview

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  Azure Policy Implementation - Key Vault Governance          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[2026-01-22 15:10:10Z] 
[INFO] 
Starting Azure Policy implementation script for Key Vault policies
[2026-01-22 15:10:10Z] 
[INFO] 
Checking required PowerShell modules...
[2026-01-22 15:10:10Z] 
[SUCCESS] 
Module Az.Accounts is present
[2026-01-22 15:10:10Z] 
[SUCCESS] 
Module Az.Resources is present
[2026-01-22 15:10:11Z] 
[SUCCESS] 
Module Az.PolicyInsights is present
[2026-01-22 15:10:11Z] 
[SUCCESS] 
Module Az.Monitor is present
[2026-01-22 15:10:11Z] 
[SUCCESS] 
Module Az.KeyVault is present
[2026-01-22 15:10:11Z] 
[INFO] 
Using Azure context: theregniers@hotmail.com
[2026-01-22 15:10:11Z] 
[INFO] 
Loading policy mapping from ./PolicyNameMapping.json
[2026-01-22 15:10:11Z] 
[INFO] 
Loaded 3745 policy mappings
[2026-01-22 15:10:11Z] 
[INFO] 
Loading policy parameter overrides from .\PolicyParameters-Production-Deny.json
[2026-01-22 15:10:11Z] 
[INFO] 
Detected deployment type: Custom (from parameter file: PolicyParameters-Production-Deny.json)
[2026-01-22 15:10:11Z] 
[INFO] 
Preview mode enabled: setting DryRun and skipping RBAC checks.
[2026-01-22 15:10:11Z] 
[INFO] 
DEBUG: PSBoundParameters keys: CsvPath, ParameterOverridesPath, SkipRBACCheck, Preview
[2026-01-22 15:10:11Z] 
[INFO] 
DEBUG: ScopeType value: ''
[2026-01-22 15:10:11Z] 
[INFO] 
Dry-run mode: using Subscription scope by default
[2026-01-22 15:10:11Z] 
[INFO] 
Checking current subscription context.
[2026-01-22 15:10:11Z] 
[INFO] 
Current subscription: MSDN Platforms Subscription (ab1336c7-687d-4107-b0f6-9649a0458adb)
[2026-01-22 15:10:11Z] 
[INFO] 
Dry-run mode: using current subscription context
[2026-01-22 15:10:11Z] 
[INFO] 
Preview mode: skipped RBAC permission check.
[2026-01-22 15:10:11Z] 
[INFO] 
Using policy effects from parameter file: .\PolicyParameters-Production-Deny.json

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  â„¹ï¸  Production Configuration Detected (Audit Mode)            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  Using production parameters in Audit mode (recommended first step)
  No resources will be blocked during this deployment

[2026-01-22 15:10:11Z] 
[SUCCESS] 
Loaded 46 policies from parameter file: .\PolicyParameters-Production-Deny.json

Processing 46 policies...
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

[2026-01-22 15:10:11Z] 
[INFO] 
Preparing to assign (1/46): Certificates using elliptic curve cryptography should have allowed curve names
[2026-01-22 15:10:11Z] 
[INFO] 
Assigning policy 'Certificates using elliptic curve cryptography should have allowed curve names' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:11Z] 
[SUCCESS] 
Found 'Certificates using elliptic curve cryptography should have allowed curve names' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/bd78111f-4953-4367-9fd5-7e08808b54bf
[2026-01-22 15:10:11Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:11Z] 
[INFO] 
DEBUG: Defined parameter names: allowedECNames, effect
[2026-01-22 15:10:11Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:10:11Z] 
[INFO] 
DEBUG: Checking parameter 'allowedECNames' against policy definition
[2026-01-22 15:10:11Z] 
[INFO] 
DEBUG: Defined parameter names: allowedECNames, effect
[2026-01-22 15:10:11Z] 
[INFO] 
DEBUG: Added parameter 'allowedECNames' = 'P-256 P-256K P-384 P-521' to cleaned params
[2026-01-22 15:10:11Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesusingellipticcurvecryptographyshouldhavea-1468057639 and params: 
Name                           Value
----                           -----
allowedECNames                 {P-256, P-256K, P-384, P-521}
effect                         Deny



[2026-01-22 15:10:11Z] 
[INFO] 
Preparing to assign (2/46): Configure key vaults to enable firewall
[2026-01-22 15:10:11Z] 
[INFO] 
Assigning policy 'Configure key vaults to enable firewall' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:11Z] 
[SUCCESS] 
Found 'Configure key vaults to enable firewall' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/ac673a9a-f77d-4846-b2d8-a57f8e1c01dc
[2026-01-22 15:10:11Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:11Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:10:11Z] 
[WARN] 
Parameter 'effect' value 'Deny' not in allowed values [Modify, Disabled]. Skipping to avoid PolicyParameterValueNotAllowed error.
[2026-01-22 15:10:11Z] 
[WARN] 
Effect 'Audit' not supported by policy 'Configure key vaults to enable firewall'. Allowed: Modify, Disabled. Using policy default.
[2026-01-22 15:10:11Z] 
[INFO] 
Detected policy default effect 'Modify' requires managed identity
[2026-01-22 15:10:11Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '' (Length: 0)
[2026-01-22 15:10:11Z] 
[WARN] 
Policy default effect 'Modify' requires managed identity. Skipping assignment - provide -IdentityResourceId to enable.

[2026-01-22 15:10:11Z] 
[INFO] 
Preparing to assign (3/46): Azure Key Vault should use RBAC permission model
[2026-01-22 15:10:11Z] 
[INFO] 
Assigning policy 'Azure Key Vault should use RBAC permission model' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:11Z] 
[SUCCESS] 
Found 'Azure Key Vault should use RBAC permission model' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/12d4fa5e-1f9f-4c21-97a9-b99b3c6611b5
[2026-01-22 15:10:12Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:12Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:10:12Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:10:12Z] 
[INFO] 
Dry-run: would create assignment with name AzureKeyVaultshoulduseRBACpermissionmodel-307198231 and params: 
Name                           Value
----                           -----
effect                         Deny



[2026-01-22 15:10:12Z] 
[INFO] 
Preparing to assign (4/46): Keys should be the specified cryptographic type RSA or EC
[2026-01-22 15:10:12Z] 
[INFO] 
Assigning policy 'Keys should be the specified cryptographic type RSA or EC' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:12Z] 
[SUCCESS] 
Found 'Keys should be the specified cryptographic type RSA or EC' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/75c4f823-d65c-4f29-a733-01d0077fdbcb
[2026-01-22 15:10:12Z] 
[INFO] 
DEBUG: Checking parameter 'cryptographicType' against policy definition
[2026-01-22 15:10:12Z] 
[INFO] 
DEBUG: Defined parameter names: allowedKeyTypes, effect
[2026-01-22 15:10:12Z] 
[WARN] 
DEBUG: Parameter 'cryptographicType' NOT FOUND in policy definition - SKIPPED
[2026-01-22 15:10:12Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:12Z] 
[INFO] 
DEBUG: Defined parameter names: allowedKeyTypes, effect
[2026-01-22 15:10:12Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:10:12Z] 
[WARN] 
Parameter 'cryptographicType' not defined in policy. Skipping to avoid UndefinedPolicyParameter error.
[2026-01-22 15:10:12Z] 
[INFO] 
Dry-run: would create assignment with name KeysshouldbethespecifiedcryptographictypeRSAorEC-976981238 and params: 
Name                           Value
----                           -----
effect                         Deny



[2026-01-22 15:10:12Z] 
[INFO] 
Preparing to assign (5/46): Keys using elliptic curve cryptography should have the specified curve names
[2026-01-22 15:10:12Z] 
[INFO] 
Assigning policy 'Keys using elliptic curve cryptography should have the specified curve names' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:12Z] 
[SUCCESS] 
Found 'Keys using elliptic curve cryptography should have the specified curve names' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/ff25f3c8-b739-4538-9d07-3d6d25cfb255
[2026-01-22 15:10:12Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:12Z] 
[INFO] 
DEBUG: Defined parameter names: allowedECNames, effect
[2026-01-22 15:10:12Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:10:12Z] 
[INFO] 
DEBUG: Checking parameter 'allowedECNames' against policy definition
[2026-01-22 15:10:12Z] 
[INFO] 
DEBUG: Defined parameter names: allowedECNames, effect
[2026-01-22 15:10:12Z] 
[INFO] 
DEBUG: Added parameter 'allowedECNames' = 'P-256 P-256K P-384 P-521' to cleaned params
[2026-01-22 15:10:12Z] 
[INFO] 
Dry-run: would create assignment with name Keysusingellipticcurvecryptographyshouldhavethespecif-1437325202 and params: 
Name                           Value
----                           -----
allowedECNames                 {P-256, P-256K, P-384, P-521}
effect                         Deny



[2026-01-22 15:10:12Z] 
[INFO] 
Preparing to assign (6/46): Deploy Diagnostic Settings for Key Vault to Event Hub
[2026-01-22 15:10:12Z] 
[INFO] 
Assigning policy 'Deploy Diagnostic Settings for Key Vault to Event Hub' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:12Z] 
[SUCCESS] 
Found 'Deploy Diagnostic Settings for Key Vault to Event Hub' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/ed7c8c13-51e7-49d1-8a43-8490431a0da2
[2026-01-22 15:10:13Z] 
[INFO] 
DEBUG: Checking parameter 'eventHubLocation' against policy definition
[2026-01-22 15:10:13Z] 
[INFO] 
DEBUG: Defined parameter names: effect, profileName, eventHubRuleId, eventHubLocation, metricsEnabled, logsEnabled
[2026-01-22 15:10:13Z] 
[INFO] 
DEBUG: Added parameter 'eventHubLocation' = 'eastus' to cleaned params
[2026-01-22 15:10:13Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:13Z] 
[INFO] 
DEBUG: Defined parameter names: effect, profileName, eventHubRuleId, eventHubLocation, metricsEnabled, logsEnabled
[2026-01-22 15:10:13Z] 
[INFO] 
DEBUG: Checking parameter 'eventHubRuleId' against policy definition
[2026-01-22 15:10:13Z] 
[INFO] 
DEBUG: Defined parameter names: effect, profileName, eventHubRuleId, eventHubLocation, metricsEnabled, logsEnabled
[2026-01-22 15:10:13Z] 
[INFO] 
DEBUG: Added parameter 'eventHubRuleId' = '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.EventHub/namespaces/eh-policy-test-3464/authorizationrules/RootManageSharedAccessKey' to cleaned params
[2026-01-22 15:10:13Z] 
[WARN] 
Parameter 'effect' value 'Deny' not in allowed values [DeployIfNotExists, Disabled]. Skipping to avoid PolicyParameterValueNotAllowed error.
[2026-01-22 15:10:13Z] 
[WARN] 
Effect 'Audit' not supported by policy 'Deploy Diagnostic Settings for Key Vault to Event Hub'. Allowed: DeployIfNotExists, Disabled. Using policy default.
[2026-01-22 15:10:13Z] 
[INFO] 
Detected policy default effect 'DeployIfNotExists' requires managed identity
[2026-01-22 15:10:13Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '' (Length: 0)
[2026-01-22 15:10:13Z] 
[WARN] 
Policy default effect 'DeployIfNotExists' requires managed identity. Skipping assignment - provide -IdentityResourceId to enable.

[2026-01-22 15:10:13Z] 
[INFO] 
Preparing to assign (7/46): Keys using RSA cryptography should have a specified minimum key size
[2026-01-22 15:10:13Z] 
[INFO] 
Assigning policy 'Keys using RSA cryptography should have a specified minimum key size' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:13Z] 
[SUCCESS] 
Found 'Keys using RSA cryptography should have a specified minimum key size' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/82067dbb-e53b-4e06-b631-546d197452d9
[2026-01-22 15:10:13Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:13Z] 
[INFO] 
DEBUG: Defined parameter names: minimumRSAKeySize, effect
[2026-01-22 15:10:13Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:10:13Z] 
[INFO] 
DEBUG: Checking parameter 'minimumRSAKeySize' against policy definition
[2026-01-22 15:10:13Z] 
[INFO] 
DEBUG: Defined parameter names: minimumRSAKeySize, effect
[2026-01-22 15:10:13Z] 
[INFO] 
DEBUG: Added parameter 'minimumRSAKeySize' = '4096' to cleaned params
[2026-01-22 15:10:13Z] 
[INFO] 
Dry-run: would create assignment with name KeysusingRSAcryptographyshouldhaveaspecifiedminimumkey-909744685 and params: 
Name                           Value
----                           -----
minimumRSAKeySize              4096
effect                         Deny



[2026-01-22 15:10:13Z] 
[INFO] 
Preparing to assign (8/46): Deploy - Configure diagnostic settings for Azure Key Vault to Log Analytics workspace
[2026-01-22 15:10:13Z] 
[INFO] 
Assigning policy 'Deploy - Configure diagnostic settings for Azure Key Vault to Log Analytics workspace' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:13Z] 
[SUCCESS] 
Found 'Deploy - Configure diagnostic settings for Azure Key Vault to Log Analytics workspace' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/951af2fa-529b-416e-ab6e-066fd85ac459
[2026-01-22 15:10:13Z] 
[INFO] 
DEBUG: Checking parameter 'logAnalytics' against policy definition
[2026-01-22 15:10:13Z] 
[INFO] 
DEBUG: Defined parameter names: effect, diagnosticsSettingNameToUse, logAnalytics, AuditEventEnabled, AllMetricsEnabled
[2026-01-22 15:10:13Z] 
[INFO] 
DEBUG: Added parameter 'logAnalytics' = '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.OperationalInsights/workspaces/law-policy-test-6874' to cleaned params
[2026-01-22 15:10:13Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:13Z] 
[INFO] 
DEBUG: Defined parameter names: effect, diagnosticsSettingNameToUse, logAnalytics, AuditEventEnabled, AllMetricsEnabled
[2026-01-22 15:10:13Z] 
[WARN] 
Parameter 'effect' value 'Deny' not in allowed values [DeployIfNotExists, Disabled]. Skipping to avoid PolicyParameterValueNotAllowed error.
[2026-01-22 15:10:13Z] 
[WARN] 
Effect 'Audit' not supported by policy 'Deploy - Configure diagnostic settings for Azure Key Vault to Log Analytics workspace'. Allowed: DeployIfNotExists, Disabled. Using policy default.
[2026-01-22 15:10:13Z] 
[INFO] 
Detected policy default effect 'DeployIfNotExists' requires managed identity
[2026-01-22 15:10:13Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '' (Length: 0)
[2026-01-22 15:10:13Z] 
[WARN] 
Policy default effect 'DeployIfNotExists' requires managed identity. Skipping assignment - provide -IdentityResourceId to enable.

[2026-01-22 15:10:13Z] 
[INFO] 
Preparing to assign (9/46): [Preview]: Azure Key Vault Managed HSM keys using RSA cryptography should have a specified minimum key size
[2026-01-22 15:10:13Z] 
[INFO] 
Assigning policy '[Preview]: Azure Key Vault Managed HSM keys using RSA cryptography should have a specified minimum key size' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:13Z] 
[SUCCESS] 
Found '[Preview]: Azure Key Vault Managed HSM keys using RSA cryptography should have a specified minimum key size' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/86810a98-8e91-4a44-8386-ec66d0de5d57
[2026-01-22 15:10:14Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:14Z] 
[INFO] 
DEBUG: Defined parameter names: effect, minimumRSAKeySize
[2026-01-22 15:10:14Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:10:14Z] 
[INFO] 
DEBUG: Checking parameter 'minimumRSAKeySize' against policy definition
[2026-01-22 15:10:14Z] 
[INFO] 
DEBUG: Defined parameter names: effect, minimumRSAKeySize
[2026-01-22 15:10:14Z] 
[INFO] 
DEBUG: Added parameter 'minimumRSAKeySize' = '4096' to cleaned params
[2026-01-22 15:10:14Z] 
[INFO] 
Dry-run: would create assignment with name PreviewAzureKeyVaultManagedHSMkeysusingRSAcryptography-998252524 and params: 
Name                           Value
----                           -----
minimumRSAKeySize              4096
effect                         Deny



[2026-01-22 15:10:14Z] 
[INFO] 
Preparing to assign (10/46): Certificates should be issued by the specified integrated certificate authority
[2026-01-22 15:10:14Z] 
[INFO] 
Assigning policy 'Certificates should be issued by the specified integrated certificate authority' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:14Z] 
[SUCCESS] 
Found 'Certificates should be issued by the specified integrated certificate authority' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/8e826246-c976-48f6-b03e-619bb92b3d82
[2026-01-22 15:10:14Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:14Z] 
[INFO] 
DEBUG: Defined parameter names: allowedCAs, effect
[2026-01-22 15:10:14Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:10:14Z] 
[INFO] 
DEBUG: Checking parameter 'allowedCAs' against policy definition
[2026-01-22 15:10:14Z] 
[INFO] 
DEBUG: Defined parameter names: allowedCAs, effect
[2026-01-22 15:10:14Z] 
[INFO] 
DEBUG: Added parameter 'allowedCAs' = 'DigiCert GlobalSign' to cleaned params
[2026-01-22 15:10:14Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesshouldbeissuedbythespecifiedintegratedcer-1190107367 and params: 
Name                           Value
----                           -----
allowedCAs                     {DigiCert, GlobalSign}
effect                         Deny



[2026-01-22 15:10:14Z] 
[INFO] 
Preparing to assign (11/46): Secrets should have more than the specified number of days before expiration
[2026-01-22 15:10:14Z] 
[INFO] 
Assigning policy 'Secrets should have more than the specified number of days before expiration' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:14Z] 
[SUCCESS] 
Found 'Secrets should have more than the specified number of days before expiration' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/b0eb591a-5e70-4534-a8bf-04b9c489584a
[2026-01-22 15:10:14Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:14Z] 
[INFO] 
DEBUG: Defined parameter names: minimumDaysBeforeExpiration, effect
[2026-01-22 15:10:14Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:10:15Z] 
[INFO] 
DEBUG: Checking parameter 'minimumDaysBeforeExpiration' against policy definition
[2026-01-22 15:10:15Z] 
[INFO] 
DEBUG: Defined parameter names: minimumDaysBeforeExpiration, effect
[2026-01-22 15:10:15Z] 
[INFO] 
DEBUG: Added parameter 'minimumDaysBeforeExpiration' = '90' to cleaned params
[2026-01-22 15:10:15Z] 
[INFO] 
Dry-run: would create assignment with name Secretsshouldhavemorethanthespecifiednumberofdaysbefo-1193127515 and params: 
Name                           Value
----                           -----
minimumDaysBeforeExpiration    90
effect                         Deny



[2026-01-22 15:10:15Z] 
[INFO] 
Preparing to assign (12/46): Configure Azure Key Vaults to use private DNS zones
[2026-01-22 15:10:15Z] 
[INFO] 
Assigning policy 'Configure Azure Key Vaults to use private DNS zones' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:15Z] 
[SUCCESS] 
Found 'Configure Azure Key Vaults to use private DNS zones' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/ac673a9a-f77d-4846-b2d8-a57f8e1c01d4
[2026-01-22 15:10:15Z] 
[INFO] 
DEBUG: Checking parameter 'privateDnsZoneId' against policy definition
[2026-01-22 15:10:15Z] 
[INFO] 
DEBUG: Defined parameter names: privateDnsZoneId, effect
[2026-01-22 15:10:15Z] 
[INFO] 
DEBUG: Added parameter 'privateDnsZoneId' = '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.Network/privateDnsZones/privatelink.vaultcore.azure.net' to cleaned params
[2026-01-22 15:10:15Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:15Z] 
[INFO] 
DEBUG: Defined parameter names: privateDnsZoneId, effect
[2026-01-22 15:10:15Z] 
[WARN] 
Parameter 'effect' value 'Deny' not in allowed values [DeployIfNotExists, Disabled]. Skipping to avoid PolicyParameterValueNotAllowed error.
[2026-01-22 15:10:15Z] 
[WARN] 
Effect 'Audit' not supported by policy 'Configure Azure Key Vaults to use private DNS zones'. Allowed: DeployIfNotExists, Disabled. Using policy default.
[2026-01-22 15:10:15Z] 
[INFO] 
Detected policy default effect 'DeployIfNotExists' requires managed identity
[2026-01-22 15:10:15Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '' (Length: 0)
[2026-01-22 15:10:15Z] 
[WARN] 
Policy default effect 'DeployIfNotExists' requires managed identity. Skipping assignment - provide -IdentityResourceId to enable.

[2026-01-22 15:10:15Z] 
[INFO] 
Preparing to assign (13/46): [Preview]: Azure Key Vault Managed HSM keys should have an expiration date
[2026-01-22 15:10:15Z] 
[INFO] 
Assigning policy '[Preview]: Azure Key Vault Managed HSM keys should have an expiration date' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:15Z] 
[SUCCESS] 
Found '[Preview]: Azure Key Vault Managed HSM keys should have an expiration date' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/1d478a74-21ba-4b9f-9d8f-8e6fced0eec5
[2026-01-22 15:10:15Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:15Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:10:15Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:10:15Z] 
[INFO] 
Dry-run: would create assignment with name PreviewAzureKeyVaultManagedHSMkeysshouldhaveanexpirati-976371970 and params: 
Name                           Value
----                           -----
effect                         Deny



[2026-01-22 15:10:15Z] 
[INFO] 
Preparing to assign (14/46): Configure Azure Key Vaults with private endpoints
[2026-01-22 15:10:15Z] 
[INFO] 
Assigning policy 'Configure Azure Key Vaults with private endpoints' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:15Z] 
[SUCCESS] 
Found 'Configure Azure Key Vaults with private endpoints' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/9d4fad1f-5189-4a42-b29e-cf7929c6b6df
[2026-01-22 15:10:16Z] 
[INFO] 
DEBUG: Checking parameter 'privateEndpointSubnetId' against policy definition
[2026-01-22 15:10:16Z] 
[INFO] 
DEBUG: Defined parameter names: privateEndpointSubnetId, effect
[2026-01-22 15:10:16Z] 
[INFO] 
DEBUG: Added parameter 'privateEndpointSubnetId' = '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-keyvault-test/providers/Microsoft.Network/virtualNetworks/vnet-policy-test/subnets/subnet-keyvault' to cleaned params
[2026-01-22 15:10:16Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:16Z] 
[INFO] 
DEBUG: Defined parameter names: privateEndpointSubnetId, effect
[2026-01-22 15:10:16Z] 
[WARN] 
Parameter 'effect' value 'Deny' not in allowed values [DeployIfNotExists, Disabled]. Skipping to avoid PolicyParameterValueNotAllowed error.
[2026-01-22 15:10:16Z] 
[WARN] 
Effect 'Audit' not supported by policy 'Configure Azure Key Vaults with private endpoints'. Allowed: DeployIfNotExists, Disabled. Using policy default.
[2026-01-22 15:10:16Z] 
[INFO] 
Detected policy default effect 'DeployIfNotExists' requires managed identity
[2026-01-22 15:10:16Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '' (Length: 0)
[2026-01-22 15:10:16Z] 
[WARN] 
Policy default effect 'DeployIfNotExists' requires managed identity. Skipping assignment - provide -IdentityResourceId to enable.

[2026-01-22 15:10:16Z] 
[INFO] 
Preparing to assign (15/46): Key vaults should have soft delete enabled
[2026-01-22 15:10:16Z] 
[INFO] 
Assigning policy 'Key vaults should have soft delete enabled' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:16Z] 
[SUCCESS] 
Found 'Key vaults should have soft delete enabled' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/1e66c121-a66a-4b1f-9b83-0fd99bf0fc2d
[2026-01-22 15:10:16Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:16Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:10:16Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:10:16Z] 
[INFO] 
Dry-run: would create assignment with name Keyvaultsshouldhavesoftdeleteenabled-656701378 and params: 
Name                           Value
----                           -----
effect                         Deny



[2026-01-22 15:10:17Z] 
[INFO] 
Preparing to assign (16/46): Certificates should use allowed key types
[2026-01-22 15:10:17Z] 
[INFO] 
Assigning policy 'Certificates should use allowed key types' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:17Z] 
[SUCCESS] 
Found 'Certificates should use allowed key types' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/1151cede-290b-4ba0-8b38-0ad145ac888f
[2026-01-22 15:10:17Z] 
[INFO] 
DEBUG: Checking parameter 'allowedKeyTypes' against policy definition
[2026-01-22 15:10:17Z] 
[INFO] 
DEBUG: Defined parameter names: allowedKeyTypes, effect
[2026-01-22 15:10:17Z] 
[INFO] 
DEBUG: Added parameter 'allowedKeyTypes' = 'RSA EC' to cleaned params
[2026-01-22 15:10:17Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:17Z] 
[INFO] 
DEBUG: Defined parameter names: allowedKeyTypes, effect
[2026-01-22 15:10:17Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:10:17Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesshoulduseallowedkeytypes-246707145 and params: 
Name                           Value
----                           -----
allowedKeyTypes                {RSA, EC}
effect                         Deny



[2026-01-22 15:10:17Z] 
[INFO] 
Preparing to assign (17/46): Resource logs in Key Vault should be enabled
[2026-01-22 15:10:17Z] 
[INFO] 
Assigning policy 'Resource logs in Key Vault should be enabled' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:17Z] 
[SUCCESS] 
Found 'Resource logs in Key Vault should be enabled' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21
[2026-01-22 15:10:17Z] 
[INFO] 
DEBUG: Checking parameter 'requiredRetentionDays' against policy definition
[2026-01-22 15:10:17Z] 
[INFO] 
DEBUG: Defined parameter names: effect, requiredRetentionDays
[2026-01-22 15:10:17Z] 
[INFO] 
DEBUG: Added parameter 'requiredRetentionDays' = '365' to cleaned params
[2026-01-22 15:10:17Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:17Z] 
[INFO] 
DEBUG: Defined parameter names: effect, requiredRetentionDays
[2026-01-22 15:10:17Z] 
[WARN] 
Parameter 'effect' value 'Deny' not in allowed values [AuditIfNotExists, Disabled]. Skipping to avoid PolicyParameterValueNotAllowed error.
[2026-01-22 15:10:17Z] 
[WARN] 
Effect 'Audit' not supported by policy 'Resource logs in Key Vault should be enabled'. Allowed: AuditIfNotExists, Disabled. Using policy default.
[2026-01-22 15:10:17Z] 
[INFO] 
Dry-run: would create assignment with name ResourcelogsinKeyVaultshouldbeenabled-1683835535 and params: 
Name                           Value
----                           -----
requiredRetentionDays          365



[2026-01-22 15:10:17Z] 
[INFO] 
Preparing to assign (18/46): Certificates should have the specified lifetime action triggers
[2026-01-22 15:10:17Z] 
[INFO] 
Assigning policy 'Certificates should have the specified lifetime action triggers' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:17Z] 
[SUCCESS] 
Found 'Certificates should have the specified lifetime action triggers' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/12ef42cb-9903-4e39-9c26-422d29570417
[2026-01-22 15:10:18Z] 
[INFO] 
DEBUG: Checking parameter 'maximumPercentageLife' against policy definition
[2026-01-22 15:10:18Z] 
[INFO] 
DEBUG: Defined parameter names: maximumPercentageLife, minimumDaysBeforeExpiry, effect
[2026-01-22 15:10:18Z] 
[INFO] 
DEBUG: Added parameter 'maximumPercentageLife' = '80' to cleaned params
[2026-01-22 15:10:18Z] 
[INFO] 
DEBUG: Checking parameter 'minimumDaysBeforeExpiry' against policy definition
[2026-01-22 15:10:18Z] 
[INFO] 
DEBUG: Defined parameter names: maximumPercentageLife, minimumDaysBeforeExpiry, effect
[2026-01-22 15:10:18Z] 
[INFO] 
DEBUG: Added parameter 'minimumDaysBeforeExpiry' = '90' to cleaned params
[2026-01-22 15:10:18Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:18Z] 
[INFO] 
DEBUG: Defined parameter names: maximumPercentageLife, minimumDaysBeforeExpiry, effect
[2026-01-22 15:10:18Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:10:18Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesshouldhavethespecifiedlifetimeactiontrigg-1761965968 and params: 
Name                           Value
----                           -----
maximumPercentageLife          80
minimumDaysBeforeExpiry        90
effect                         Deny



[2026-01-22 15:10:18Z] 
[INFO] 
Preparing to assign (19/46): Secrets should not be active for longer than the specified number of days
[2026-01-22 15:10:18Z] 
[INFO] 
Assigning policy 'Secrets should not be active for longer than the specified number of days' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:18Z] 
[SUCCESS] 
Found 'Secrets should not be active for longer than the specified number of days' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/e8d99835-8a06-45ae-a8e0-87a91941ccfe
[2026-01-22 15:10:18Z] 
[INFO] 
DEBUG: Checking parameter 'maximumValidityInDays' against policy definition
[2026-01-22 15:10:18Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:10:18Z] 
[INFO] 
DEBUG: Added parameter 'maximumValidityInDays' = '365' to cleaned params
[2026-01-22 15:10:18Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:18Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:10:18Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:10:18Z] 
[INFO] 
Dry-run: would create assignment with name Secretsshouldnotbeactiveforlongerthanthespecifiednumb-1452013840 and params: 
Name                           Value
----                           -----
maximumValidityInDays          365
effect                         Deny



[2026-01-22 15:10:18Z] 
[INFO] 
Preparing to assign (20/46): Certificates should be issued by the specified non-integrated certificate authority
[2026-01-22 15:10:18Z] 
[INFO] 
Assigning policy 'Certificates should be issued by the specified non-integrated certificate authority' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:18Z] 
[SUCCESS] 
Found 'Certificates should be issued by the specified non-integrated certificate authority' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/a22f4a40-01d3-4c7d-8071-da157eeff341
[2026-01-22 15:10:19Z] 
[INFO] 
DEBUG: Checking parameter 'caCommonName' against policy definition
[2026-01-22 15:10:19Z] 
[INFO] 
DEBUG: Defined parameter names: caCommonName, effect
[2026-01-22 15:10:19Z] 
[INFO] 
DEBUG: Added parameter 'caCommonName' = 'ContosoCA' to cleaned params
[2026-01-22 15:10:19Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:19Z] 
[INFO] 
DEBUG: Defined parameter names: caCommonName, effect
[2026-01-22 15:10:19Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:10:19Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesshouldbeissuedbythespecifiednonintegratedc-500792775 and params: 
Name                           Value
----                           -----
caCommonName                   ContosoCA
effect                         Deny



[2026-01-22 15:10:19Z] 
[INFO] 
Preparing to assign (21/46): Certificates should have the specified maximum validity period
[2026-01-22 15:10:19Z] 
[INFO] 
Assigning policy 'Certificates should have the specified maximum validity period' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:19Z] 
[SUCCESS] 
Found 'Certificates should have the specified maximum validity period' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/0a075868-4c26-42ef-914c-5bc007359560
[2026-01-22 15:10:19Z] 
[INFO] 
DEBUG: Checking parameter 'maximumValidityInMonths' against policy definition
[2026-01-22 15:10:19Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInMonths, effect
[2026-01-22 15:10:19Z] 
[INFO] 
DEBUG: Added parameter 'maximumValidityInMonths' = '12' to cleaned params
[2026-01-22 15:10:19Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:19Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInMonths, effect
[2026-01-22 15:10:19Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:10:19Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesshouldhavethespecifiedmaximumvalidityperio-407807336 and params: 
Name                           Value
----                           -----
maximumValidityInMonths        12
effect                         Deny



[2026-01-22 15:10:19Z] 
[INFO] 
Preparing to assign (22/46): Keys should have more than the specified number of days before expiration
[2026-01-22 15:10:19Z] 
[INFO] 
Assigning policy 'Keys should have more than the specified number of days before expiration' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:19Z] 
[SUCCESS] 
Found 'Keys should have more than the specified number of days before expiration' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/5ff38825-c5d8-47c5-b70e-069a21955146
[2026-01-22 15:10:19Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:19Z] 
[INFO] 
DEBUG: Defined parameter names: minimumDaysBeforeExpiration, effect
[2026-01-22 15:10:19Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:10:19Z] 
[INFO] 
DEBUG: Checking parameter 'minimumDaysBeforeExpiration' against policy definition
[2026-01-22 15:10:19Z] 
[INFO] 
DEBUG: Defined parameter names: minimumDaysBeforeExpiration, effect
[2026-01-22 15:10:19Z] 
[INFO] 
DEBUG: Added parameter 'minimumDaysBeforeExpiration' = '90' to cleaned params
[2026-01-22 15:10:19Z] 
[INFO] 
Dry-run: would create assignment with name Keysshouldhavemorethanthespecifiednumberofdaysbeforeexp-12464927 and params: 
Name                           Value
----                           -----
minimumDaysBeforeExpiration    90
effect                         Deny



[2026-01-22 15:10:19Z] 
[INFO] 
Preparing to assign (23/46): Resource logs in Azure Key Vault Managed HSM should be enabled
[2026-01-22 15:10:19Z] 
[INFO] 
Assigning policy 'Resource logs in Azure Key Vault Managed HSM should be enabled' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:19Z] 
[SUCCESS] 
Found 'Resource logs in Azure Key Vault Managed HSM should be enabled' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/a2a5b911-5617-447e-a49e-59dbe0e0434b
[2026-01-22 15:10:20Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:20Z] 
[INFO] 
DEBUG: Defined parameter names: effect, requiredRetentionDays
[2026-01-22 15:10:20Z] 
[WARN] 
Parameter 'effect' value 'Deny' not in allowed values [AuditIfNotExists, Disabled]. Skipping to avoid PolicyParameterValueNotAllowed error.
[2026-01-22 15:10:20Z] 
[WARN] 
Effect 'Audit' not supported by policy 'Resource logs in Azure Key Vault Managed HSM should be enabled'. Allowed: AuditIfNotExists, Disabled. Using policy default.
[2026-01-22 15:10:20Z] 
[INFO] 
Dry-run: would create assignment with name ResourcelogsinAzureKeyVaultManagedHSMshouldbeenabled-1874150632 and params: 

[2026-01-22 15:10:20Z] 
[INFO] 
Preparing to assign (24/46): Key Vault keys should have an expiration date
[2026-01-22 15:10:20Z] 
[INFO] 
Assigning policy 'Key Vault keys should have an expiration date' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:20Z] 
[SUCCESS] 
Found 'Key Vault keys should have an expiration date' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/152b15f7-8e1f-4c1f-ab71-8c010ba5dbc0
[2026-01-22 15:10:20Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:20Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:10:20Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:10:20Z] 
[INFO] 
Dry-run: would create assignment with name KeyVaultkeysshouldhaveanexpirationdate-386037801 and params: 
Name                           Value
----                           -----
effect                         Deny



[2026-01-22 15:10:20Z] 
[INFO] 
Preparing to assign (25/46): Keys should have a rotation policy ensuring that their rotation is scheduled within the specified number of days after creation.
[2026-01-22 15:10:20Z] 
[INFO] 
Assigning policy 'Keys should have a rotation policy ensuring that their rotation is scheduled within the specified number of days after creation.' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:20Z] 
[SUCCESS] 
Found 'Keys should have a rotation policy ensuring that their rotation is scheduled within the specified number of days after creation.' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/d8cf8476-a2ec-4916-896e-992351803c44
[2026-01-22 15:10:20Z] 
[INFO] 
DEBUG: Checking parameter 'maximumDaysToRotate' against policy definition
[2026-01-22 15:10:20Z] 
[INFO] 
DEBUG: Defined parameter names: maximumDaysToRotate, effect
[2026-01-22 15:10:20Z] 
[INFO] 
DEBUG: Added parameter 'maximumDaysToRotate' = '90' to cleaned params
[2026-01-22 15:10:20Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:20Z] 
[INFO] 
DEBUG: Defined parameter names: maximumDaysToRotate, effect
[2026-01-22 15:10:20Z] 
[WARN] 
Parameter 'effect' value 'Deny' not in allowed values [Audit, Disabled]. Skipping to avoid PolicyParameterValueNotAllowed error.
[2026-01-22 15:10:20Z] 
[INFO] 
Dry-run: would create assignment with name Keysshouldhavearotationpolicyensuringthattheirrotatio-1816322754 and params: 
Name                           Value
----                           -----
maximumDaysToRotate            90
effect                         Audit



[2026-01-22 15:10:20Z] 
[INFO] 
Preparing to assign (26/46): Certificates should not expire within the specified number of days
[2026-01-22 15:10:20Z] 
[INFO] 
Assigning policy 'Certificates should not expire within the specified number of days' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:20Z] 
[SUCCESS] 
Found 'Certificates should not expire within the specified number of days' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/f772fb64-8e40-40ad-87bc-7706e1949427
[2026-01-22 15:10:21Z] 
[INFO] 
DEBUG: Checking parameter 'daysToExpire' against policy definition
[2026-01-22 15:10:21Z] 
[INFO] 
DEBUG: Defined parameter names: daysToExpire, effect
[2026-01-22 15:10:21Z] 
[INFO] 
DEBUG: Added parameter 'daysToExpire' = '90' to cleaned params
[2026-01-22 15:10:21Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:21Z] 
[INFO] 
DEBUG: Defined parameter names: daysToExpire, effect
[2026-01-22 15:10:21Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:10:21Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesshouldnotexpirewithinthespecifiednumberof-2114192775 and params: 
Name                           Value
----                           -----
daysToExpire                   90
effect                         Deny



[2026-01-22 15:10:21Z] 
[INFO] 
Preparing to assign (27/46): Key vaults should have deletion protection enabled
[2026-01-22 15:10:21Z] 
[INFO] 
Assigning policy 'Key vaults should have deletion protection enabled' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:21Z] 
[SUCCESS] 
Found 'Key vaults should have deletion protection enabled' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/0b60c0b2-2dc2-4e1c-b5c9-abbed971de53
[2026-01-22 15:10:21Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:21Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:10:21Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:10:21Z] 
[INFO] 
Dry-run: would create assignment with name Keyvaultsshouldhavedeletionprotectionenabled-1439856846 and params: 
Name                           Value
----                           -----
effect                         Deny



[2026-01-22 15:10:21Z] 
[INFO] 
Preparing to assign (28/46): [Preview]: Azure Key Vault Managed HSM should disable public network access
[2026-01-22 15:10:21Z] 
[INFO] 
Assigning policy '[Preview]: Azure Key Vault Managed HSM should disable public network access' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:21Z] 
[SUCCESS] 
Found '[Preview]: Azure Key Vault Managed HSM should disable public network access' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/19ea9d63-adee-4431-a95e-1913c6c1c75f
[2026-01-22 15:10:21Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:21Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:10:21Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:10:21Z] 
[INFO] 
Dry-run: would create assignment with name PreviewAzureKeyVaultManagedHSMshoulddisablepublicnetwo-208646097 and params: 
Name                           Value
----                           -----
effect                         Deny



[2026-01-22 15:10:21Z] 
[INFO] 
Preparing to assign (29/46): Azure Key Vaults should use private link
[2026-01-22 15:10:21Z] 
[INFO] 
Assigning policy 'Azure Key Vaults should use private link' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:21Z] 
[SUCCESS] 
Found 'Azure Key Vaults should use private link' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/a6abeaec-4d90-4a02-805f-6b26c4d3fbe9
[2026-01-22 15:10:21Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:21Z] 
[INFO] 
DEBUG: Defined parameter names: audit_effect, effect
[2026-01-22 15:10:21Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:10:21Z] 
[INFO] 
Dry-run: would create assignment with name AzureKeyVaultsshoulduseprivatelink-2127082189 and params: 
Name                           Value
----                           -----
effect                         Deny



[2026-01-22 15:10:21Z] 
[INFO] 
Preparing to assign (30/46): Keys should be backed by a hardware security module (HSM)
[2026-01-22 15:10:21Z] 
[INFO] 
Assigning policy 'Keys should be backed by a hardware security module (HSM)' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:21Z] 
[SUCCESS] 
Found 'Keys should be backed by a hardware security module (HSM)' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/587c79fe-dd04-4a5e-9d0b-f89598c7261b
[2026-01-22 15:10:22Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:22Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:10:22Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:10:22Z] 
[INFO] 
Dry-run: would create assignment with name KeysshouldbebackedbyahardwaresecuritymoduleHSM-593124860 and params: 
Name                           Value
----                           -----
effect                         Deny



[2026-01-22 15:10:22Z] 
[INFO] 
Preparing to assign (31/46): Azure Key Vault should have firewall enabled or public network access disabled
[2026-01-22 15:10:22Z] 
[INFO] 
Assigning policy 'Azure Key Vault should have firewall enabled or public network access disabled' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:22Z] 
[SUCCESS] 
Found 'Azure Key Vault should have firewall enabled or public network access disabled' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/55615ac9-af46-4a59-874e-391cc3dfb490
[2026-01-22 15:10:22Z] 
[INFO] 
DEBUG: Checking parameter 'allowedIPAddresses' against policy definition
[2026-01-22 15:10:22Z] 
[INFO] 
DEBUG: Defined parameter names: effect, restrictIPAddresses, allowedIPAddresses, forbiddenIPAddresses
[2026-01-22 15:10:22Z] 
[INFO] 
DEBUG: Added parameter 'allowedIPAddresses' = '0.0.0.0/0' to cleaned params
[2026-01-22 15:10:22Z] 
[INFO] 
DEBUG: Checking parameter 'forbiddenIPAddresses' against policy definition
[2026-01-22 15:10:22Z] 
[INFO] 
DEBUG: Defined parameter names: effect, restrictIPAddresses, allowedIPAddresses, forbiddenIPAddresses
[2026-01-22 15:10:22Z] 
[INFO] 
DEBUG: Added parameter 'forbiddenIPAddresses' = '' to cleaned params
[2026-01-22 15:10:22Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:22Z] 
[INFO] 
DEBUG: Defined parameter names: effect, restrictIPAddresses, allowedIPAddresses, forbiddenIPAddresses
[2026-01-22 15:10:22Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:10:22Z] 
[INFO] 
Dry-run: would create assignment with name AzureKeyVaultshouldhavefirewallenabledorpublicnetwork-1396884516 and params: 
Name                           Value
----                           -----
allowedIPAddresses             {0.0.0.0/0}
forbiddenIPAddresses           {}
effect                         Deny



[2026-01-22 15:10:22Z] 
[INFO] 
Preparing to assign (32/46): Keys should have the specified maximum validity period
[2026-01-22 15:10:22Z] 
[INFO] 
Assigning policy 'Keys should have the specified maximum validity period' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:22Z] 
[SUCCESS] 
Found 'Keys should have the specified maximum validity period' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/49a22571-d204-4c91-a7b6-09b1a586fbc9
[2026-01-22 15:10:22Z] 
[INFO] 
DEBUG: Checking parameter 'maximumValidityInDays' against policy definition
[2026-01-22 15:10:22Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:10:22Z] 
[INFO] 
DEBUG: Added parameter 'maximumValidityInDays' = '365' to cleaned params
[2026-01-22 15:10:22Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:22Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:10:22Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:10:22Z] 
[INFO] 
Dry-run: would create assignment with name Keysshouldhavethespecifiedmaximumvalidityperiod-906231923 and params: 
Name                           Value
----                           -----
maximumValidityInDays          365
effect                         Deny



[2026-01-22 15:10:22Z] 
[INFO] 
Preparing to assign (33/46): Secrets should have content type set
[2026-01-22 15:10:22Z] 
[INFO] 
Assigning policy 'Secrets should have content type set' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:22Z] 
[SUCCESS] 
Found 'Secrets should have content type set' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/75262d3e-ba4a-4f43-85f8-9f72c090e5e3
[2026-01-22 15:10:23Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:23Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:10:23Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:10:23Z] 
[INFO] 
Dry-run: would create assignment with name Secretsshouldhavecontenttypeset-1186338756 and params: 
Name                           Value
----                           -----
effect                         Deny



[2026-01-22 15:10:23Z] 
[INFO] 
Preparing to assign (34/46): Azure Key Vault should disable public network access
[2026-01-22 15:10:23Z] 
[INFO] 
Assigning policy 'Azure Key Vault should disable public network access' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:23Z] 
[SUCCESS] 
Found 'Azure Key Vault should disable public network access' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/405c5871-3e91-4644-8a63-58e19d68ff5b
[2026-01-22 15:10:23Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:23Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:10:23Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:10:23Z] 
[INFO] 
Dry-run: would create assignment with name AzureKeyVaultshoulddisablepublicnetworkaccess-906277113 and params: 
Name                           Value
----                           -----
effect                         Deny



[2026-01-22 15:10:23Z] 
[INFO] 
Preparing to assign (35/46): [Preview]: Azure Key Vault Managed HSM Keys should have more than the specified number of days before expiration
[2026-01-22 15:10:23Z] 
[INFO] 
Assigning policy '[Preview]: Azure Key Vault Managed HSM Keys should have more than the specified number of days before expiration' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:23Z] 
[SUCCESS] 
Found '[Preview]: Azure Key Vault Managed HSM Keys should have more than the specified number of days before expiration' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/ad27588c-0198-4c84-81ef-08efd0274653
[2026-01-22 15:10:23Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:23Z] 
[INFO] 
DEBUG: Defined parameter names: effect, minimumDaysBeforeExpiration
[2026-01-22 15:10:23Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:10:23Z] 
[INFO] 
DEBUG: Checking parameter 'minimumDaysBeforeExpiration' against policy definition
[2026-01-22 15:10:23Z] 
[INFO] 
DEBUG: Defined parameter names: effect, minimumDaysBeforeExpiration
[2026-01-22 15:10:23Z] 
[INFO] 
DEBUG: Added parameter 'minimumDaysBeforeExpiration' = '30' to cleaned params
[2026-01-22 15:10:23Z] 
[INFO] 
Dry-run: would create assignment with name PreviewAzureKeyVaultManagedHSMKeysshouldhavemorethant-1035226701 and params: 
Name                           Value
----                           -----
minimumDaysBeforeExpiration    30
effect                         Deny



[2026-01-22 15:10:23Z] 
[INFO] 
Preparing to assign (36/46): Certificates should be issued by one of the specified non-integrated certificate authorities
[2026-01-22 15:10:23Z] 
[INFO] 
Assigning policy 'Certificates should be issued by one of the specified non-integrated certificate authorities' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:23Z] 
[SUCCESS] 
Found 'Certificates should be issued by one of the specified non-integrated certificate authorities' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/d3e82b87-6673-410b-8501-1896b688b9a3
[2026-01-22 15:10:24Z] 
[INFO] 
DEBUG: Checking parameter 'caCommonNames' against policy definition
[2026-01-22 15:10:24Z] 
[INFO] 
DEBUG: Defined parameter names: caCommonNames, effect
[2026-01-22 15:10:24Z] 
[INFO] 
DEBUG: Added parameter 'caCommonNames' = 'ContosoCA FabrikamCA' to cleaned params
[2026-01-22 15:10:24Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:24Z] 
[INFO] 
DEBUG: Defined parameter names: caCommonNames, effect
[2026-01-22 15:10:24Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:10:24Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesshouldbeissuedbyoneofthespecifiednonintegr-165973907 and params: 
Name                           Value
----                           -----
caCommonNames                  {ContosoCA, FabrikamCA}
effect                         Deny



[2026-01-22 15:10:24Z] 
[INFO] 
Preparing to assign (37/46): [Preview]: Configure Azure Key Vault Managed HSM to disable public network access
[2026-01-22 15:10:24Z] 
[INFO] 
Assigning policy '[Preview]: Configure Azure Key Vault Managed HSM to disable public network access' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:24Z] 
[SUCCESS] 
Found '[Preview]: Configure Azure Key Vault Managed HSM to disable public network access' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/84d327c3-164a-4685-b453-900478614456
[2026-01-22 15:10:24Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:24Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:10:24Z] 
[WARN] 
Parameter 'effect' value 'Deny' not in allowed values [Modify, Disabled]. Skipping to avoid PolicyParameterValueNotAllowed error.
[2026-01-22 15:10:24Z] 
[WARN] 
Effect 'Audit' not supported by policy '[Preview]: Configure Azure Key Vault Managed HSM to disable public network access'. Allowed: Modify, Disabled. Using policy default.
[2026-01-22 15:10:24Z] 
[INFO] 
Detected policy default effect 'Modify' requires managed identity
[2026-01-22 15:10:24Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '' (Length: 0)
[2026-01-22 15:10:24Z] 
[WARN] 
Policy default effect 'Modify' requires managed identity. Skipping assignment - provide -IdentityResourceId to enable.

[2026-01-22 15:10:24Z] 
[INFO] 
Preparing to assign (38/46): Keys should not be active for longer than the specified number of days
[2026-01-22 15:10:24Z] 
[INFO] 
Assigning policy 'Keys should not be active for longer than the specified number of days' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:24Z] 
[SUCCESS] 
Found 'Keys should not be active for longer than the specified number of days' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/c26e4b24-cf98-4c67-b48b-5a25c4c69eb9
[2026-01-22 15:10:24Z] 
[INFO] 
DEBUG: Checking parameter 'maximumValidityInDays' against policy definition
[2026-01-22 15:10:24Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:10:24Z] 
[INFO] 
DEBUG: Added parameter 'maximumValidityInDays' = '365' to cleaned params
[2026-01-22 15:10:24Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:24Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:10:24Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:10:24Z] 
[INFO] 
Dry-run: would create assignment with name Keysshouldnotbeactiveforlongerthanthespecifiednumbero-1296256806 and params: 
Name                           Value
----                           -----
maximumValidityInDays          365
effect                         Deny



[2026-01-22 15:10:24Z] 
[INFO] 
Preparing to assign (39/46): Certificates using RSA cryptography should have the specified minimum key size
[2026-01-22 15:10:24Z] 
[INFO] 
Assigning policy 'Certificates using RSA cryptography should have the specified minimum key size' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:24Z] 
[SUCCESS] 
Found 'Certificates using RSA cryptography should have the specified minimum key size' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/cee51871-e572-4576-855c-047c820360f0
[2026-01-22 15:10:25Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:25Z] 
[INFO] 
DEBUG: Defined parameter names: minimumRSAKeySize, effect
[2026-01-22 15:10:25Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:10:25Z] 
[INFO] 
DEBUG: Checking parameter 'minimumRSAKeySize' against policy definition
[2026-01-22 15:10:25Z] 
[INFO] 
DEBUG: Defined parameter names: minimumRSAKeySize, effect
[2026-01-22 15:10:25Z] 
[INFO] 
DEBUG: Added parameter 'minimumRSAKeySize' = '4096' to cleaned params
[2026-01-22 15:10:25Z] 
[INFO] 
Dry-run: would create assignment with name CertificatesusingRSAcryptographyshouldhavethespecifie-2031578458 and params: 
Name                           Value
----                           -----
minimumRSAKeySize              4096
effect                         Deny



[2026-01-22 15:10:25Z] 
[INFO] 
Preparing to assign (40/46): Secrets should have the specified maximum validity period
[2026-01-22 15:10:25Z] 
[INFO] 
Assigning policy 'Secrets should have the specified maximum validity period' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:25Z] 
[SUCCESS] 
Found 'Secrets should have the specified maximum validity period' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/342e8053-e12e-4c44-be01-c3c2f318400f
[2026-01-22 15:10:25Z] 
[INFO] 
DEBUG: Checking parameter 'maximumValidityInDays' against policy definition
[2026-01-22 15:10:25Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:10:25Z] 
[INFO] 
DEBUG: Added parameter 'maximumValidityInDays' = '365' to cleaned params
[2026-01-22 15:10:25Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:25Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:10:25Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:10:25Z] 
[INFO] 
Dry-run: would create assignment with name Secretsshouldhavethespecifiedmaximumvalidityperiod-1663466362 and params: 
Name                           Value
----                           -----
maximumValidityInDays          365
effect                         Deny



[2026-01-22 15:10:25Z] 
[INFO] 
Preparing to assign (41/46): Deploy - Configure diagnostic settings to an Event Hub to be enabled on Azure Key Vault Managed HSM
[2026-01-22 15:10:25Z] 
[INFO] 
Assigning policy 'Deploy - Configure diagnostic settings to an Event Hub to be enabled on Azure Key Vault Managed HSM' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:25Z] 
[SUCCESS] 
Found 'Deploy - Configure diagnostic settings to an Event Hub to be enabled on Azure Key Vault Managed HSM' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/a6d2c800-5230-4a40-bff3-8268b4987d42
[2026-01-22 15:10:25Z] 
[INFO] 
DEBUG: Checking parameter 'eventHubLocation' against policy definition
[2026-01-22 15:10:25Z] 
[INFO] 
DEBUG: Defined parameter names: effect, profileName, eventHubRuleId, eventHubLocation, metricsEnabled, logsEnabled
[2026-01-22 15:10:25Z] 
[INFO] 
DEBUG: Added parameter 'eventHubLocation' = 'eastus' to cleaned params
[2026-01-22 15:10:25Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:25Z] 
[INFO] 
DEBUG: Defined parameter names: effect, profileName, eventHubRuleId, eventHubLocation, metricsEnabled, logsEnabled
[2026-01-22 15:10:25Z] 
[INFO] 
DEBUG: Checking parameter 'eventHubRuleId' against policy definition
[2026-01-22 15:10:25Z] 
[INFO] 
DEBUG: Defined parameter names: effect, profileName, eventHubRuleId, eventHubLocation, metricsEnabled, logsEnabled
[2026-01-22 15:10:25Z] 
[INFO] 
DEBUG: Added parameter 'eventHubRuleId' = '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.EventHub/namespaces/eh-policy-test-3464/authorizationrules/RootManageSharedAccessKey' to cleaned params
[2026-01-22 15:10:25Z] 
[WARN] 
Parameter 'effect' value 'Deny' not in allowed values [DeployIfNotExists, Disabled]. Skipping to avoid PolicyParameterValueNotAllowed error.
[2026-01-22 15:10:25Z] 
[WARN] 
Effect 'Audit' not supported by policy 'Deploy - Configure diagnostic settings to an Event Hub to be enabled on Azure Key Vault Managed HSM'. Allowed: DeployIfNotExists, Disabled. Using policy default.
[2026-01-22 15:10:25Z] 
[INFO] 
Detected policy default effect 'DeployIfNotExists' requires managed identity
[2026-01-22 15:10:25Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '' (Length: 0)
[2026-01-22 15:10:25Z] 
[WARN] 
Policy default effect 'DeployIfNotExists' requires managed identity. Skipping assignment - provide -IdentityResourceId to enable.

[2026-01-22 15:10:25Z] 
[INFO] 
Preparing to assign (42/46): [Preview]: Azure Key Vault Managed HSM keys using elliptic curve cryptography should have the specified curve names
[2026-01-22 15:10:25Z] 
[INFO] 
Assigning policy '[Preview]: Azure Key Vault Managed HSM keys using elliptic curve cryptography should have the specified curve names' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:25Z] 
[SUCCESS] 
Found '[Preview]: Azure Key Vault Managed HSM keys using elliptic curve cryptography should have the specified curve names' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/e58fd0c1-feac-4d12-92db-0a7e9421f53e
[2026-01-22 15:10:26Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:26Z] 
[INFO] 
DEBUG: Defined parameter names: allowedECNames, effect
[2026-01-22 15:10:26Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:10:26Z] 
[INFO] 
DEBUG: Checking parameter 'allowedECNames' against policy definition
[2026-01-22 15:10:26Z] 
[INFO] 
DEBUG: Defined parameter names: allowedECNames, effect
[2026-01-22 15:10:26Z] 
[INFO] 
DEBUG: Added parameter 'allowedECNames' = 'P-256 P-256K P-384 P-521' to cleaned params
[2026-01-22 15:10:26Z] 
[INFO] 
Dry-run: would create assignment with name PreviewAzureKeyVaultManagedHSMkeysusingellipticcurvecr-518169623 and params: 
Name                           Value
----                           -----
allowedECNames                 {P-256, P-256K, P-384, P-521}
effect                         Deny



[2026-01-22 15:10:26Z] 
[INFO] 
Preparing to assign (43/46): Azure Key Vault Managed HSM should have purge protection enabled
[2026-01-22 15:10:26Z] 
[INFO] 
Assigning policy 'Azure Key Vault Managed HSM should have purge protection enabled' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:26Z] 
[SUCCESS] 
Found 'Azure Key Vault Managed HSM should have purge protection enabled' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/c39ba22d-4428-4149-b981-70acb31fc383
[2026-01-22 15:10:26Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:26Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:10:26Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:10:26Z] 
[INFO] 
Dry-run: would create assignment with name AzureKeyVaultManagedHSMshouldhavepurgeprotectionenabl-1494992807 and params: 
Name                           Value
----                           -----
effect                         Deny



[2026-01-22 15:10:26Z] 
[INFO] 
Preparing to assign (44/46): Key Vault secrets should have an expiration date
[2026-01-22 15:10:26Z] 
[INFO] 
Assigning policy 'Key Vault secrets should have an expiration date' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:26Z] 
[SUCCESS] 
Found 'Key Vault secrets should have an expiration date' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/98728c90-32c7-4049-8429-847dc0f4fe37
[2026-01-22 15:10:26Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:26Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:10:26Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Deny' to cleaned params
[2026-01-22 15:10:26Z] 
[INFO] 
Dry-run: would create assignment with name KeyVaultsecretsshouldhaveanexpirationdate-1232117220 and params: 
Name                           Value
----                           -----
effect                         Deny



[2026-01-22 15:10:26Z] 
[INFO] 
Preparing to assign (45/46): [Preview]: Configure Azure Key Vault Managed HSM with private endpoints
[2026-01-22 15:10:26Z] 
[INFO] 
Assigning policy '[Preview]: Configure Azure Key Vault Managed HSM with private endpoints' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:26Z] 
[SUCCESS] 
Found '[Preview]: Configure Azure Key Vault Managed HSM with private endpoints' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/d1d6d8bb-cc7c-420f-8c7d-6f6f5279a844
[2026-01-22 15:10:27Z] 
[INFO] 
DEBUG: Checking parameter 'privateEndpointSubnetId' against policy definition
[2026-01-22 15:10:27Z] 
[INFO] 
DEBUG: Defined parameter names: privateEndpointSubnetId, effect
[2026-01-22 15:10:27Z] 
[INFO] 
DEBUG: Added parameter 'privateEndpointSubnetId' = '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-keyvault-test/providers/Microsoft.Network/virtualNetworks/vnet-policy-test/subnets/subnet-keyvault' to cleaned params
[2026-01-22 15:10:27Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:27Z] 
[INFO] 
DEBUG: Defined parameter names: privateEndpointSubnetId, effect
[2026-01-22 15:10:27Z] 
[WARN] 
Parameter 'effect' value 'Deny' not in allowed values [DeployIfNotExists, Disabled]. Skipping to avoid PolicyParameterValueNotAllowed error.
[2026-01-22 15:10:27Z] 
[WARN] 
Effect 'Audit' not supported by policy '[Preview]: Configure Azure Key Vault Managed HSM with private endpoints'. Allowed: DeployIfNotExists, Disabled. Using policy default.
[2026-01-22 15:10:27Z] 
[INFO] 
Detected policy default effect 'DeployIfNotExists' requires managed identity
[2026-01-22 15:10:27Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '' (Length: 0)
[2026-01-22 15:10:27Z] 
[WARN] 
Policy default effect 'DeployIfNotExists' requires managed identity. Skipping assignment - provide -IdentityResourceId to enable.

[2026-01-22 15:10:27Z] 
[INFO] 
Preparing to assign (46/46): [Preview]: Azure Key Vault Managed HSM should use private link
[2026-01-22 15:10:27Z] 
[INFO] 
Assigning policy '[Preview]: Azure Key Vault Managed HSM should use private link' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:27Z] 
[SUCCESS] 
Found '[Preview]: Azure Key Vault Managed HSM should use private link' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/59fee2f4-d439-4f1b-9b9a-982e1474bfd8
[2026-01-22 15:10:27Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:27Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:10:27Z] 
[WARN] 
Parameter 'effect' value 'Deny' not in allowed values [Audit, Disabled]. Skipping to avoid PolicyParameterValueNotAllowed error.
[2026-01-22 15:10:27Z] 
[INFO] 
Dry-run: would create assignment with name PreviewAzureKeyVaultManagedHSMshoulduseprivatelink-504701151 and params: 
Name                           Value
----                           -----
effect                         Audit


[2026-01-22 15:10:27Z] 
[INFO] 
Collected 0 assignment IDs for filtering
[2026-01-22 15:10:27Z] 
[INFO] 
Wrote reports: KeyVaultPolicyImplementationReport-20260122-151027.md, KeyVaultPolicyImplementationReport-20260122-151027.json, KeyVaultPolicyImplementationReport-20260122-151027.csv
[2026-01-22 15:10:27Z] 
[SUCCESS] 
HTML report generated: ./PolicyImplementationReport-20260122-151027.html
Dry-run summary written to ./DryRunSummary.txt

[2026-01-22 15:10:27Z] 
[INFO] 
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-01-22 15:10:27Z] 
[INFO] 
                    ğŸ“‹ NEXT STEPS GUIDANCE
[2026-01-22 15:10:27Z] 
[INFO] 
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ¯ Dry-Run Validation Complete

âœ… What was validated:
  â†’ Policy definitions resolved from mapping file
  â†’ Parameter overrides validated against policy schemas
  â†’ Assignment names generated (64-char limit enforced)
  â†’ No actual Azure resources created or modified

ğŸ“‹ Recommended Next Steps:
  1. ğŸ“„ Review dry-run summary:
     
notepad ./DryRunSummary.txt
  2. âœ… Verify all policies resolved successfully (Status: DryRun)
  3. ğŸ” Check for policies requiring managed identity (DeployIfNotExists/Modify effects)
  4. ğŸ“Š Review parameter values match your requirements
  5. ğŸš€ Deploy to test environment when ready:
     
.\\AzPolicyImplScript.ps1 -ParameterFile <YOUR_PARAM_FILE> -SkipRBACCheck

âš ï¸  Common Issues to Check:
  â†’ Policies with Status='Skipped' require -IdentityResourceId parameter
  â†’ Verify parameter values don't exceed policy min/max constraints
  â†’ Check for typos in policy display names (lookup failures)

ğŸ“š Documentation:
  â†’ Parameter File Guide: PolicyParameters-QuickReference.md
  â†’ Deployment Workflow: DEPLOYMENT-WORKFLOW-GUIDE.md


ğŸ“‹ Dry-Run Summary: 
./DryRunSummary.txt


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-01-22 15:10:27Z] 
[SUCCESS] 
Completed run. Reports generated.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“„ Reports Generated:
  â€¢ HTML:     
./PolicyImplementationReport-20260122-151027.html
  â€¢ Markdown: 
KeyVaultPolicyImplementationReport-20260122-151027.md
  â€¢ JSON:     
KeyVaultPolicyImplementationReport-20260122-151027.json


[2026-01-22 15:10:27Z] 
[INFO] 
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-01-22 15:10:27Z] 
[INFO] 
                    ğŸ“‹ NEXT STEPS GUIDANCE
[2026-01-22 15:10:27Z] 
[INFO] 
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ¯ Custom Deployment Complete

âœ… What was deployed:
  â†’ Custom policy configuration from parameter file

ğŸ“‹ Recommended Next Steps:
  1. â³ Wait 30-60 minutes for Azure Policy evaluation cycle
  2. ğŸ“Š Check compliance status:
     
.\\AzPolicyImplScript.ps1 -CheckCompliance -TriggerScan
  3. ğŸ“š Review deployment documentation for custom workflows

[2026-01-22 15:10:27] [SUCCESS]   âœ… Command executed successfully
[2026-01-22 15:10:27] [INFO]   Output saved to: .\scenario-5-output-20260122-151010.txt
[2026-01-22 15:10:27] [ERROR]   âŒ Console next steps validation failed for Production Deny (46 Policies - Maximum Enforcement)
[2026-01-22 15:10:27] [ERROR]     - Missing 'NEXT STEPS GUIDANCE' banner
[2026-01-22 15:10:27] [ERROR]     - Missing Production Deny deployment banner
[2026-01-22 15:10:27] [ERROR]     - Missing rollback instructions
[2026-01-22 15:10:27] [SUCCESS]   âœ… HTML report validated for Production Deny (46 Policies - Maximum Enforcement)
[2026-01-22 15:10:27] [SUCCESS]   âœ… No unexpected warnings/errors for Production Deny (46 Policies - Maximum Enforcement)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-01-22 15:10:29] [INFO] SCENARIO 6: Production Auto-Remediation (8 Policies)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-01-22 15:10:29] [WARN] âš ï¸  User input required for this scenario:
[2026-01-22 15:10:29] [WARN]     Replace <MANAGED_IDENTITY_ID> with:
[2026-01-22 15:10:29] [WARN]     /subscriptions/<subscription-id>/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation
[2026-01-22 15:10:29] [INFO]   Using managed identity: /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation
[2026-01-22 15:10:29] [INFO] Executing: .\AzPolicyImplScript.ps1 -ParameterFile .\PolicyParameters-Production-Remediation.json -IdentityResourceId '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation' -SkipRBACCheck -Preview

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  Azure Policy Implementation - Key Vault Governance          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[2026-01-22 15:10:29Z] 
[INFO] 
Starting Azure Policy implementation script for Key Vault policies
[2026-01-22 15:10:29Z] 
[INFO] 
Checking required PowerShell modules...
[2026-01-22 15:10:29Z] 
[SUCCESS] 
Module Az.Accounts is present
[2026-01-22 15:10:29Z] 
[SUCCESS] 
Module Az.Resources is present
[2026-01-22 15:10:29Z] 
[SUCCESS] 
Module Az.PolicyInsights is present
[2026-01-22 15:10:29Z] 
[SUCCESS] 
Module Az.Monitor is present
[2026-01-22 15:10:29Z] 
[SUCCESS] 
Module Az.KeyVault is present
[2026-01-22 15:10:29Z] 
[INFO] 
Using Azure context: theregniers@hotmail.com
[2026-01-22 15:10:29Z] 
[INFO] 
Loading policy mapping from ./PolicyNameMapping.json
[2026-01-22 15:10:29Z] 
[INFO] 
Loaded 3745 policy mappings
[2026-01-22 15:10:29Z] 
[INFO] 
Loading policy parameter overrides from .\PolicyParameters-Production-Remediation.json
[2026-01-22 15:10:29Z] 
[INFO] 
Detected deployment type: ProductionRemediation (from parameter file: PolicyParameters-Production-Remediation.json)
[2026-01-22 15:10:29Z] 
[INFO] 
Preview mode enabled: setting DryRun and skipping RBAC checks.
[2026-01-22 15:10:29Z] 
[INFO] 
DEBUG: PSBoundParameters keys: CsvPath, ParameterOverridesPath, IdentityResourceId, Preview, SkipRBACCheck
[2026-01-22 15:10:29Z] 
[INFO] 
DEBUG: ScopeType value: ''
[2026-01-22 15:10:29Z] 
[INFO] 
Dry-run mode: using Subscription scope by default
[2026-01-22 15:10:29Z] 
[INFO] 
Checking current subscription context.
[2026-01-22 15:10:29Z] 
[INFO] 
Current subscription: MSDN Platforms Subscription (ab1336c7-687d-4107-b0f6-9649a0458adb)
[2026-01-22 15:10:29Z] 
[INFO] 
Dry-run mode: using current subscription context
[2026-01-22 15:10:29Z] 
[INFO] 
Preview mode: skipped RBAC permission check.
[2026-01-22 15:10:29Z] 
[INFO] 
Using policy effects from parameter file: .\PolicyParameters-Production-Remediation.json

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  â„¹ï¸  Production Configuration Detected (Audit Mode)            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  Using production parameters in Audit mode (recommended first step)
  No resources will be blocked during this deployment

[2026-01-22 15:10:29Z] 
[SUCCESS] 
Loaded 46 policies from parameter file: .\PolicyParameters-Production-Remediation.json

Processing 46 policies...
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

[2026-01-22 15:10:29Z] 
[INFO] 
Preparing to assign (1/46): Certificates using elliptic curve cryptography should have allowed curve names
[2026-01-22 15:10:29Z] 
[INFO] 
Assigning policy 'Certificates using elliptic curve cryptography should have allowed curve names' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:29Z] 
[SUCCESS] 
Found 'Certificates using elliptic curve cryptography should have allowed curve names' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/bd78111f-4953-4367-9fd5-7e08808b54bf
[2026-01-22 15:10:30Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:30Z] 
[INFO] 
DEBUG: Defined parameter names: allowedECNames, effect
[2026-01-22 15:10:30Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:30Z] 
[INFO] 
DEBUG: Checking parameter 'allowedECNames' against policy definition
[2026-01-22 15:10:30Z] 
[INFO] 
DEBUG: Defined parameter names: allowedECNames, effect
[2026-01-22 15:10:30Z] 
[INFO] 
DEBUG: Added parameter 'allowedECNames' = 'P-256 P-256K P-384 P-521' to cleaned params
[2026-01-22 15:10:30Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesusingellipticcurvecryptographyshouldhavea-1468057639 and params: 
Name                           Value
----                           -----
allowedECNames                 {P-256, P-256K, P-384, P-521}
effect                         Audit



[2026-01-22 15:10:30Z] 
[INFO] 
Preparing to assign (2/46): Configure key vaults to enable firewall
[2026-01-22 15:10:30Z] 
[INFO] 
Assigning policy 'Configure key vaults to enable firewall' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:30Z] 
[SUCCESS] 
Found 'Configure key vaults to enable firewall' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/ac673a9a-f77d-4846-b2d8-a57f8e1c01dc
[2026-01-22 15:10:30Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:30Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:10:30Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Modify' to cleaned params
[2026-01-22 15:10:30Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation' (Length: 169)
[2026-01-22 15:10:30Z] 
[INFO] 
Policy requires managed identity. Using: /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 28a0fe2d-1db4-4c3e-9a58-142d0f38e709. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 28a0fe2d-1db4-4c3e-9a58-142d0f38e709'.'
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 93298d06-3fff-4626-8e13-397bf9bd4c30. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 93298d06-3fff-4626-8e13-397bf9bd4c30'.'
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 218094f2-2976-4255-a15c-4008e6c8a18b. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 218094f2-2976-4255-a15c-4008e6c8a18b'.'
[2026-01-22 15:10:31Z] 
[INFO] 
Added user-assigned identity: /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation (using default location: eastus)
[2026-01-22 15:10:31Z] 
[INFO] 
Dry-run: would create assignment with name Configurekeyvaultstoenablefirewall-2078747040 and params: 
Name                           Value
----                           -----
effect                         Modify



[2026-01-22 15:10:31Z] 
[INFO] 
Preparing to assign (3/46): Azure Key Vault should use RBAC permission model
[2026-01-22 15:10:31Z] 
[INFO] 
Assigning policy 'Azure Key Vault should use RBAC permission model' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:31Z] 
[SUCCESS] 
Found 'Azure Key Vault should use RBAC permission model' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/12d4fa5e-1f9f-4c21-97a9-b99b3c6611b5
[2026-01-22 15:10:31Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:31Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:10:31Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:31Z] 
[INFO] 
Dry-run: would create assignment with name AzureKeyVaultshoulduseRBACpermissionmodel-307198231 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:10:31Z] 
[INFO] 
Preparing to assign (4/46): Keys should be the specified cryptographic type RSA or EC
[2026-01-22 15:10:31Z] 
[INFO] 
Assigning policy 'Keys should be the specified cryptographic type RSA or EC' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:31Z] 
[SUCCESS] 
Found 'Keys should be the specified cryptographic type RSA or EC' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/75c4f823-d65c-4f29-a733-01d0077fdbcb
[2026-01-22 15:10:31Z] 
[INFO] 
DEBUG: Checking parameter 'cryptographicType' against policy definition
[2026-01-22 15:10:31Z] 
[INFO] 
DEBUG: Defined parameter names: allowedKeyTypes, effect
[2026-01-22 15:10:31Z] 
[WARN] 
DEBUG: Parameter 'cryptographicType' NOT FOUND in policy definition - SKIPPED
[2026-01-22 15:10:31Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:31Z] 
[INFO] 
DEBUG: Defined parameter names: allowedKeyTypes, effect
[2026-01-22 15:10:31Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:31Z] 
[WARN] 
Parameter 'cryptographicType' not defined in policy. Skipping to avoid UndefinedPolicyParameter error.
[2026-01-22 15:10:31Z] 
[INFO] 
Dry-run: would create assignment with name KeysshouldbethespecifiedcryptographictypeRSAorEC-976981238 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:10:31Z] 
[INFO] 
Preparing to assign (5/46): Keys using elliptic curve cryptography should have the specified curve names
[2026-01-22 15:10:31Z] 
[INFO] 
Assigning policy 'Keys using elliptic curve cryptography should have the specified curve names' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:31Z] 
[SUCCESS] 
Found 'Keys using elliptic curve cryptography should have the specified curve names' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/ff25f3c8-b739-4538-9d07-3d6d25cfb255
[2026-01-22 15:10:32Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:32Z] 
[INFO] 
DEBUG: Defined parameter names: allowedECNames, effect
[2026-01-22 15:10:32Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:32Z] 
[INFO] 
DEBUG: Checking parameter 'allowedECNames' against policy definition
[2026-01-22 15:10:32Z] 
[INFO] 
DEBUG: Defined parameter names: allowedECNames, effect
[2026-01-22 15:10:32Z] 
[INFO] 
DEBUG: Added parameter 'allowedECNames' = 'P-256 P-256K P-384 P-521' to cleaned params
[2026-01-22 15:10:32Z] 
[INFO] 
Dry-run: would create assignment with name Keysusingellipticcurvecryptographyshouldhavethespecif-1437325202 and params: 
Name                           Value
----                           -----
allowedECNames                 {P-256, P-256K, P-384, P-521}
effect                         Audit



[2026-01-22 15:10:32Z] 
[INFO] 
Preparing to assign (6/46): Deploy Diagnostic Settings for Key Vault to Event Hub
[2026-01-22 15:10:32Z] 
[INFO] 
Assigning policy 'Deploy Diagnostic Settings for Key Vault to Event Hub' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:32Z] 
[SUCCESS] 
Found 'Deploy Diagnostic Settings for Key Vault to Event Hub' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/ed7c8c13-51e7-49d1-8a43-8490431a0da2
[2026-01-22 15:10:33Z] 
[INFO] 
DEBUG: Checking parameter 'eventHubLocation' against policy definition
[2026-01-22 15:10:33Z] 
[INFO] 
DEBUG: Defined parameter names: effect, profileName, eventHubRuleId, eventHubLocation, metricsEnabled, logsEnabled
[2026-01-22 15:10:33Z] 
[INFO] 
DEBUG: Added parameter 'eventHubLocation' = 'eastus' to cleaned params
[2026-01-22 15:10:33Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:33Z] 
[INFO] 
DEBUG: Defined parameter names: effect, profileName, eventHubRuleId, eventHubLocation, metricsEnabled, logsEnabled
[2026-01-22 15:10:33Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'DeployIfNotExists' to cleaned params
[2026-01-22 15:10:33Z] 
[INFO] 
DEBUG: Checking parameter 'eventHubRuleId' against policy definition
[2026-01-22 15:10:33Z] 
[INFO] 
DEBUG: Defined parameter names: effect, profileName, eventHubRuleId, eventHubLocation, metricsEnabled, logsEnabled
[2026-01-22 15:10:33Z] 
[INFO] 
DEBUG: Added parameter 'eventHubRuleId' = '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.EventHub/namespaces/eh-policy-test-3464/authorizationrules/RootManageSharedAccessKey' to cleaned params
[2026-01-22 15:10:33Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation' (Length: 169)
[2026-01-22 15:10:33Z] 
[INFO] 
Policy requires managed identity. Using: /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 28a0fe2d-1db4-4c3e-9a58-142d0f38e709. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 28a0fe2d-1db4-4c3e-9a58-142d0f38e709'.'
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 93298d06-3fff-4626-8e13-397bf9bd4c30. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 93298d06-3fff-4626-8e13-397bf9bd4c30'.'
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 218094f2-2976-4255-a15c-4008e6c8a18b. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 218094f2-2976-4255-a15c-4008e6c8a18b'.'
[2026-01-22 15:10:33Z] 
[INFO] 
Added user-assigned identity: /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation (using default location: eastus)
[2026-01-22 15:10:33Z] 
[INFO] 
Dry-run: would create assignment with name DeployDiagnosticSettingsforKeyVaulttoEventHub-215019929 and params: 
Name                           Value
----                           -----
eventHubLocation               eastus
effect                         DeployIfNotExists
eventHubRuleId                 /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.EventHub/namespaces/eh-â€¦



[2026-01-22 15:10:33Z] 
[INFO] 
Preparing to assign (7/46): Keys using RSA cryptography should have a specified minimum key size
[2026-01-22 15:10:33Z] 
[INFO] 
Assigning policy 'Keys using RSA cryptography should have a specified minimum key size' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:33Z] 
[SUCCESS] 
Found 'Keys using RSA cryptography should have a specified minimum key size' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/82067dbb-e53b-4e06-b631-546d197452d9
[2026-01-22 15:10:34Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:34Z] 
[INFO] 
DEBUG: Defined parameter names: minimumRSAKeySize, effect
[2026-01-22 15:10:34Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:34Z] 
[INFO] 
DEBUG: Checking parameter 'minimumRSAKeySize' against policy definition
[2026-01-22 15:10:34Z] 
[INFO] 
DEBUG: Defined parameter names: minimumRSAKeySize, effect
[2026-01-22 15:10:34Z] 
[INFO] 
DEBUG: Added parameter 'minimumRSAKeySize' = '4096' to cleaned params
[2026-01-22 15:10:34Z] 
[INFO] 
Dry-run: would create assignment with name KeysusingRSAcryptographyshouldhaveaspecifiedminimumkey-909744685 and params: 
Name                           Value
----                           -----
minimumRSAKeySize              4096
effect                         Audit



[2026-01-22 15:10:34Z] 
[INFO] 
Preparing to assign (8/46): Deploy - Configure diagnostic settings for Azure Key Vault to Log Analytics workspace
[2026-01-22 15:10:34Z] 
[INFO] 
Assigning policy 'Deploy - Configure diagnostic settings for Azure Key Vault to Log Analytics workspace' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:34Z] 
[SUCCESS] 
Found 'Deploy - Configure diagnostic settings for Azure Key Vault to Log Analytics workspace' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/951af2fa-529b-416e-ab6e-066fd85ac459
[2026-01-22 15:10:34Z] 
[INFO] 
DEBUG: Checking parameter 'logAnalytics' against policy definition
[2026-01-22 15:10:34Z] 
[INFO] 
DEBUG: Defined parameter names: effect, diagnosticsSettingNameToUse, logAnalytics, AuditEventEnabled, AllMetricsEnabled
[2026-01-22 15:10:34Z] 
[INFO] 
DEBUG: Added parameter 'logAnalytics' = '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.OperationalInsights/workspaces/law-policy-test-6874' to cleaned params
[2026-01-22 15:10:34Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:34Z] 
[INFO] 
DEBUG: Defined parameter names: effect, diagnosticsSettingNameToUse, logAnalytics, AuditEventEnabled, AllMetricsEnabled
[2026-01-22 15:10:34Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'DeployIfNotExists' to cleaned params
[2026-01-22 15:10:34Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation' (Length: 169)
[2026-01-22 15:10:34Z] 
[INFO] 
Policy requires managed identity. Using: /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 28a0fe2d-1db4-4c3e-9a58-142d0f38e709. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 28a0fe2d-1db4-4c3e-9a58-142d0f38e709'.'
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 93298d06-3fff-4626-8e13-397bf9bd4c30. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 93298d06-3fff-4626-8e13-397bf9bd4c30'.'
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 218094f2-2976-4255-a15c-4008e6c8a18b. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 218094f2-2976-4255-a15c-4008e6c8a18b'.'
[2026-01-22 15:10:35Z] 
[INFO] 
Added user-assigned identity: /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation (using default location: eastus)
[2026-01-22 15:10:35Z] 
[INFO] 
Dry-run: would create assignment with name DeployConfigurediagnosticsettingsforAzureKeyVaulttoLog-821297124 and params: 
Name                           Value
----                           -----
effect                         DeployIfNotExists
logAnalytics                   /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.OperationalInsights/worâ€¦



[2026-01-22 15:10:35Z] 
[INFO] 
Preparing to assign (9/46): [Preview]: Azure Key Vault Managed HSM keys using RSA cryptography should have a specified minimum key size
[2026-01-22 15:10:35Z] 
[INFO] 
Assigning policy '[Preview]: Azure Key Vault Managed HSM keys using RSA cryptography should have a specified minimum key size' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:35Z] 
[SUCCESS] 
Found '[Preview]: Azure Key Vault Managed HSM keys using RSA cryptography should have a specified minimum key size' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/86810a98-8e91-4a44-8386-ec66d0de5d57
[2026-01-22 15:10:35Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:35Z] 
[INFO] 
DEBUG: Defined parameter names: effect, minimumRSAKeySize
[2026-01-22 15:10:35Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:35Z] 
[INFO] 
DEBUG: Checking parameter 'minimumRSAKeySize' against policy definition
[2026-01-22 15:10:35Z] 
[INFO] 
DEBUG: Defined parameter names: effect, minimumRSAKeySize
[2026-01-22 15:10:35Z] 
[INFO] 
DEBUG: Added parameter 'minimumRSAKeySize' = '4096' to cleaned params
[2026-01-22 15:10:35Z] 
[INFO] 
Dry-run: would create assignment with name PreviewAzureKeyVaultManagedHSMkeysusingRSAcryptography-998252524 and params: 
Name                           Value
----                           -----
minimumRSAKeySize              4096
effect                         Audit



[2026-01-22 15:10:35Z] 
[INFO] 
Preparing to assign (10/46): Certificates should be issued by the specified integrated certificate authority
[2026-01-22 15:10:35Z] 
[INFO] 
Assigning policy 'Certificates should be issued by the specified integrated certificate authority' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:35Z] 
[SUCCESS] 
Found 'Certificates should be issued by the specified integrated certificate authority' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/8e826246-c976-48f6-b03e-619bb92b3d82
[2026-01-22 15:10:36Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:36Z] 
[INFO] 
DEBUG: Defined parameter names: allowedCAs, effect
[2026-01-22 15:10:36Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:36Z] 
[INFO] 
DEBUG: Checking parameter 'allowedCAs' against policy definition
[2026-01-22 15:10:36Z] 
[INFO] 
DEBUG: Defined parameter names: allowedCAs, effect
[2026-01-22 15:10:36Z] 
[INFO] 
DEBUG: Added parameter 'allowedCAs' = 'DigiCert GlobalSign' to cleaned params
[2026-01-22 15:10:36Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesshouldbeissuedbythespecifiedintegratedcer-1190107367 and params: 
Name                           Value
----                           -----
allowedCAs                     {DigiCert, GlobalSign}
effect                         Audit



[2026-01-22 15:10:36Z] 
[INFO] 
Preparing to assign (11/46): Secrets should have more than the specified number of days before expiration
[2026-01-22 15:10:36Z] 
[INFO] 
Assigning policy 'Secrets should have more than the specified number of days before expiration' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:36Z] 
[SUCCESS] 
Found 'Secrets should have more than the specified number of days before expiration' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/b0eb591a-5e70-4534-a8bf-04b9c489584a
[2026-01-22 15:10:36Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:36Z] 
[INFO] 
DEBUG: Defined parameter names: minimumDaysBeforeExpiration, effect
[2026-01-22 15:10:36Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:36Z] 
[INFO] 
DEBUG: Checking parameter 'minimumDaysBeforeExpiration' against policy definition
[2026-01-22 15:10:36Z] 
[INFO] 
DEBUG: Defined parameter names: minimumDaysBeforeExpiration, effect
[2026-01-22 15:10:36Z] 
[INFO] 
DEBUG: Added parameter 'minimumDaysBeforeExpiration' = '90' to cleaned params
[2026-01-22 15:10:36Z] 
[INFO] 
Dry-run: would create assignment with name Secretsshouldhavemorethanthespecifiednumberofdaysbefo-1193127515 and params: 
Name                           Value
----                           -----
minimumDaysBeforeExpiration    90
effect                         Audit



[2026-01-22 15:10:36Z] 
[INFO] 
Preparing to assign (12/46): Configure Azure Key Vaults to use private DNS zones
[2026-01-22 15:10:36Z] 
[INFO] 
Assigning policy 'Configure Azure Key Vaults to use private DNS zones' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:36Z] 
[SUCCESS] 
Found 'Configure Azure Key Vaults to use private DNS zones' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/ac673a9a-f77d-4846-b2d8-a57f8e1c01d4
[2026-01-22 15:10:36Z] 
[INFO] 
DEBUG: Checking parameter 'privateDnsZoneId' against policy definition
[2026-01-22 15:10:36Z] 
[INFO] 
DEBUG: Defined parameter names: privateDnsZoneId, effect
[2026-01-22 15:10:36Z] 
[INFO] 
DEBUG: Added parameter 'privateDnsZoneId' = '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.Network/privateDnsZones/privatelink.vaultcore.azure.net' to cleaned params
[2026-01-22 15:10:36Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:36Z] 
[INFO] 
DEBUG: Defined parameter names: privateDnsZoneId, effect
[2026-01-22 15:10:36Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'DeployIfNotExists' to cleaned params
[2026-01-22 15:10:36Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation' (Length: 169)
[2026-01-22 15:10:36Z] 
[INFO] 
Policy requires managed identity. Using: /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 28a0fe2d-1db4-4c3e-9a58-142d0f38e709. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 28a0fe2d-1db4-4c3e-9a58-142d0f38e709'.'
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 93298d06-3fff-4626-8e13-397bf9bd4c30. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 93298d06-3fff-4626-8e13-397bf9bd4c30'.'
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 218094f2-2976-4255-a15c-4008e6c8a18b. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 218094f2-2976-4255-a15c-4008e6c8a18b'.'
[2026-01-22 15:10:37Z] 
[INFO] 
Added user-assigned identity: /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation (using default location: eastus)
[2026-01-22 15:10:37Z] 
[INFO] 
Dry-run: would create assignment with name ConfigureAzureKeyVaultstouseprivateDNSzones-1754477011 and params: 
Name                           Value
----                           -----
effect                         DeployIfNotExists
privateDnsZoneId               /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.Network/privateDnsZonesâ€¦



[2026-01-22 15:10:37Z] 
[INFO] 
Preparing to assign (13/46): [Preview]: Azure Key Vault Managed HSM keys should have an expiration date
[2026-01-22 15:10:37Z] 
[INFO] 
Assigning policy '[Preview]: Azure Key Vault Managed HSM keys should have an expiration date' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:37Z] 
[SUCCESS] 
Found '[Preview]: Azure Key Vault Managed HSM keys should have an expiration date' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/1d478a74-21ba-4b9f-9d8f-8e6fced0eec5
[2026-01-22 15:10:37Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:37Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:10:37Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:37Z] 
[INFO] 
Dry-run: would create assignment with name PreviewAzureKeyVaultManagedHSMkeysshouldhaveanexpirati-976371970 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:10:37Z] 
[INFO] 
Preparing to assign (14/46): Configure Azure Key Vaults with private endpoints
[2026-01-22 15:10:37Z] 
[INFO] 
Assigning policy 'Configure Azure Key Vaults with private endpoints' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:37Z] 
[SUCCESS] 
Found 'Configure Azure Key Vaults with private endpoints' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/9d4fad1f-5189-4a42-b29e-cf7929c6b6df
[2026-01-22 15:10:37Z] 
[INFO] 
DEBUG: Checking parameter 'privateEndpointSubnetId' against policy definition
[2026-01-22 15:10:37Z] 
[INFO] 
DEBUG: Defined parameter names: privateEndpointSubnetId, effect
[2026-01-22 15:10:37Z] 
[INFO] 
DEBUG: Added parameter 'privateEndpointSubnetId' = '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-keyvault-test/providers/Microsoft.Network/virtualNetworks/vnet-policy-test/subnets/subnet-keyvault' to cleaned params
[2026-01-22 15:10:38Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:38Z] 
[INFO] 
DEBUG: Defined parameter names: privateEndpointSubnetId, effect
[2026-01-22 15:10:38Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'DeployIfNotExists' to cleaned params
[2026-01-22 15:10:38Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation' (Length: 169)
[2026-01-22 15:10:38Z] 
[INFO] 
Policy requires managed identity. Using: /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 28a0fe2d-1db4-4c3e-9a58-142d0f38e709. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 28a0fe2d-1db4-4c3e-9a58-142d0f38e709'.'
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 93298d06-3fff-4626-8e13-397bf9bd4c30. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 93298d06-3fff-4626-8e13-397bf9bd4c30'.'
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 218094f2-2976-4255-a15c-4008e6c8a18b. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 218094f2-2976-4255-a15c-4008e6c8a18b'.'
[2026-01-22 15:10:38Z] 
[INFO] 
Added user-assigned identity: /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation (using default location: eastus)
[2026-01-22 15:10:38Z] 
[INFO] 
Dry-run: would create assignment with name ConfigureAzureKeyVaultswithprivateendpoints-1664094028 and params: 
Name                           Value
----                           -----
effect                         DeployIfNotExists
privateEndpointSubnetId        /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-keyvault-test/providers/Microsoft.Network/virtualNetworâ€¦



[2026-01-22 15:10:38Z] 
[INFO] 
Preparing to assign (15/46): Key vaults should have soft delete enabled
[2026-01-22 15:10:38Z] 
[INFO] 
Assigning policy 'Key vaults should have soft delete enabled' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:38Z] 
[SUCCESS] 
Found 'Key vaults should have soft delete enabled' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/1e66c121-a66a-4b1f-9b83-0fd99bf0fc2d
[2026-01-22 15:10:38Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:38Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:10:38Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:38Z] 
[INFO] 
Dry-run: would create assignment with name Keyvaultsshouldhavesoftdeleteenabled-656701378 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:10:38Z] 
[INFO] 
Preparing to assign (16/46): Certificates should use allowed key types
[2026-01-22 15:10:38Z] 
[INFO] 
Assigning policy 'Certificates should use allowed key types' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:38Z] 
[SUCCESS] 
Found 'Certificates should use allowed key types' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/1151cede-290b-4ba0-8b38-0ad145ac888f
[2026-01-22 15:10:39Z] 
[INFO] 
DEBUG: Checking parameter 'allowedKeyTypes' against policy definition
[2026-01-22 15:10:39Z] 
[INFO] 
DEBUG: Defined parameter names: allowedKeyTypes, effect
[2026-01-22 15:10:39Z] 
[INFO] 
DEBUG: Added parameter 'allowedKeyTypes' = 'RSA EC' to cleaned params
[2026-01-22 15:10:39Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:39Z] 
[INFO] 
DEBUG: Defined parameter names: allowedKeyTypes, effect
[2026-01-22 15:10:39Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:39Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesshoulduseallowedkeytypes-246707145 and params: 
Name                           Value
----                           -----
allowedKeyTypes                {RSA, EC}
effect                         Audit



[2026-01-22 15:10:39Z] 
[INFO] 
Preparing to assign (17/46): Resource logs in Key Vault should be enabled
[2026-01-22 15:10:39Z] 
[INFO] 
Assigning policy 'Resource logs in Key Vault should be enabled' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:39Z] 
[SUCCESS] 
Found 'Resource logs in Key Vault should be enabled' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21
[2026-01-22 15:10:39Z] 
[INFO] 
DEBUG: Checking parameter 'requiredRetentionDays' against policy definition
[2026-01-22 15:10:39Z] 
[INFO] 
DEBUG: Defined parameter names: effect, requiredRetentionDays
[2026-01-22 15:10:39Z] 
[INFO] 
DEBUG: Added parameter 'requiredRetentionDays' = '365' to cleaned params
[2026-01-22 15:10:39Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:39Z] 
[INFO] 
DEBUG: Defined parameter names: effect, requiredRetentionDays
[2026-01-22 15:10:39Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'AuditIfNotExists' to cleaned params
[2026-01-22 15:10:39Z] 
[INFO] 
Dry-run: would create assignment with name ResourcelogsinKeyVaultshouldbeenabled-1683835535 and params: 
Name                           Value
----                           -----
requiredRetentionDays          365
effect                         AuditIfNotExists



[2026-01-22 15:10:39Z] 
[INFO] 
Preparing to assign (18/46): Certificates should have the specified lifetime action triggers
[2026-01-22 15:10:39Z] 
[INFO] 
Assigning policy 'Certificates should have the specified lifetime action triggers' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:39Z] 
[SUCCESS] 
Found 'Certificates should have the specified lifetime action triggers' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/12ef42cb-9903-4e39-9c26-422d29570417
[2026-01-22 15:10:39Z] 
[INFO] 
DEBUG: Checking parameter 'maximumPercentageLife' against policy definition
[2026-01-22 15:10:39Z] 
[INFO] 
DEBUG: Defined parameter names: maximumPercentageLife, minimumDaysBeforeExpiry, effect
[2026-01-22 15:10:39Z] 
[INFO] 
DEBUG: Added parameter 'maximumPercentageLife' = '80' to cleaned params
[2026-01-22 15:10:39Z] 
[INFO] 
DEBUG: Checking parameter 'minimumDaysBeforeExpiry' against policy definition
[2026-01-22 15:10:39Z] 
[INFO] 
DEBUG: Defined parameter names: maximumPercentageLife, minimumDaysBeforeExpiry, effect
[2026-01-22 15:10:39Z] 
[INFO] 
DEBUG: Added parameter 'minimumDaysBeforeExpiry' = '90' to cleaned params
[2026-01-22 15:10:39Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:39Z] 
[INFO] 
DEBUG: Defined parameter names: maximumPercentageLife, minimumDaysBeforeExpiry, effect
[2026-01-22 15:10:39Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:39Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesshouldhavethespecifiedlifetimeactiontrigg-1761965968 and params: 
Name                           Value
----                           -----
maximumPercentageLife          80
minimumDaysBeforeExpiry        90
effect                         Audit



[2026-01-22 15:10:39Z] 
[INFO] 
Preparing to assign (19/46): Secrets should not be active for longer than the specified number of days
[2026-01-22 15:10:39Z] 
[INFO] 
Assigning policy 'Secrets should not be active for longer than the specified number of days' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:39Z] 
[SUCCESS] 
Found 'Secrets should not be active for longer than the specified number of days' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/e8d99835-8a06-45ae-a8e0-87a91941ccfe
[2026-01-22 15:10:40Z] 
[INFO] 
DEBUG: Checking parameter 'maximumValidityInDays' against policy definition
[2026-01-22 15:10:40Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:10:40Z] 
[INFO] 
DEBUG: Added parameter 'maximumValidityInDays' = '365' to cleaned params
[2026-01-22 15:10:40Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:40Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:10:40Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:40Z] 
[INFO] 
Dry-run: would create assignment with name Secretsshouldnotbeactiveforlongerthanthespecifiednumb-1452013840 and params: 
Name                           Value
----                           -----
maximumValidityInDays          365
effect                         Audit



[2026-01-22 15:10:40Z] 
[INFO] 
Preparing to assign (20/46): Certificates should be issued by the specified non-integrated certificate authority
[2026-01-22 15:10:40Z] 
[INFO] 
Assigning policy 'Certificates should be issued by the specified non-integrated certificate authority' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:40Z] 
[SUCCESS] 
Found 'Certificates should be issued by the specified non-integrated certificate authority' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/a22f4a40-01d3-4c7d-8071-da157eeff341
[2026-01-22 15:10:40Z] 
[INFO] 
DEBUG: Checking parameter 'caCommonName' against policy definition
[2026-01-22 15:10:40Z] 
[INFO] 
DEBUG: Defined parameter names: caCommonName, effect
[2026-01-22 15:10:40Z] 
[INFO] 
DEBUG: Added parameter 'caCommonName' = 'ContosoCA' to cleaned params
[2026-01-22 15:10:40Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:40Z] 
[INFO] 
DEBUG: Defined parameter names: caCommonName, effect
[2026-01-22 15:10:40Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:40Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesshouldbeissuedbythespecifiednonintegratedc-500792775 and params: 
Name                           Value
----                           -----
caCommonName                   ContosoCA
effect                         Audit



[2026-01-22 15:10:40Z] 
[INFO] 
Preparing to assign (21/46): Certificates should have the specified maximum validity period
[2026-01-22 15:10:40Z] 
[INFO] 
Assigning policy 'Certificates should have the specified maximum validity period' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:40Z] 
[SUCCESS] 
Found 'Certificates should have the specified maximum validity period' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/0a075868-4c26-42ef-914c-5bc007359560
[2026-01-22 15:10:40Z] 
[INFO] 
DEBUG: Checking parameter 'maximumValidityInMonths' against policy definition
[2026-01-22 15:10:40Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInMonths, effect
[2026-01-22 15:10:40Z] 
[INFO] 
DEBUG: Added parameter 'maximumValidityInMonths' = '12' to cleaned params
[2026-01-22 15:10:40Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:40Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInMonths, effect
[2026-01-22 15:10:40Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:40Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesshouldhavethespecifiedmaximumvalidityperio-407807336 and params: 
Name                           Value
----                           -----
maximumValidityInMonths        12
effect                         Audit



[2026-01-22 15:10:40Z] 
[INFO] 
Preparing to assign (22/46): Keys should have more than the specified number of days before expiration
[2026-01-22 15:10:40Z] 
[INFO] 
Assigning policy 'Keys should have more than the specified number of days before expiration' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:40Z] 
[SUCCESS] 
Found 'Keys should have more than the specified number of days before expiration' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/5ff38825-c5d8-47c5-b70e-069a21955146
[2026-01-22 15:10:41Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:41Z] 
[INFO] 
DEBUG: Defined parameter names: minimumDaysBeforeExpiration, effect
[2026-01-22 15:10:41Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:41Z] 
[INFO] 
DEBUG: Checking parameter 'minimumDaysBeforeExpiration' against policy definition
[2026-01-22 15:10:41Z] 
[INFO] 
DEBUG: Defined parameter names: minimumDaysBeforeExpiration, effect
[2026-01-22 15:10:41Z] 
[INFO] 
DEBUG: Added parameter 'minimumDaysBeforeExpiration' = '90' to cleaned params
[2026-01-22 15:10:41Z] 
[INFO] 
Dry-run: would create assignment with name Keysshouldhavemorethanthespecifiednumberofdaysbeforeexp-12464927 and params: 
Name                           Value
----                           -----
minimumDaysBeforeExpiration    90
effect                         Audit



[2026-01-22 15:10:41Z] 
[INFO] 
Preparing to assign (23/46): Resource logs in Azure Key Vault Managed HSM should be enabled
[2026-01-22 15:10:41Z] 
[INFO] 
Assigning policy 'Resource logs in Azure Key Vault Managed HSM should be enabled' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:41Z] 
[SUCCESS] 
Found 'Resource logs in Azure Key Vault Managed HSM should be enabled' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/a2a5b911-5617-447e-a49e-59dbe0e0434b
[2026-01-22 15:10:41Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:41Z] 
[INFO] 
DEBUG: Defined parameter names: effect, requiredRetentionDays
[2026-01-22 15:10:41Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'AuditIfNotExists' to cleaned params
[2026-01-22 15:10:41Z] 
[INFO] 
Dry-run: would create assignment with name ResourcelogsinAzureKeyVaultManagedHSMshouldbeenabled-1874150632 and params: 
Name                           Value
----                           -----
effect                         AuditIfNotExists



[2026-01-22 15:10:41Z] 
[INFO] 
Preparing to assign (24/46): Key Vault keys should have an expiration date
[2026-01-22 15:10:41Z] 
[INFO] 
Assigning policy 'Key Vault keys should have an expiration date' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:41Z] 
[SUCCESS] 
Found 'Key Vault keys should have an expiration date' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/152b15f7-8e1f-4c1f-ab71-8c010ba5dbc0
[2026-01-22 15:10:41Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:41Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:10:41Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:41Z] 
[INFO] 
Dry-run: would create assignment with name KeyVaultkeysshouldhaveanexpirationdate-386037801 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:10:41Z] 
[INFO] 
Preparing to assign (25/46): Keys should have a rotation policy ensuring that their rotation is scheduled within the specified number of days after creation.
[2026-01-22 15:10:41Z] 
[INFO] 
Assigning policy 'Keys should have a rotation policy ensuring that their rotation is scheduled within the specified number of days after creation.' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:41Z] 
[SUCCESS] 
Found 'Keys should have a rotation policy ensuring that their rotation is scheduled within the specified number of days after creation.' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/d8cf8476-a2ec-4916-896e-992351803c44
[2026-01-22 15:10:42Z] 
[INFO] 
DEBUG: Checking parameter 'maximumDaysToRotate' against policy definition
[2026-01-22 15:10:42Z] 
[INFO] 
DEBUG: Defined parameter names: maximumDaysToRotate, effect
[2026-01-22 15:10:42Z] 
[INFO] 
DEBUG: Added parameter 'maximumDaysToRotate' = '90' to cleaned params
[2026-01-22 15:10:42Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:42Z] 
[INFO] 
DEBUG: Defined parameter names: maximumDaysToRotate, effect
[2026-01-22 15:10:42Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:42Z] 
[INFO] 
Dry-run: would create assignment with name Keysshouldhavearotationpolicyensuringthattheirrotatio-1816322754 and params: 
Name                           Value
----                           -----
maximumDaysToRotate            90
effect                         Audit



[2026-01-22 15:10:42Z] 
[INFO] 
Preparing to assign (26/46): Certificates should not expire within the specified number of days
[2026-01-22 15:10:42Z] 
[INFO] 
Assigning policy 'Certificates should not expire within the specified number of days' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:42Z] 
[SUCCESS] 
Found 'Certificates should not expire within the specified number of days' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/f772fb64-8e40-40ad-87bc-7706e1949427
[2026-01-22 15:10:42Z] 
[INFO] 
DEBUG: Checking parameter 'daysToExpire' against policy definition
[2026-01-22 15:10:42Z] 
[INFO] 
DEBUG: Defined parameter names: daysToExpire, effect
[2026-01-22 15:10:42Z] 
[INFO] 
DEBUG: Added parameter 'daysToExpire' = '90' to cleaned params
[2026-01-22 15:10:42Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:42Z] 
[INFO] 
DEBUG: Defined parameter names: daysToExpire, effect
[2026-01-22 15:10:42Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:42Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesshouldnotexpirewithinthespecifiednumberof-2114192775 and params: 
Name                           Value
----                           -----
daysToExpire                   90
effect                         Audit



[2026-01-22 15:10:42Z] 
[INFO] 
Preparing to assign (27/46): Key vaults should have deletion protection enabled
[2026-01-22 15:10:42Z] 
[INFO] 
Assigning policy 'Key vaults should have deletion protection enabled' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:42Z] 
[SUCCESS] 
Found 'Key vaults should have deletion protection enabled' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/0b60c0b2-2dc2-4e1c-b5c9-abbed971de53
[2026-01-22 15:10:43Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:43Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:10:43Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:43Z] 
[INFO] 
Dry-run: would create assignment with name Keyvaultsshouldhavedeletionprotectionenabled-1439856846 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:10:43Z] 
[INFO] 
Preparing to assign (28/46): [Preview]: Azure Key Vault Managed HSM should disable public network access
[2026-01-22 15:10:43Z] 
[INFO] 
Assigning policy '[Preview]: Azure Key Vault Managed HSM should disable public network access' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:43Z] 
[SUCCESS] 
Found '[Preview]: Azure Key Vault Managed HSM should disable public network access' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/19ea9d63-adee-4431-a95e-1913c6c1c75f
[2026-01-22 15:10:43Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:43Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:10:43Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:43Z] 
[INFO] 
Dry-run: would create assignment with name PreviewAzureKeyVaultManagedHSMshoulddisablepublicnetwo-208646097 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:10:43Z] 
[INFO] 
Preparing to assign (29/46): Azure Key Vaults should use private link
[2026-01-22 15:10:43Z] 
[INFO] 
Assigning policy 'Azure Key Vaults should use private link' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:43Z] 
[SUCCESS] 
Found 'Azure Key Vaults should use private link' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/a6abeaec-4d90-4a02-805f-6b26c4d3fbe9
[2026-01-22 15:10:43Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:43Z] 
[INFO] 
DEBUG: Defined parameter names: audit_effect, effect
[2026-01-22 15:10:43Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:43Z] 
[INFO] 
Dry-run: would create assignment with name AzureKeyVaultsshoulduseprivatelink-2127082189 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:10:43Z] 
[INFO] 
Preparing to assign (30/46): Keys should be backed by a hardware security module (HSM)
[2026-01-22 15:10:43Z] 
[INFO] 
Assigning policy 'Keys should be backed by a hardware security module (HSM)' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:43Z] 
[SUCCESS] 
Found 'Keys should be backed by a hardware security module (HSM)' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/587c79fe-dd04-4a5e-9d0b-f89598c7261b
[2026-01-22 15:10:43Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:43Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:10:43Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:43Z] 
[INFO] 
Dry-run: would create assignment with name KeysshouldbebackedbyahardwaresecuritymoduleHSM-593124860 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:10:43Z] 
[INFO] 
Preparing to assign (31/46): Azure Key Vault should have firewall enabled or public network access disabled
[2026-01-22 15:10:43Z] 
[INFO] 
Assigning policy 'Azure Key Vault should have firewall enabled or public network access disabled' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:43Z] 
[SUCCESS] 
Found 'Azure Key Vault should have firewall enabled or public network access disabled' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/55615ac9-af46-4a59-874e-391cc3dfb490
[2026-01-22 15:10:44Z] 
[INFO] 
DEBUG: Checking parameter 'allowedIPAddresses' against policy definition
[2026-01-22 15:10:44Z] 
[INFO] 
DEBUG: Defined parameter names: effect, restrictIPAddresses, allowedIPAddresses, forbiddenIPAddresses
[2026-01-22 15:10:44Z] 
[INFO] 
DEBUG: Added parameter 'allowedIPAddresses' = '0.0.0.0/0' to cleaned params
[2026-01-22 15:10:44Z] 
[INFO] 
DEBUG: Checking parameter 'forbiddenIPAddresses' against policy definition
[2026-01-22 15:10:44Z] 
[INFO] 
DEBUG: Defined parameter names: effect, restrictIPAddresses, allowedIPAddresses, forbiddenIPAddresses
[2026-01-22 15:10:44Z] 
[INFO] 
DEBUG: Added parameter 'forbiddenIPAddresses' = '' to cleaned params
[2026-01-22 15:10:44Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:44Z] 
[INFO] 
DEBUG: Defined parameter names: effect, restrictIPAddresses, allowedIPAddresses, forbiddenIPAddresses
[2026-01-22 15:10:44Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:44Z] 
[INFO] 
Dry-run: would create assignment with name AzureKeyVaultshouldhavefirewallenabledorpublicnetwork-1396884516 and params: 
Name                           Value
----                           -----
allowedIPAddresses             {0.0.0.0/0}
forbiddenIPAddresses           {}
effect                         Audit



[2026-01-22 15:10:44Z] 
[INFO] 
Preparing to assign (32/46): Keys should have the specified maximum validity period
[2026-01-22 15:10:44Z] 
[INFO] 
Assigning policy 'Keys should have the specified maximum validity period' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:44Z] 
[SUCCESS] 
Found 'Keys should have the specified maximum validity period' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/49a22571-d204-4c91-a7b6-09b1a586fbc9
[2026-01-22 15:10:44Z] 
[INFO] 
DEBUG: Checking parameter 'maximumValidityInDays' against policy definition
[2026-01-22 15:10:44Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:10:44Z] 
[INFO] 
DEBUG: Added parameter 'maximumValidityInDays' = '365' to cleaned params
[2026-01-22 15:10:44Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:44Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:10:44Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:44Z] 
[INFO] 
Dry-run: would create assignment with name Keysshouldhavethespecifiedmaximumvalidityperiod-906231923 and params: 
Name                           Value
----                           -----
maximumValidityInDays          365
effect                         Audit



[2026-01-22 15:10:44Z] 
[INFO] 
Preparing to assign (33/46): Secrets should have content type set
[2026-01-22 15:10:44Z] 
[INFO] 
Assigning policy 'Secrets should have content type set' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:44Z] 
[SUCCESS] 
Found 'Secrets should have content type set' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/75262d3e-ba4a-4f43-85f8-9f72c090e5e3
[2026-01-22 15:10:44Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:44Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:10:44Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:44Z] 
[INFO] 
Dry-run: would create assignment with name Secretsshouldhavecontenttypeset-1186338756 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:10:44Z] 
[INFO] 
Preparing to assign (34/46): Azure Key Vault should disable public network access
[2026-01-22 15:10:44Z] 
[INFO] 
Assigning policy 'Azure Key Vault should disable public network access' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:44Z] 
[SUCCESS] 
Found 'Azure Key Vault should disable public network access' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/405c5871-3e91-4644-8a63-58e19d68ff5b
[2026-01-22 15:10:45Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:45Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:10:45Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:45Z] 
[INFO] 
Dry-run: would create assignment with name AzureKeyVaultshoulddisablepublicnetworkaccess-906277113 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:10:45Z] 
[INFO] 
Preparing to assign (35/46): [Preview]: Azure Key Vault Managed HSM Keys should have more than the specified number of days before expiration
[2026-01-22 15:10:45Z] 
[INFO] 
Assigning policy '[Preview]: Azure Key Vault Managed HSM Keys should have more than the specified number of days before expiration' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:45Z] 
[SUCCESS] 
Found '[Preview]: Azure Key Vault Managed HSM Keys should have more than the specified number of days before expiration' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/ad27588c-0198-4c84-81ef-08efd0274653
[2026-01-22 15:10:45Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:45Z] 
[INFO] 
DEBUG: Defined parameter names: effect, minimumDaysBeforeExpiration
[2026-01-22 15:10:45Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:45Z] 
[INFO] 
DEBUG: Checking parameter 'minimumDaysBeforeExpiration' against policy definition
[2026-01-22 15:10:45Z] 
[INFO] 
DEBUG: Defined parameter names: effect, minimumDaysBeforeExpiration
[2026-01-22 15:10:45Z] 
[INFO] 
DEBUG: Added parameter 'minimumDaysBeforeExpiration' = '30' to cleaned params
[2026-01-22 15:10:45Z] 
[INFO] 
Dry-run: would create assignment with name PreviewAzureKeyVaultManagedHSMKeysshouldhavemorethant-1035226701 and params: 
Name                           Value
----                           -----
minimumDaysBeforeExpiration    30
effect                         Audit



[2026-01-22 15:10:45Z] 
[INFO] 
Preparing to assign (36/46): Certificates should be issued by one of the specified non-integrated certificate authorities
[2026-01-22 15:10:45Z] 
[INFO] 
Assigning policy 'Certificates should be issued by one of the specified non-integrated certificate authorities' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:45Z] 
[SUCCESS] 
Found 'Certificates should be issued by one of the specified non-integrated certificate authorities' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/d3e82b87-6673-410b-8501-1896b688b9a3
[2026-01-22 15:10:45Z] 
[INFO] 
DEBUG: Checking parameter 'caCommonNames' against policy definition
[2026-01-22 15:10:45Z] 
[INFO] 
DEBUG: Defined parameter names: caCommonNames, effect
[2026-01-22 15:10:45Z] 
[INFO] 
DEBUG: Added parameter 'caCommonNames' = 'ContosoCA FabrikamCA' to cleaned params
[2026-01-22 15:10:45Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:45Z] 
[INFO] 
DEBUG: Defined parameter names: caCommonNames, effect
[2026-01-22 15:10:45Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:45Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesshouldbeissuedbyoneofthespecifiednonintegr-165973907 and params: 
Name                           Value
----                           -----
caCommonNames                  {ContosoCA, FabrikamCA}
effect                         Audit



[2026-01-22 15:10:45Z] 
[INFO] 
Preparing to assign (37/46): [Preview]: Configure Azure Key Vault Managed HSM to disable public network access
[2026-01-22 15:10:45Z] 
[INFO] 
Assigning policy '[Preview]: Configure Azure Key Vault Managed HSM to disable public network access' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:45Z] 
[SUCCESS] 
Found '[Preview]: Configure Azure Key Vault Managed HSM to disable public network access' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/84d327c3-164a-4685-b453-900478614456
[2026-01-22 15:10:46Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:46Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:10:46Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Modify' to cleaned params
[2026-01-22 15:10:46Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation' (Length: 169)
[2026-01-22 15:10:46Z] 
[INFO] 
Policy requires managed identity. Using: /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 28a0fe2d-1db4-4c3e-9a58-142d0f38e709. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 28a0fe2d-1db4-4c3e-9a58-142d0f38e709'.'
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 93298d06-3fff-4626-8e13-397bf9bd4c30. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 93298d06-3fff-4626-8e13-397bf9bd4c30'.'
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 218094f2-2976-4255-a15c-4008e6c8a18b. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 218094f2-2976-4255-a15c-4008e6c8a18b'.'
[2026-01-22 15:10:46Z] 
[INFO] 
Added user-assigned identity: /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation (using default location: eastus)
[2026-01-22 15:10:46Z] 
[INFO] 
Dry-run: would create assignment with name PreviewConfigureAzureKeyVaultManagedHSMtodisablepublic-937554689 and params: 
Name                           Value
----                           -----
effect                         Modify



[2026-01-22 15:10:46Z] 
[INFO] 
Preparing to assign (38/46): Keys should not be active for longer than the specified number of days
[2026-01-22 15:10:46Z] 
[INFO] 
Assigning policy 'Keys should not be active for longer than the specified number of days' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:46Z] 
[SUCCESS] 
Found 'Keys should not be active for longer than the specified number of days' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/c26e4b24-cf98-4c67-b48b-5a25c4c69eb9
[2026-01-22 15:10:47Z] 
[INFO] 
DEBUG: Checking parameter 'maximumValidityInDays' against policy definition
[2026-01-22 15:10:47Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:10:47Z] 
[INFO] 
DEBUG: Added parameter 'maximumValidityInDays' = '365' to cleaned params
[2026-01-22 15:10:47Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:47Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:10:47Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:47Z] 
[INFO] 
Dry-run: would create assignment with name Keysshouldnotbeactiveforlongerthanthespecifiednumbero-1296256806 and params: 
Name                           Value
----                           -----
maximumValidityInDays          365
effect                         Audit



[2026-01-22 15:10:47Z] 
[INFO] 
Preparing to assign (39/46): Certificates using RSA cryptography should have the specified minimum key size
[2026-01-22 15:10:47Z] 
[INFO] 
Assigning policy 'Certificates using RSA cryptography should have the specified minimum key size' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:47Z] 
[SUCCESS] 
Found 'Certificates using RSA cryptography should have the specified minimum key size' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/cee51871-e572-4576-855c-047c820360f0
[2026-01-22 15:10:47Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:47Z] 
[INFO] 
DEBUG: Defined parameter names: minimumRSAKeySize, effect
[2026-01-22 15:10:47Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:47Z] 
[INFO] 
DEBUG: Checking parameter 'minimumRSAKeySize' against policy definition
[2026-01-22 15:10:47Z] 
[INFO] 
DEBUG: Defined parameter names: minimumRSAKeySize, effect
[2026-01-22 15:10:47Z] 
[INFO] 
DEBUG: Added parameter 'minimumRSAKeySize' = '4096' to cleaned params
[2026-01-22 15:10:47Z] 
[INFO] 
Dry-run: would create assignment with name CertificatesusingRSAcryptographyshouldhavethespecifie-2031578458 and params: 
Name                           Value
----                           -----
minimumRSAKeySize              4096
effect                         Audit



[2026-01-22 15:10:47Z] 
[INFO] 
Preparing to assign (40/46): Secrets should have the specified maximum validity period
[2026-01-22 15:10:47Z] 
[INFO] 
Assigning policy 'Secrets should have the specified maximum validity period' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:47Z] 
[SUCCESS] 
Found 'Secrets should have the specified maximum validity period' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/342e8053-e12e-4c44-be01-c3c2f318400f
[2026-01-22 15:10:48Z] 
[INFO] 
DEBUG: Checking parameter 'maximumValidityInDays' against policy definition
[2026-01-22 15:10:48Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:10:48Z] 
[INFO] 
DEBUG: Added parameter 'maximumValidityInDays' = '365' to cleaned params
[2026-01-22 15:10:48Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:48Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:10:48Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:48Z] 
[INFO] 
Dry-run: would create assignment with name Secretsshouldhavethespecifiedmaximumvalidityperiod-1663466362 and params: 
Name                           Value
----                           -----
maximumValidityInDays          365
effect                         Audit



[2026-01-22 15:10:48Z] 
[INFO] 
Preparing to assign (41/46): Deploy - Configure diagnostic settings to an Event Hub to be enabled on Azure Key Vault Managed HSM
[2026-01-22 15:10:48Z] 
[INFO] 
Assigning policy 'Deploy - Configure diagnostic settings to an Event Hub to be enabled on Azure Key Vault Managed HSM' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:48Z] 
[SUCCESS] 
Found 'Deploy - Configure diagnostic settings to an Event Hub to be enabled on Azure Key Vault Managed HSM' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/a6d2c800-5230-4a40-bff3-8268b4987d42
[2026-01-22 15:10:48Z] 
[INFO] 
DEBUG: Checking parameter 'eventHubLocation' against policy definition
[2026-01-22 15:10:48Z] 
[INFO] 
DEBUG: Defined parameter names: effect, profileName, eventHubRuleId, eventHubLocation, metricsEnabled, logsEnabled
[2026-01-22 15:10:48Z] 
[INFO] 
DEBUG: Added parameter 'eventHubLocation' = 'eastus' to cleaned params
[2026-01-22 15:10:48Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:48Z] 
[INFO] 
DEBUG: Defined parameter names: effect, profileName, eventHubRuleId, eventHubLocation, metricsEnabled, logsEnabled
[2026-01-22 15:10:48Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'DeployIfNotExists' to cleaned params
[2026-01-22 15:10:48Z] 
[INFO] 
DEBUG: Checking parameter 'eventHubRuleId' against policy definition
[2026-01-22 15:10:48Z] 
[INFO] 
DEBUG: Defined parameter names: effect, profileName, eventHubRuleId, eventHubLocation, metricsEnabled, logsEnabled
[2026-01-22 15:10:48Z] 
[INFO] 
DEBUG: Added parameter 'eventHubRuleId' = '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.EventHub/namespaces/eh-policy-test-3464/authorizationrules/RootManageSharedAccessKey' to cleaned params
[2026-01-22 15:10:48Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation' (Length: 169)
[2026-01-22 15:10:48Z] 
[INFO] 
Policy requires managed identity. Using: /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 28a0fe2d-1db4-4c3e-9a58-142d0f38e709. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 28a0fe2d-1db4-4c3e-9a58-142d0f38e709'.'
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 93298d06-3fff-4626-8e13-397bf9bd4c30. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 93298d06-3fff-4626-8e13-397bf9bd4c30'.'
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 218094f2-2976-4255-a15c-4008e6c8a18b. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 218094f2-2976-4255-a15c-4008e6c8a18b'.'
[2026-01-22 15:10:49Z] 
[INFO] 
Added user-assigned identity: /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation (using default location: eastus)
[2026-01-22 15:10:49Z] 
[INFO] 
Dry-run: would create assignment with name DeployConfigurediagnosticsettingstoanEventHubtobeenabl-909645055 and params: 
Name                           Value
----                           -----
eventHubLocation               eastus
effect                         DeployIfNotExists
eventHubRuleId                 /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.EventHub/namespaces/eh-â€¦



[2026-01-22 15:10:49Z] 
[INFO] 
Preparing to assign (42/46): [Preview]: Azure Key Vault Managed HSM keys using elliptic curve cryptography should have the specified curve names
[2026-01-22 15:10:49Z] 
[INFO] 
Assigning policy '[Preview]: Azure Key Vault Managed HSM keys using elliptic curve cryptography should have the specified curve names' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:49Z] 
[SUCCESS] 
Found '[Preview]: Azure Key Vault Managed HSM keys using elliptic curve cryptography should have the specified curve names' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/e58fd0c1-feac-4d12-92db-0a7e9421f53e
[2026-01-22 15:10:49Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:49Z] 
[INFO] 
DEBUG: Defined parameter names: allowedECNames, effect
[2026-01-22 15:10:49Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:49Z] 
[INFO] 
DEBUG: Checking parameter 'allowedECNames' against policy definition
[2026-01-22 15:10:49Z] 
[INFO] 
DEBUG: Defined parameter names: allowedECNames, effect
[2026-01-22 15:10:49Z] 
[INFO] 
DEBUG: Added parameter 'allowedECNames' = 'P-256 P-256K P-384 P-521' to cleaned params
[2026-01-22 15:10:49Z] 
[INFO] 
Dry-run: would create assignment with name PreviewAzureKeyVaultManagedHSMkeysusingellipticcurvecr-518169623 and params: 
Name                           Value
----                           -----
allowedECNames                 {P-256, P-256K, P-384, P-521}
effect                         Audit



[2026-01-22 15:10:49Z] 
[INFO] 
Preparing to assign (43/46): Azure Key Vault Managed HSM should have purge protection enabled
[2026-01-22 15:10:49Z] 
[INFO] 
Assigning policy 'Azure Key Vault Managed HSM should have purge protection enabled' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:49Z] 
[SUCCESS] 
Found 'Azure Key Vault Managed HSM should have purge protection enabled' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/c39ba22d-4428-4149-b981-70acb31fc383
[2026-01-22 15:10:49Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:49Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:10:49Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:49Z] 
[INFO] 
Dry-run: would create assignment with name AzureKeyVaultManagedHSMshouldhavepurgeprotectionenabl-1494992807 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:10:49Z] 
[INFO] 
Preparing to assign (44/46): Key Vault secrets should have an expiration date
[2026-01-22 15:10:49Z] 
[INFO] 
Assigning policy 'Key Vault secrets should have an expiration date' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:49Z] 
[SUCCESS] 
Found 'Key Vault secrets should have an expiration date' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/98728c90-32c7-4049-8429-847dc0f4fe37
[2026-01-22 15:10:50Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:50Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:10:50Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:50Z] 
[INFO] 
Dry-run: would create assignment with name KeyVaultsecretsshouldhaveanexpirationdate-1232117220 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:10:50Z] 
[INFO] 
Preparing to assign (45/46): [Preview]: Configure Azure Key Vault Managed HSM with private endpoints
[2026-01-22 15:10:50Z] 
[INFO] 
Assigning policy '[Preview]: Configure Azure Key Vault Managed HSM with private endpoints' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:50Z] 
[SUCCESS] 
Found '[Preview]: Configure Azure Key Vault Managed HSM with private endpoints' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/d1d6d8bb-cc7c-420f-8c7d-6f6f5279a844
[2026-01-22 15:10:50Z] 
[INFO] 
DEBUG: Checking parameter 'privateEndpointSubnetId' against policy definition
[2026-01-22 15:10:50Z] 
[INFO] 
DEBUG: Defined parameter names: privateEndpointSubnetId, effect
[2026-01-22 15:10:50Z] 
[INFO] 
DEBUG: Added parameter 'privateEndpointSubnetId' = '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-keyvault-test/providers/Microsoft.Network/virtualNetworks/vnet-policy-test/subnets/subnet-keyvault' to cleaned params
[2026-01-22 15:10:50Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:50Z] 
[INFO] 
DEBUG: Defined parameter names: privateEndpointSubnetId, effect
[2026-01-22 15:10:50Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'DeployIfNotExists' to cleaned params
[2026-01-22 15:10:50Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation' (Length: 169)
[2026-01-22 15:10:50Z] 
[INFO] 
Policy requires managed identity. Using: /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 28a0fe2d-1db4-4c3e-9a58-142d0f38e709. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 28a0fe2d-1db4-4c3e-9a58-142d0f38e709'.'
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 93298d06-3fff-4626-8e13-397bf9bd4c30. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 93298d06-3fff-4626-8e13-397bf9bd4c30'.'
Unable to acquire token for tenant '' with error 'Authentication failed against tenant 218094f2-2976-4255-a15c-4008e6c8a18b. User interaction is required. This may be due to the conditional access policy settings such as multi-factor authentication (MFA). If you need to access subscriptions in that tenant, please rerun 'Connect-AzAccount' with additional parameter '-TenantId 218094f2-2976-4255-a15c-4008e6c8a18b'.'
[2026-01-22 15:10:51Z] 
[INFO] 
Added user-assigned identity: /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id-policy-remediation (using default location: eastus)
[2026-01-22 15:10:51Z] 
[INFO] 
Dry-run: would create assignment with name PreviewConfigureAzureKeyVaultManagedHSMwithprivateendp-732076577 and params: 
Name                           Value
----                           -----
effect                         DeployIfNotExists
privateEndpointSubnetId        /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-keyvault-test/providers/Microsoft.Network/virtualNetworâ€¦



[2026-01-22 15:10:51Z] 
[INFO] 
Preparing to assign (46/46): [Preview]: Azure Key Vault Managed HSM should use private link
[2026-01-22 15:10:51Z] 
[INFO] 
Assigning policy '[Preview]: Azure Key Vault Managed HSM should use private link' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:51Z] 
[SUCCESS] 
Found '[Preview]: Azure Key Vault Managed HSM should use private link' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/59fee2f4-d439-4f1b-9b9a-982e1474bfd8
[2026-01-22 15:10:51Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:51Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:10:51Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:51Z] 
[INFO] 
Dry-run: would create assignment with name PreviewAzureKeyVaultManagedHSMshoulduseprivatelink-504701151 and params: 
Name                           Value
----                           -----
effect                         Audit


[2026-01-22 15:10:51Z] 
[INFO] 
Collected 0 assignment IDs for filtering
[2026-01-22 15:10:51Z] 
[INFO] 
Wrote reports: KeyVaultPolicyImplementationReport-20260122-151051.md, KeyVaultPolicyImplementationReport-20260122-151051.json, KeyVaultPolicyImplementationReport-20260122-151051.csv
[2026-01-22 15:10:51Z] 
[SUCCESS] 
HTML report generated: ./PolicyImplementationReport-20260122-151051.html
Dry-run summary written to ./DryRunSummary.txt

[2026-01-22 15:10:51Z] 
[INFO] 
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-01-22 15:10:51Z] 
[INFO] 
                    ğŸ“‹ NEXT STEPS GUIDANCE
[2026-01-22 15:10:51Z] 
[INFO] 
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ¯ Dry-Run Validation Complete

âœ… What was validated:
  â†’ Policy definitions resolved from mapping file
  â†’ Parameter overrides validated against policy schemas
  â†’ Assignment names generated (64-char limit enforced)
  â†’ No actual Azure resources created or modified

ğŸ“‹ Recommended Next Steps:
  1. ğŸ“„ Review dry-run summary:
     
notepad ./DryRunSummary.txt
  2. âœ… Verify all policies resolved successfully (Status: DryRun)
  3. ğŸ” Check for policies requiring managed identity (DeployIfNotExists/Modify effects)
  4. ğŸ“Š Review parameter values match your requirements
  5. ğŸš€ Deploy to test environment when ready:
     
.\\AzPolicyImplScript.ps1 -ParameterFile <YOUR_PARAM_FILE> -SkipRBACCheck

âš ï¸  Common Issues to Check:
  â†’ Policies with Status='Skipped' require -IdentityResourceId parameter
  â†’ Verify parameter values don't exceed policy min/max constraints
  â†’ Check for typos in policy display names (lookup failures)

ğŸ“š Documentation:
  â†’ Parameter File Guide: PolicyParameters-QuickReference.md
  â†’ Deployment Workflow: DEPLOYMENT-WORKFLOW-GUIDE.md


ğŸ“‹ Dry-Run Summary: 
./DryRunSummary.txt


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-01-22 15:10:51Z] 
[SUCCESS] 
Completed run. Reports generated.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“„ Reports Generated:
  â€¢ HTML:     
./PolicyImplementationReport-20260122-151051.html
  â€¢ Markdown: 
KeyVaultPolicyImplementationReport-20260122-151051.md
  â€¢ JSON:     
KeyVaultPolicyImplementationReport-20260122-151051.json


[2026-01-22 15:10:51Z] 
[INFO] 
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-01-22 15:10:51Z] 
[INFO] 
                    ğŸ“‹ NEXT STEPS GUIDANCE
[2026-01-22 15:10:51Z] 
[INFO] 
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ¯ Production Auto-Remediation Complete (8 Policies - DeployIfNotExists)

âœ… What was deployed:
  â†’ 8 auto-remediation policies in PRODUCTION environment
  â†’ Managed identity with Contributor role assigned
  â†’ Policies: Diagnostic settings, Private Endpoints, Soft Delete, Purge Protection

âš ï¸  PRODUCTION ENVIRONMENT - HIGH RISK
  â†’ Auto-remediation WILL MODIFY existing Key Vaults
  â†’ Changes apply to all non-compliant vaults in scope
  â†’ Remediation cannot be automatically rolled back

ğŸ“‹ Critical Next Steps:
  1. â³ Wait 15-30 minutes for auto-remediation tasks to complete
  2. ğŸ” Monitor remediation progress in Azure Portal:
     Azure Policy â†’ Compliance â†’ Remediations tab
  3. ğŸ“Š Verify remediation results:
     
.\\AzPolicyImplScript.ps1 -CheckCompliance -TriggerScan
  4. ğŸ“§ Alert stakeholders of automated changes
  5. ğŸ“‹ Review Activity Log for remediation errors:
     
Get-AzLog -ResourceProvider 'Microsoft.Authorization'

ğŸš¨ Emergency Response (if remediation causes issues):
  1. Stop remediation tasks:
     
Get-AzPolicyRemediation | Stop-AzPolicyRemediation
  2. Create policy exemptions for affected vaults:
     
.\\AzPolicyImplScript.ps1 -ExemptionAction Create
  3. Contact Azure Support if data loss occurred

[2026-01-22 15:10:51] [SUCCESS]   âœ… Command executed successfully
[2026-01-22 15:10:51] [INFO]   Output saved to: .\scenario-6-output-20260122-151029.txt
[2026-01-22 15:10:51] [ERROR]   âŒ Console next steps validation failed for Production Auto-Remediation (8 Policies)
[2026-01-22 15:10:51] [ERROR]     - Missing 'NEXT STEPS GUIDANCE' banner
[2026-01-22 15:10:51] [ERROR]     - Missing Production Remediation banner
[2026-01-22 15:10:51] [ERROR]     - Missing emergency response guidance
[2026-01-22 15:10:52] [SUCCESS]   âœ… HTML report validated for Production Auto-Remediation (8 Policies)
[2026-01-22 15:10:52] [SUCCESS]   âœ… No unexpected warnings/errors for Production Auto-Remediation (8 Policies)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-01-22 15:10:54] [INFO] SCENARIO 7: Resource Group Scope (Limited Deployment)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-01-22 15:10:54] [WARN] âš ï¸  User input required for this scenario:
[2026-01-22 15:10:54] [WARN]     Replace <SUBSCRIPTION_ID> with your subscription ID
[2026-01-22 15:10:54] [WARN]     Replace <RESOURCE_GROUP> with resource group name (default: rg-policy-keyvault-test)
[2026-01-22 15:10:54] [INFO]   Using resource group: /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-keyvault-test
[2026-01-22 15:10:54] [INFO] Executing: .\AzPolicyImplScript.ps1 -ParameterFile .\PolicyParameters-DevTest.json -ResourceGroupScope '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-keyvault-test' -SkipRBACCheck -Preview

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  Azure Policy Implementation - Key Vault Governance          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[2026-01-22 15:10:54Z] 
[INFO] 
Starting Azure Policy implementation script for Key Vault policies
[2026-01-22 15:10:54Z] 
[INFO] 
Checking required PowerShell modules...
[2026-01-22 15:10:54Z] 
[SUCCESS] 
Module Az.Accounts is present
[2026-01-22 15:10:54Z] 
[SUCCESS] 
Module Az.Resources is present
[2026-01-22 15:10:54Z] 
[SUCCESS] 
Module Az.PolicyInsights is present
[2026-01-22 15:10:54Z] 
[SUCCESS] 
Module Az.Monitor is present
[2026-01-22 15:10:54Z] 
[SUCCESS] 
Module Az.KeyVault is present
[2026-01-22 15:10:54Z] 
[INFO] 
Using Azure context: theregniers@hotmail.com
[2026-01-22 15:10:54Z] 
[INFO] 
Loading policy mapping from ./PolicyNameMapping.json
[2026-01-22 15:10:54Z] 
[INFO] 
Loaded 3745 policy mappings
[2026-01-22 15:10:54Z] 
[INFO] 
Loading policy parameter overrides from .\PolicyParameters-DevTest.json
[2026-01-22 15:10:54Z] 
[INFO] 
Detected deployment type: DevTest30 (from parameter file: PolicyParameters-DevTest.json)
[2026-01-22 15:10:54Z] 
[INFO] 
Preview mode enabled: setting DryRun and skipping RBAC checks.
[2026-01-22 15:10:54Z] 
[INFO] 
DEBUG: PSBoundParameters keys: CsvPath, ParameterOverridesPath, SkipRBACCheck, Preview
[2026-01-22 15:10:54Z] 
[INFO] 
DEBUG: ScopeType value: ''
[2026-01-22 15:10:54Z] 
[INFO] 
Dry-run mode: using Subscription scope by default
[2026-01-22 15:10:54Z] 
[INFO] 
Checking current subscription context.
[2026-01-22 15:10:54Z] 
[INFO] 
Current subscription: MSDN Platforms Subscription (ab1336c7-687d-4107-b0f6-9649a0458adb)
[2026-01-22 15:10:54Z] 
[INFO] 
Dry-run mode: using current subscription context
[2026-01-22 15:10:54Z] 
[INFO] 
Preview mode: skipped RBAC permission check.
[2026-01-22 15:10:54Z] 
[INFO] 
Using policy effects from parameter file: .\PolicyParameters-DevTest.json
[2026-01-22 15:10:54Z] 
[SUCCESS] 
Loaded 30 policies from parameter file: .\PolicyParameters-DevTest.json

Processing 30 policies...
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

[2026-01-22 15:10:54Z] 
[INFO] 
Preparing to assign (1/30): Configure key vaults to enable firewall
[2026-01-22 15:10:54Z] 
[INFO] 
Assigning policy 'Configure key vaults to enable firewall' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:54Z] 
[SUCCESS] 
Found 'Configure key vaults to enable firewall' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/ac673a9a-f77d-4846-b2d8-a57f8e1c01dc
[2026-01-22 15:10:54Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:54Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:10:54Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Modify' to cleaned params
[2026-01-22 15:10:54Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '' (Length: 0)
[2026-01-22 15:10:54Z] 
[WARN] 
Effect '' requires managed identity. Skipping assignment - provide -IdentityResourceId to enable.

[2026-01-22 15:10:54Z] 
[INFO] 
Preparing to assign (2/30): Deploy Diagnostic Settings for Key Vault to Event Hub
[2026-01-22 15:10:54Z] 
[INFO] 
Assigning policy 'Deploy Diagnostic Settings for Key Vault to Event Hub' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:54Z] 
[SUCCESS] 
Found 'Deploy Diagnostic Settings for Key Vault to Event Hub' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/ed7c8c13-51e7-49d1-8a43-8490431a0da2
[2026-01-22 15:10:55Z] 
[INFO] 
DEBUG: Checking parameter 'eventHubLocation' against policy definition
[2026-01-22 15:10:55Z] 
[INFO] 
DEBUG: Defined parameter names: effect, profileName, eventHubRuleId, eventHubLocation, metricsEnabled, logsEnabled
[2026-01-22 15:10:55Z] 
[INFO] 
DEBUG: Added parameter 'eventHubLocation' = 'eastus' to cleaned params
[2026-01-22 15:10:55Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:55Z] 
[INFO] 
DEBUG: Defined parameter names: effect, profileName, eventHubRuleId, eventHubLocation, metricsEnabled, logsEnabled
[2026-01-22 15:10:55Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'DeployIfNotExists' to cleaned params
[2026-01-22 15:10:55Z] 
[INFO] 
DEBUG: Checking parameter 'eventHubRuleId' against policy definition
[2026-01-22 15:10:55Z] 
[INFO] 
DEBUG: Defined parameter names: effect, profileName, eventHubRuleId, eventHubLocation, metricsEnabled, logsEnabled
[2026-01-22 15:10:55Z] 
[INFO] 
DEBUG: Added parameter 'eventHubRuleId' = '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.EventHub/namespaces/eh-policy-test-6513/authorizationrules/RootManageSharedAccessKey' to cleaned params
[2026-01-22 15:10:55Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '' (Length: 0)
[2026-01-22 15:10:55Z] 
[WARN] 
Effect '' requires managed identity. Skipping assignment - provide -IdentityResourceId to enable.

[2026-01-22 15:10:55Z] 
[INFO] 
Preparing to assign (3/30): Keys using RSA cryptography should have a specified minimum key size
[2026-01-22 15:10:55Z] 
[INFO] 
Assigning policy 'Keys using RSA cryptography should have a specified minimum key size' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:55Z] 
[SUCCESS] 
Found 'Keys using RSA cryptography should have a specified minimum key size' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/82067dbb-e53b-4e06-b631-546d197452d9
[2026-01-22 15:10:55Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:55Z] 
[INFO] 
DEBUG: Defined parameter names: minimumRSAKeySize, effect
[2026-01-22 15:10:55Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:55Z] 
[INFO] 
DEBUG: Checking parameter 'minimumRSAKeySize' against policy definition
[2026-01-22 15:10:55Z] 
[INFO] 
DEBUG: Defined parameter names: minimumRSAKeySize, effect
[2026-01-22 15:10:55Z] 
[INFO] 
DEBUG: Added parameter 'minimumRSAKeySize' = '2048' to cleaned params
[2026-01-22 15:10:55Z] 
[INFO] 
Dry-run: would create assignment with name KeysusingRSAcryptographyshouldhaveaspecifiedminimumkey-909744685 and params: 
Name                           Value
----                           -----
minimumRSAKeySize              2048
effect                         Audit



[2026-01-22 15:10:55Z] 
[INFO] 
Preparing to assign (4/30): Deploy - Configure diagnostic settings for Azure Key Vault to Log Analytics workspace
[2026-01-22 15:10:55Z] 
[INFO] 
Assigning policy 'Deploy - Configure diagnostic settings for Azure Key Vault to Log Analytics workspace' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:55Z] 
[SUCCESS] 
Found 'Deploy - Configure diagnostic settings for Azure Key Vault to Log Analytics workspace' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/951af2fa-529b-416e-ab6e-066fd85ac459
[2026-01-22 15:10:55Z] 
[INFO] 
DEBUG: Checking parameter 'logAnalytics' against policy definition
[2026-01-22 15:10:55Z] 
[INFO] 
DEBUG: Defined parameter names: effect, diagnosticsSettingNameToUse, logAnalytics, AuditEventEnabled, AllMetricsEnabled
[2026-01-22 15:10:55Z] 
[INFO] 
DEBUG: Added parameter 'logAnalytics' = '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.OperationalInsights/workspaces/law-policy-test-6827' to cleaned params
[2026-01-22 15:10:55Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:55Z] 
[INFO] 
DEBUG: Defined parameter names: effect, diagnosticsSettingNameToUse, logAnalytics, AuditEventEnabled, AllMetricsEnabled
[2026-01-22 15:10:55Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'DeployIfNotExists' to cleaned params
[2026-01-22 15:10:55Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '' (Length: 0)
[2026-01-22 15:10:55Z] 
[WARN] 
Effect '' requires managed identity. Skipping assignment - provide -IdentityResourceId to enable.

[2026-01-22 15:10:55Z] 
[INFO] 
Preparing to assign (5/30): Key Vault secrets should have an expiration date
[2026-01-22 15:10:55Z] 
[INFO] 
Assigning policy 'Key Vault secrets should have an expiration date' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:55Z] 
[SUCCESS] 
Found 'Key Vault secrets should have an expiration date' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/98728c90-32c7-4049-8429-847dc0f4fe37
[2026-01-22 15:10:56Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:56Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:10:56Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:56Z] 
[INFO] 
Dry-run: would create assignment with name KeyVaultsecretsshouldhaveanexpirationdate-1232117220 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:10:56Z] 
[INFO] 
Preparing to assign (6/30): Secrets should have more than the specified number of days before expiration
[2026-01-22 15:10:56Z] 
[INFO] 
Assigning policy 'Secrets should have more than the specified number of days before expiration' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:56Z] 
[SUCCESS] 
Found 'Secrets should have more than the specified number of days before expiration' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/b0eb591a-5e70-4534-a8bf-04b9c489584a
[2026-01-22 15:10:56Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:56Z] 
[INFO] 
DEBUG: Defined parameter names: minimumDaysBeforeExpiration, effect
[2026-01-22 15:10:56Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:56Z] 
[INFO] 
DEBUG: Checking parameter 'minimumDaysBeforeExpiration' against policy definition
[2026-01-22 15:10:56Z] 
[INFO] 
DEBUG: Defined parameter names: minimumDaysBeforeExpiration, effect
[2026-01-22 15:10:56Z] 
[INFO] 
DEBUG: Added parameter 'minimumDaysBeforeExpiration' = '30' to cleaned params
[2026-01-22 15:10:56Z] 
[INFO] 
Dry-run: would create assignment with name Secretsshouldhavemorethanthespecifiednumberofdaysbefo-1193127515 and params: 
Name                           Value
----                           -----
minimumDaysBeforeExpiration    30
effect                         Audit



[2026-01-22 15:10:56Z] 
[INFO] 
Preparing to assign (7/30): Configure Azure Key Vaults with private endpoints
[2026-01-22 15:10:56Z] 
[INFO] 
Assigning policy 'Configure Azure Key Vaults with private endpoints' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:56Z] 
[SUCCESS] 
Found 'Configure Azure Key Vaults with private endpoints' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/9d4fad1f-5189-4a42-b29e-cf7929c6b6df
[2026-01-22 15:10:56Z] 
[INFO] 
DEBUG: Checking parameter 'privateEndpointSubnetId' against policy definition
[2026-01-22 15:10:56Z] 
[INFO] 
DEBUG: Defined parameter names: privateEndpointSubnetId, effect
[2026-01-22 15:10:56Z] 
[INFO] 
DEBUG: Added parameter 'privateEndpointSubnetId' = '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.Network/virtualNetworks/vnet-policy-test/subnets/snet-privateendpoints' to cleaned params
[2026-01-22 15:10:56Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:56Z] 
[INFO] 
DEBUG: Defined parameter names: privateEndpointSubnetId, effect
[2026-01-22 15:10:56Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'DeployIfNotExists' to cleaned params
[2026-01-22 15:10:56Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '' (Length: 0)
[2026-01-22 15:10:56Z] 
[WARN] 
Effect '' requires managed identity. Skipping assignment - provide -IdentityResourceId to enable.

[2026-01-22 15:10:56Z] 
[INFO] 
Preparing to assign (8/30): Key vaults should have soft delete enabled
[2026-01-22 15:10:56Z] 
[INFO] 
Assigning policy 'Key vaults should have soft delete enabled' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:56Z] 
[SUCCESS] 
Found 'Key vaults should have soft delete enabled' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/1e66c121-a66a-4b1f-9b83-0fd99bf0fc2d
[2026-01-22 15:10:56Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:56Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:10:56Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:56Z] 
[INFO] 
Dry-run: would create assignment with name Keyvaultsshouldhavesoftdeleteenabled-656701378 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:10:56Z] 
[INFO] 
Preparing to assign (9/30): Certificates should have the specified lifetime action triggers
[2026-01-22 15:10:56Z] 
[INFO] 
Assigning policy 'Certificates should have the specified lifetime action triggers' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:56Z] 
[SUCCESS] 
Found 'Certificates should have the specified lifetime action triggers' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/12ef42cb-9903-4e39-9c26-422d29570417
[2026-01-22 15:10:57Z] 
[INFO] 
DEBUG: Checking parameter 'maximumPercentageLife' against policy definition
[2026-01-22 15:10:57Z] 
[INFO] 
DEBUG: Defined parameter names: maximumPercentageLife, minimumDaysBeforeExpiry, effect
[2026-01-22 15:10:57Z] 
[INFO] 
DEBUG: Added parameter 'maximumPercentageLife' = '80' to cleaned params
[2026-01-22 15:10:57Z] 
[INFO] 
DEBUG: Checking parameter 'minimumDaysBeforeExpiry' against policy definition
[2026-01-22 15:10:57Z] 
[INFO] 
DEBUG: Defined parameter names: maximumPercentageLife, minimumDaysBeforeExpiry, effect
[2026-01-22 15:10:57Z] 
[INFO] 
DEBUG: Added parameter 'minimumDaysBeforeExpiry' = '30' to cleaned params
[2026-01-22 15:10:57Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:57Z] 
[INFO] 
DEBUG: Defined parameter names: maximumPercentageLife, minimumDaysBeforeExpiry, effect
[2026-01-22 15:10:57Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:57Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesshouldhavethespecifiedlifetimeactiontrigg-1761965968 and params: 
Name                           Value
----                           -----
maximumPercentageLife          80
minimumDaysBeforeExpiry        30
effect                         Audit



[2026-01-22 15:10:57Z] 
[INFO] 
Preparing to assign (10/30): Secrets should not be active for longer than the specified number of days
[2026-01-22 15:10:57Z] 
[INFO] 
Assigning policy 'Secrets should not be active for longer than the specified number of days' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:57Z] 
[SUCCESS] 
Found 'Secrets should not be active for longer than the specified number of days' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/e8d99835-8a06-45ae-a8e0-87a91941ccfe
[2026-01-22 15:10:57Z] 
[INFO] 
DEBUG: Checking parameter 'maximumValidityInDays' against policy definition
[2026-01-22 15:10:57Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:10:57Z] 
[INFO] 
DEBUG: Added parameter 'maximumValidityInDays' = '730' to cleaned params
[2026-01-22 15:10:57Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:57Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:10:57Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:57Z] 
[INFO] 
Dry-run: would create assignment with name Secretsshouldnotbeactiveforlongerthanthespecifiednumb-1452013840 and params: 
Name                           Value
----                           -----
maximumValidityInDays          730
effect                         Audit



[2026-01-22 15:10:57Z] 
[INFO] 
Preparing to assign (11/30): Certificates should be issued by the specified non-integrated certificate authority
[2026-01-22 15:10:57Z] 
[INFO] 
Assigning policy 'Certificates should be issued by the specified non-integrated certificate authority' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:57Z] 
[SUCCESS] 
Found 'Certificates should be issued by the specified non-integrated certificate authority' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/a22f4a40-01d3-4c7d-8071-da157eeff341
[2026-01-22 15:10:57Z] 
[INFO] 
DEBUG: Checking parameter 'caCommonName' against policy definition
[2026-01-22 15:10:57Z] 
[INFO] 
DEBUG: Defined parameter names: caCommonName, effect
[2026-01-22 15:10:57Z] 
[INFO] 
DEBUG: Added parameter 'caCommonName' = 'CN=ContosoCA' to cleaned params
[2026-01-22 15:10:57Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:57Z] 
[INFO] 
DEBUG: Defined parameter names: caCommonName, effect
[2026-01-22 15:10:57Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:57Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesshouldbeissuedbythespecifiednonintegratedc-500792775 and params: 
Name                           Value
----                           -----
caCommonName                   CN=ContosoCA
effect                         Audit



[2026-01-22 15:10:57Z] 
[INFO] 
Preparing to assign (12/30): Certificates should have the specified maximum validity period
[2026-01-22 15:10:57Z] 
[INFO] 
Assigning policy 'Certificates should have the specified maximum validity period' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:57Z] 
[SUCCESS] 
Found 'Certificates should have the specified maximum validity period' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/0a075868-4c26-42ef-914c-5bc007359560
[2026-01-22 15:10:57Z] 
[INFO] 
DEBUG: Checking parameter 'maximumValidityInMonths' against policy definition
[2026-01-22 15:10:57Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInMonths, effect
[2026-01-22 15:10:57Z] 
[INFO] 
DEBUG: Added parameter 'maximumValidityInMonths' = '36' to cleaned params
[2026-01-22 15:10:57Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:57Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInMonths, effect
[2026-01-22 15:10:57Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:58Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesshouldhavethespecifiedmaximumvalidityperio-407807336 and params: 
Name                           Value
----                           -----
maximumValidityInMonths        36
effect                         Audit



[2026-01-22 15:10:58Z] 
[INFO] 
Preparing to assign (13/30): Keys should have more than the specified number of days before expiration
[2026-01-22 15:10:58Z] 
[INFO] 
Assigning policy 'Keys should have more than the specified number of days before expiration' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:58Z] 
[SUCCESS] 
Found 'Keys should have more than the specified number of days before expiration' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/5ff38825-c5d8-47c5-b70e-069a21955146
[2026-01-22 15:10:58Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:58Z] 
[INFO] 
DEBUG: Defined parameter names: minimumDaysBeforeExpiration, effect
[2026-01-22 15:10:58Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:58Z] 
[INFO] 
DEBUG: Checking parameter 'minimumDaysBeforeExpiration' against policy definition
[2026-01-22 15:10:58Z] 
[INFO] 
DEBUG: Defined parameter names: minimumDaysBeforeExpiration, effect
[2026-01-22 15:10:58Z] 
[INFO] 
DEBUG: Added parameter 'minimumDaysBeforeExpiration' = '30' to cleaned params
[2026-01-22 15:10:58Z] 
[INFO] 
Dry-run: would create assignment with name Keysshouldhavemorethanthespecifiednumberofdaysbeforeexp-12464927 and params: 
Name                           Value
----                           -----
minimumDaysBeforeExpiration    30
effect                         Audit



[2026-01-22 15:10:58Z] 
[INFO] 
Preparing to assign (14/30): Resource logs in Azure Key Vault Managed HSM should be enabled
[2026-01-22 15:10:58Z] 
[INFO] 
Assigning policy 'Resource logs in Azure Key Vault Managed HSM should be enabled' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:58Z] 
[SUCCESS] 
Found 'Resource logs in Azure Key Vault Managed HSM should be enabled' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/a2a5b911-5617-447e-a49e-59dbe0e0434b
[2026-01-22 15:10:58Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:58Z] 
[INFO] 
DEBUG: Defined parameter names: effect, requiredRetentionDays
[2026-01-22 15:10:58Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'AuditIfNotExists' to cleaned params
[2026-01-22 15:10:58Z] 
[INFO] 
Dry-run: would create assignment with name ResourcelogsinAzureKeyVaultManagedHSMshouldbeenabled-1874150632 and params: 
Name                           Value
----                           -----
effect                         AuditIfNotExists



[2026-01-22 15:10:58Z] 
[INFO] 
Preparing to assign (15/30): Key Vault keys should have an expiration date
[2026-01-22 15:10:58Z] 
[INFO] 
Assigning policy 'Key Vault keys should have an expiration date' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:58Z] 
[SUCCESS] 
Found 'Key Vault keys should have an expiration date' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/152b15f7-8e1f-4c1f-ab71-8c010ba5dbc0
[2026-01-22 15:10:59Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:59Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:10:59Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:59Z] 
[INFO] 
Dry-run: would create assignment with name KeyVaultkeysshouldhaveanexpirationdate-386037801 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:10:59Z] 
[INFO] 
Preparing to assign (16/30): Keys should have a rotation policy ensuring that their rotation is scheduled within the specified number of days after creation.
[2026-01-22 15:10:59Z] 
[INFO] 
Assigning policy 'Keys should have a rotation policy ensuring that their rotation is scheduled within the specified number of days after creation.' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:59Z] 
[SUCCESS] 
Found 'Keys should have a rotation policy ensuring that their rotation is scheduled within the specified number of days after creation.' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/d8cf8476-a2ec-4916-896e-992351803c44
[2026-01-22 15:10:59Z] 
[INFO] 
DEBUG: Checking parameter 'maximumDaysToRotate' against policy definition
[2026-01-22 15:10:59Z] 
[INFO] 
DEBUG: Defined parameter names: maximumDaysToRotate, effect
[2026-01-22 15:10:59Z] 
[INFO] 
DEBUG: Added parameter 'maximumDaysToRotate' = '180' to cleaned params
[2026-01-22 15:10:59Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:59Z] 
[INFO] 
DEBUG: Defined parameter names: maximumDaysToRotate, effect
[2026-01-22 15:10:59Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:10:59Z] 
[INFO] 
Dry-run: would create assignment with name Keysshouldhavearotationpolicyensuringthattheirrotatio-1816322754 and params: 
Name                           Value
----                           -----
maximumDaysToRotate            180
effect                         Audit



[2026-01-22 15:10:59Z] 
[INFO] 
Preparing to assign (17/30): Resource logs in Key Vault should be enabled
[2026-01-22 15:10:59Z] 
[INFO] 
Assigning policy 'Resource logs in Key Vault should be enabled' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:59Z] 
[SUCCESS] 
Found 'Resource logs in Key Vault should be enabled' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21
[2026-01-22 15:10:59Z] 
[INFO] 
DEBUG: Checking parameter 'requiredRetentionDays' against policy definition
[2026-01-22 15:10:59Z] 
[INFO] 
DEBUG: Defined parameter names: effect, requiredRetentionDays
[2026-01-22 15:10:59Z] 
[INFO] 
DEBUG: Added parameter 'requiredRetentionDays' = '30' to cleaned params
[2026-01-22 15:10:59Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:10:59Z] 
[INFO] 
DEBUG: Defined parameter names: effect, requiredRetentionDays
[2026-01-22 15:10:59Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'AuditIfNotExists' to cleaned params
[2026-01-22 15:10:59Z] 
[INFO] 
Dry-run: would create assignment with name ResourcelogsinKeyVaultshouldbeenabled-1683835535 and params: 
Name                           Value
----                           -----
requiredRetentionDays          30
effect                         AuditIfNotExists



[2026-01-22 15:10:59Z] 
[INFO] 
Preparing to assign (18/30): Certificates should not expire within the specified number of days
[2026-01-22 15:10:59Z] 
[INFO] 
Assigning policy 'Certificates should not expire within the specified number of days' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:10:59Z] 
[SUCCESS] 
Found 'Certificates should not expire within the specified number of days' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/f772fb64-8e40-40ad-87bc-7706e1949427
[2026-01-22 15:11:00Z] 
[INFO] 
DEBUG: Checking parameter 'daysToExpire' against policy definition
[2026-01-22 15:11:00Z] 
[INFO] 
DEBUG: Defined parameter names: daysToExpire, effect
[2026-01-22 15:11:00Z] 
[INFO] 
DEBUG: Added parameter 'daysToExpire' = '30' to cleaned params
[2026-01-22 15:11:00Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:11:00Z] 
[INFO] 
DEBUG: Defined parameter names: daysToExpire, effect
[2026-01-22 15:11:00Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:11:00Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesshouldnotexpirewithinthespecifiednumberof-2114192775 and params: 
Name                           Value
----                           -----
daysToExpire                   30
effect                         Audit



[2026-01-22 15:11:00Z] 
[INFO] 
Preparing to assign (19/30): Key vaults should have deletion protection enabled
[2026-01-22 15:11:00Z] 
[INFO] 
Assigning policy 'Key vaults should have deletion protection enabled' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:11:00Z] 
[SUCCESS] 
Found 'Key vaults should have deletion protection enabled' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/0b60c0b2-2dc2-4e1c-b5c9-abbed971de53
[2026-01-22 15:11:00Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:11:00Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:11:00Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:11:00Z] 
[INFO] 
Dry-run: would create assignment with name Keyvaultsshouldhavedeletionprotectionenabled-1439856846 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:11:00Z] 
[INFO] 
Preparing to assign (20/30): Deploy - Configure diagnostic settings to an Event Hub to be enabled on Azure Key Vault Managed HSM
[2026-01-22 15:11:00Z] 
[INFO] 
Assigning policy 'Deploy - Configure diagnostic settings to an Event Hub to be enabled on Azure Key Vault Managed HSM' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:11:00Z] 
[SUCCESS] 
Found 'Deploy - Configure diagnostic settings to an Event Hub to be enabled on Azure Key Vault Managed HSM' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/a6d2c800-5230-4a40-bff3-8268b4987d42
[2026-01-22 15:11:01Z] 
[INFO] 
DEBUG: Checking parameter 'eventHubLocation' against policy definition
[2026-01-22 15:11:01Z] 
[INFO] 
DEBUG: Defined parameter names: effect, profileName, eventHubRuleId, eventHubLocation, metricsEnabled, logsEnabled
[2026-01-22 15:11:01Z] 
[INFO] 
DEBUG: Added parameter 'eventHubLocation' = 'eastus' to cleaned params
[2026-01-22 15:11:01Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:11:01Z] 
[INFO] 
DEBUG: Defined parameter names: effect, profileName, eventHubRuleId, eventHubLocation, metricsEnabled, logsEnabled
[2026-01-22 15:11:01Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'DeployIfNotExists' to cleaned params
[2026-01-22 15:11:01Z] 
[INFO] 
DEBUG: Checking parameter 'eventHubRuleId' against policy definition
[2026-01-22 15:11:01Z] 
[INFO] 
DEBUG: Defined parameter names: effect, profileName, eventHubRuleId, eventHubLocation, metricsEnabled, logsEnabled
[2026-01-22 15:11:01Z] 
[INFO] 
DEBUG: Added parameter 'eventHubRuleId' = '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.EventHub/namespaces/eh-policy-test-6513/authorizationrules/RootManageSharedAccessKey' to cleaned params
[2026-01-22 15:11:01Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '' (Length: 0)
[2026-01-22 15:11:01Z] 
[WARN] 
Effect '' requires managed identity. Skipping assignment - provide -IdentityResourceId to enable.

[2026-01-22 15:11:01Z] 
[INFO] 
Preparing to assign (21/30): [Preview]: Configure Azure Key Vault Managed HSM with private endpoints
[2026-01-22 15:11:01Z] 
[INFO] 
Assigning policy '[Preview]: Configure Azure Key Vault Managed HSM with private endpoints' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:11:01Z] 
[SUCCESS] 
Found '[Preview]: Configure Azure Key Vault Managed HSM with private endpoints' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/d1d6d8bb-cc7c-420f-8c7d-6f6f5279a844
[2026-01-22 15:11:01Z] 
[INFO] 
DEBUG: Checking parameter 'privateEndpointSubnetId' against policy definition
[2026-01-22 15:11:01Z] 
[INFO] 
DEBUG: Defined parameter names: privateEndpointSubnetId, effect
[2026-01-22 15:11:01Z] 
[INFO] 
DEBUG: Added parameter 'privateEndpointSubnetId' = '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.Network/virtualNetworks/vnet-policy-test/subnets/snet-privateendpoints' to cleaned params
[2026-01-22 15:11:01Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:11:01Z] 
[INFO] 
DEBUG: Defined parameter names: privateEndpointSubnetId, effect
[2026-01-22 15:11:01Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'DeployIfNotExists' to cleaned params
[2026-01-22 15:11:01Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '' (Length: 0)
[2026-01-22 15:11:01Z] 
[WARN] 
Effect '' requires managed identity. Skipping assignment - provide -IdentityResourceId to enable.

[2026-01-22 15:11:01Z] 
[INFO] 
Preparing to assign (22/30): Azure Key Vault should have firewall enabled or public network access disabled
[2026-01-22 15:11:01Z] 
[INFO] 
Assigning policy 'Azure Key Vault should have firewall enabled or public network access disabled' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:11:01Z] 
[SUCCESS] 
Found 'Azure Key Vault should have firewall enabled or public network access disabled' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/55615ac9-af46-4a59-874e-391cc3dfb490
[2026-01-22 15:11:01Z] 
[INFO] 
DEBUG: Checking parameter 'allowedIPAddresses' against policy definition
[2026-01-22 15:11:01Z] 
[INFO] 
DEBUG: Defined parameter names: effect, restrictIPAddresses, allowedIPAddresses, forbiddenIPAddresses
[2026-01-22 15:11:01Z] 
[INFO] 
DEBUG: Added parameter 'allowedIPAddresses' = '' to cleaned params
[2026-01-22 15:11:01Z] 
[INFO] 
DEBUG: Checking parameter 'forbiddenIPAddresses' against policy definition
[2026-01-22 15:11:01Z] 
[INFO] 
DEBUG: Defined parameter names: effect, restrictIPAddresses, allowedIPAddresses, forbiddenIPAddresses
[2026-01-22 15:11:01Z] 
[INFO] 
DEBUG: Added parameter 'forbiddenIPAddresses' = '' to cleaned params
[2026-01-22 15:11:01Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:11:01Z] 
[INFO] 
DEBUG: Defined parameter names: effect, restrictIPAddresses, allowedIPAddresses, forbiddenIPAddresses
[2026-01-22 15:11:01Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:11:01Z] 
[INFO] 
Dry-run: would create assignment with name AzureKeyVaultshouldhavefirewallenabledorpublicnetwork-1396884516 and params: 
Name                           Value
----                           -----
allowedIPAddresses             {}
forbiddenIPAddresses           {}
effect                         Audit



[2026-01-22 15:11:01Z] 
[INFO] 
Preparing to assign (23/30): Keys should have the specified maximum validity period
[2026-01-22 15:11:01Z] 
[INFO] 
Assigning policy 'Keys should have the specified maximum validity period' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:11:01Z] 
[SUCCESS] 
Found 'Keys should have the specified maximum validity period' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/49a22571-d204-4c91-a7b6-09b1a586fbc9
[2026-01-22 15:11:02Z] 
[INFO] 
DEBUG: Checking parameter 'maximumValidityInDays' against policy definition
[2026-01-22 15:11:02Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:11:02Z] 
[INFO] 
DEBUG: Added parameter 'maximumValidityInDays' = '1095' to cleaned params
[2026-01-22 15:11:02Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:11:02Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:11:02Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:11:02Z] 
[INFO] 
Dry-run: would create assignment with name Keysshouldhavethespecifiedmaximumvalidityperiod-906231923 and params: 
Name                           Value
----                           -----
maximumValidityInDays          1095
effect                         Audit



[2026-01-22 15:11:02Z] 
[INFO] 
Preparing to assign (24/30): Azure Key Vault should disable public network access
[2026-01-22 15:11:02Z] 
[INFO] 
Assigning policy 'Azure Key Vault should disable public network access' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:11:02Z] 
[SUCCESS] 
Found 'Azure Key Vault should disable public network access' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/405c5871-3e91-4644-8a63-58e19d68ff5b
[2026-01-22 15:11:02Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:11:02Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:11:02Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:11:02Z] 
[INFO] 
Dry-run: would create assignment with name AzureKeyVaultshoulddisablepublicnetworkaccess-906277113 and params: 
Name                           Value
----                           -----
effect                         Audit



[2026-01-22 15:11:02Z] 
[INFO] 
Preparing to assign (25/30): Certificates should be issued by one of the specified non-integrated certificate authorities
[2026-01-22 15:11:02Z] 
[INFO] 
Assigning policy 'Certificates should be issued by one of the specified non-integrated certificate authorities' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:11:02Z] 
[SUCCESS] 
Found 'Certificates should be issued by one of the specified non-integrated certificate authorities' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/d3e82b87-6673-410b-8501-1896b688b9a3
[2026-01-22 15:11:02Z] 
[INFO] 
DEBUG: Checking parameter 'caCommonNames' against policy definition
[2026-01-22 15:11:02Z] 
[INFO] 
DEBUG: Defined parameter names: caCommonNames, effect
[2026-01-22 15:11:02Z] 
[INFO] 
DEBUG: Added parameter 'caCommonNames' = 'CN=ContosoCA CN=InternalCA' to cleaned params
[2026-01-22 15:11:02Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:11:02Z] 
[INFO] 
DEBUG: Defined parameter names: caCommonNames, effect
[2026-01-22 15:11:02Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:11:02Z] 
[INFO] 
Dry-run: would create assignment with name Certificatesshouldbeissuedbyoneofthespecifiednonintegr-165973907 and params: 
Name                           Value
----                           -----
caCommonNames                  {CN=ContosoCA, CN=InternalCA}
effect                         Audit



[2026-01-22 15:11:02Z] 
[INFO] 
Preparing to assign (26/30): Keys should not be active for longer than the specified number of days
[2026-01-22 15:11:02Z] 
[INFO] 
Assigning policy 'Keys should not be active for longer than the specified number of days' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:11:02Z] 
[SUCCESS] 
Found 'Keys should not be active for longer than the specified number of days' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/c26e4b24-cf98-4c67-b48b-5a25c4c69eb9
[2026-01-22 15:11:03Z] 
[INFO] 
DEBUG: Checking parameter 'maximumValidityInDays' against policy definition
[2026-01-22 15:11:03Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:11:03Z] 
[INFO] 
DEBUG: Added parameter 'maximumValidityInDays' = '730' to cleaned params
[2026-01-22 15:11:03Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:11:03Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:11:03Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:11:03Z] 
[INFO] 
Dry-run: would create assignment with name Keysshouldnotbeactiveforlongerthanthespecifiednumbero-1296256806 and params: 
Name                           Value
----                           -----
maximumValidityInDays          730
effect                         Audit



[2026-01-22 15:11:03Z] 
[INFO] 
Preparing to assign (27/30): Certificates using RSA cryptography should have the specified minimum key size
[2026-01-22 15:11:03Z] 
[INFO] 
Assigning policy 'Certificates using RSA cryptography should have the specified minimum key size' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:11:03Z] 
[SUCCESS] 
Found 'Certificates using RSA cryptography should have the specified minimum key size' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/cee51871-e572-4576-855c-047c820360f0
[2026-01-22 15:11:03Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:11:03Z] 
[INFO] 
DEBUG: Defined parameter names: minimumRSAKeySize, effect
[2026-01-22 15:11:03Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:11:03Z] 
[INFO] 
DEBUG: Checking parameter 'minimumRSAKeySize' against policy definition
[2026-01-22 15:11:03Z] 
[INFO] 
DEBUG: Defined parameter names: minimumRSAKeySize, effect
[2026-01-22 15:11:03Z] 
[INFO] 
DEBUG: Added parameter 'minimumRSAKeySize' = '2048' to cleaned params
[2026-01-22 15:11:03Z] 
[INFO] 
Dry-run: would create assignment with name CertificatesusingRSAcryptographyshouldhavethespecifie-2031578458 and params: 
Name                           Value
----                           -----
minimumRSAKeySize              2048
effect                         Audit



[2026-01-22 15:11:03Z] 
[INFO] 
Preparing to assign (28/30): Secrets should have the specified maximum validity period
[2026-01-22 15:11:03Z] 
[INFO] 
Assigning policy 'Secrets should have the specified maximum validity period' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:11:03Z] 
[SUCCESS] 
Found 'Secrets should have the specified maximum validity period' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/342e8053-e12e-4c44-be01-c3c2f318400f
[2026-01-22 15:11:03Z] 
[INFO] 
DEBUG: Checking parameter 'maximumValidityInDays' against policy definition
[2026-01-22 15:11:03Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:11:03Z] 
[INFO] 
DEBUG: Added parameter 'maximumValidityInDays' = '1095' to cleaned params
[2026-01-22 15:11:03Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:11:03Z] 
[INFO] 
DEBUG: Defined parameter names: maximumValidityInDays, effect
[2026-01-22 15:11:03Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Audit' to cleaned params
[2026-01-22 15:11:03Z] 
[INFO] 
Dry-run: would create assignment with name Secretsshouldhavethespecifiedmaximumvalidityperiod-1663466362 and params: 
Name                           Value
----                           -----
maximumValidityInDays          1095
effect                         Audit



[2026-01-22 15:11:03Z] 
[INFO] 
Preparing to assign (29/30): Configure Azure Key Vaults to use private DNS zones
[2026-01-22 15:11:03Z] 
[INFO] 
Assigning policy 'Configure Azure Key Vaults to use private DNS zones' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:11:03Z] 
[SUCCESS] 
Found 'Configure Azure Key Vaults to use private DNS zones' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/ac673a9a-f77d-4846-b2d8-a57f8e1c01d4
[2026-01-22 15:11:03Z] 
[INFO] 
DEBUG: Checking parameter 'privateDnsZoneId' against policy definition
[2026-01-22 15:11:03Z] 
[INFO] 
DEBUG: Defined parameter names: privateDnsZoneId, effect
[2026-01-22 15:11:03Z] 
[INFO] 
DEBUG: Added parameter 'privateDnsZoneId' = '/subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb/resourceGroups/rg-policy-remediation/providers/Microsoft.Network/privateDnsZones/privatelink.vaultcore.azure.net' to cleaned params
[2026-01-22 15:11:03Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:11:03Z] 
[INFO] 
DEBUG: Defined parameter names: privateDnsZoneId, effect
[2026-01-22 15:11:03Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'DeployIfNotExists' to cleaned params
[2026-01-22 15:11:03Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '' (Length: 0)
[2026-01-22 15:11:03Z] 
[WARN] 
Effect '' requires managed identity. Skipping assignment - provide -IdentityResourceId to enable.

[2026-01-22 15:11:03Z] 
[INFO] 
Preparing to assign (30/30): [Preview]: Configure Azure Key Vault Managed HSM to disable public network access
[2026-01-22 15:11:03Z] 
[INFO] 
Assigning policy '[Preview]: Configure Azure Key Vault Managed HSM to disable public network access' to /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb (Mode=Audit)
[2026-01-22 15:11:03Z] 
[SUCCESS] 
Found '[Preview]: Configure Azure Key Vault Managed HSM to disable public network access' in mapping: PolicyDefinition -> /providers/Microsoft.Authorization/policyDefinitions/84d327c3-164a-4685-b453-900478614456
[2026-01-22 15:11:04Z] 
[INFO] 
DEBUG: Checking parameter 'effect' against policy definition
[2026-01-22 15:11:04Z] 
[INFO] 
DEBUG: Defined parameter names: effect
[2026-01-22 15:11:04Z] 
[INFO] 
DEBUG: Added parameter 'effect' = 'Modify' to cleaned params
[2026-01-22 15:11:04Z] 
[INFO] 
DEBUG: IdentityResourceId parameter value: '' (Length: 0)
[2026-01-22 15:11:04Z] 
[WARN] 
Effect '' requires managed identity. Skipping assignment - provide -IdentityResourceId to enable.
[2026-01-22 15:11:04Z] 
[INFO] 
Collected 0 assignment IDs for filtering
[2026-01-22 15:11:04Z] 
[INFO] 
Wrote reports: KeyVaultPolicyImplementationReport-20260122-151104.md, KeyVaultPolicyImplementationReport-20260122-151104.json, KeyVaultPolicyImplementationReport-20260122-151104.csv
[2026-01-22 15:11:04Z] 
[SUCCESS] 
HTML report generated: ./PolicyImplementationReport-20260122-151104.html
Dry-run summary written to ./DryRunSummary.txt

[2026-01-22 15:11:04Z] 
[INFO] 
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-01-22 15:11:04Z] 
[INFO] 
                    ğŸ“‹ NEXT STEPS GUIDANCE
[2026-01-22 15:11:04Z] 
[INFO] 
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ¯ Dry-Run Validation Complete

âœ… What was validated:
  â†’ Policy definitions resolved from mapping file
  â†’ Parameter overrides validated against policy schemas
  â†’ Assignment names generated (64-char limit enforced)
  â†’ No actual Azure resources created or modified

ğŸ“‹ Recommended Next Steps:
  1. ğŸ“„ Review dry-run summary:
     
notepad ./DryRunSummary.txt
  2. âœ… Verify all policies resolved successfully (Status: DryRun)
  3. ğŸ” Check for policies requiring managed identity (DeployIfNotExists/Modify effects)
  4. ğŸ“Š Review parameter values match your requirements
  5. ğŸš€ Deploy to test environment when ready:
     
.\\AzPolicyImplScript.ps1 -ParameterFile <YOUR_PARAM_FILE> -SkipRBACCheck

âš ï¸  Common Issues to Check:
  â†’ Policies with Status='Skipped' require -IdentityResourceId parameter
  â†’ Verify parameter values don't exceed policy min/max constraints
  â†’ Check for typos in policy display names (lookup failures)

ğŸ“š Documentation:
  â†’ Parameter File Guide: PolicyParameters-QuickReference.md
  â†’ Deployment Workflow: DEPLOYMENT-WORKFLOW-GUIDE.md


ğŸ“‹ Dry-Run Summary: 
./DryRunSummary.txt


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-01-22 15:11:04Z] 
[SUCCESS] 
Completed run. Reports generated.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“„ Reports Generated:
  â€¢ HTML:     
./PolicyImplementationReport-20260122-151104.html
  â€¢ Markdown: 
KeyVaultPolicyImplementationReport-20260122-151104.md
  â€¢ JSON:     
KeyVaultPolicyImplementationReport-20260122-151104.json


[2026-01-22 15:11:04Z] 
[INFO] 
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-01-22 15:11:04Z] 
[INFO] 
                    ğŸ“‹ NEXT STEPS GUIDANCE
[2026-01-22 15:11:04Z] 
[INFO] 
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ¯ DevTest Deployment Complete (30 Policies - Audit Mode)

âœ… What was deployed:
  â†’ 30 Azure Key Vault governance policies in Audit mode
  â†’ Monitoring compliance without blocking operations
  â†’ Test environment: rg-policy-keyvault-test resource group

ğŸ“‹ Recommended Next Steps:
  1. â³ Wait 30-60 minutes for Azure Policy evaluation cycle
  2. ğŸ“Š Check compliance status:
     
.\\AzPolicyImplScript.ps1 -CheckCompliance -TriggerScan
  3. ğŸ§ª Test infrastructure validation:
     
.\\AzPolicyImplScript.ps1 -TestInfrastructure -Detailed
  4. ğŸ“ˆ Deploy full 46-policy suite when ready:
     
.\\AzPolicyImplScript.ps1 -ParameterFile .\\PolicyParameters-DevTest-Full.json

ğŸ“š Documentation:
  â†’ Testing Guide: QUICKSTART.md (lines 1-150)
  â†’ Policy List: DefinitionListExport.csv (first 30 policies)

[2026-01-22 15:11:04] [SUCCESS]   âœ… Command executed successfully
[2026-01-22 15:11:04] [INFO]   Output saved to: .\scenario-7-output-20260122-151054.txt
[2026-01-22 15:11:04] [ERROR]   âŒ Console next steps validation failed for Resource Group Scope (Limited Deployment)
[2026-01-22 15:11:04] [ERROR]     - Missing 'NEXT STEPS GUIDANCE' banner
[2026-01-22 15:11:04] [ERROR]     - Missing resource group scope indication
[2026-01-22 15:11:04] [SUCCESS]   âœ… HTML report validated for Resource Group Scope (Limited Deployment)
[2026-01-22 15:11:04] [SUCCESS]   âœ… No unexpected warnings/errors for Resource Group Scope (Limited Deployment)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-01-22 15:11:06] [INFO] SCENARIO 8: Management Group Scope (Enterprise-Wide)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-01-22 15:11:06] [WARN] âš ï¸  User input required for this scenario:
[2026-01-22 15:11:06] [WARN]     Replace <MANAGEMENT_GROUP_ID> with your management group ID
[2026-01-22 15:11:06] [WARN]     WARNING: Affects all subscriptions under management group
[2026-01-22 15:11:06] [WARN]   â­ï¸  Skipping scenario (no -ManagementGroupId provided)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-01-22 15:11:06] [INFO] SCENARIO 9: Rollback (Remove All Policies)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[2026-01-22 15:11:06] [INFO] Executing: .\AzPolicyImplScript.ps1 -Rollback -SkipRBACCheck -Preview

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  Azure Policy Implementation - Key Vault Governance          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[2026-01-22 15:11:06Z] 
[INFO] 
Starting Azure Policy implementation script for Key Vault policies
[2026-01-22 15:11:06Z] 
[INFO] 
Checking required PowerShell modules...
[2026-01-22 15:11:06Z] 
[SUCCESS] 
Module Az.Accounts is present
[2026-01-22 15:11:06Z] 
[SUCCESS] 
Module Az.Resources is present
[2026-01-22 15:11:06Z] 
[SUCCESS] 
Module Az.PolicyInsights is present
[2026-01-22 15:11:06Z] 
[SUCCESS] 
Module Az.Monitor is present
[2026-01-22 15:11:06Z] 
[SUCCESS] 
Module Az.KeyVault is present
[2026-01-22 15:11:06Z] 
[INFO] 
Using Azure context: theregniers@hotmail.com

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  WARNING: Policy Rollback - Removing KV Policy Assignments  â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

No Key Vault policy assignments found at scope: /subscriptions/ab1336c7-687d-4107-b0f6-9649a0458adb
[2026-01-22 15:11:14] [SUCCESS]   âœ… Command executed successfully
[2026-01-22 15:11:14] [INFO]   Output saved to: .\scenario-9-output-20260122-151106.txt
[2026-01-22 15:11:14] [ERROR]   âŒ Console next steps validation failed for Rollback (Remove All Policies)
[2026-01-22 15:11:14] [ERROR]     - Missing 'NEXT STEPS GUIDANCE' banner
[2026-01-22 15:11:14] [ERROR]     - Missing rollback confirmation
[2026-01-22 15:11:14] [SUCCESS]   âœ… HTML report validated for Rollback (Remove All Policies)
[2026-01-22 15:11:14] [SUCCESS]   âœ… No unexpected warnings/errors for Rollback (Remove All Policies)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                     TEST SUMMARY REPORT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[2026-01-22 15:11:16] [INFO] Test Duration: 00:02:32
[2026-01-22 15:11:16] [INFO] Test Log: .\test-all-scenarios-validation-20260122-150844.txt

ğŸ“Š Results by Scenario:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

DevTest Baseline (30 Policies):
  Status: FAIL
  âŒ Console validation: False
  âœ… HTML validation: True
  âœ… No unexpected warnings/errors: True
  ğŸ“„ Output: .\scenario-1-output-20260122-150844.txt

DevTest Full (46 Policies):
  Status: FAIL
  âŒ Console validation: False
  âœ… HTML validation: True
  âœ… No unexpected warnings/errors: True
  ğŸ“„ Output: .\scenario-2-output-20260122-150905.txt

DevTest Auto-Remediation (8 Policies):
  Status: FAIL
  âŒ Console validation: False
  âœ… HTML validation: True
  âœ… No unexpected warnings/errors: True
  ğŸ“„ Output: .\scenario-3-output-20260122-150924.txt

Production Audit (46 Policies):
  Status: FAIL
  âŒ Console validation: False
  âœ… HTML validation: True
  âœ… No unexpected warnings/errors: True
  ğŸ“„ Output: .\scenario-4-output-20260122-150952.txt

Production Deny (46 Policies - Maximum Enforcement):
  Status: FAIL
  âŒ Console validation: False
  âœ… HTML validation: True
  âœ… No unexpected warnings/errors: True
  ğŸ“„ Output: .\scenario-5-output-20260122-151010.txt

Production Auto-Remediation (8 Policies):
  Status: FAIL
  âŒ Console validation: False
  âœ… HTML validation: True
  âœ… No unexpected warnings/errors: True
  ğŸ“„ Output: .\scenario-6-output-20260122-151029.txt

Resource Group Scope (Limited Deployment):
  Status: FAIL
  âŒ Console validation: False
  âœ… HTML validation: True
  âœ… No unexpected warnings/errors: True
  ğŸ“„ Output: .\scenario-7-output-20260122-151054.txt

Management Group Scope (Enterprise-Wide):
  Status: SKIPPED
  â­ï¸  Reason: No management group ID provided

Rollback (Remove All Policies):
  Status: FAIL
  âŒ Console validation: False
  âœ… HTML validation: True
  âœ… No unexpected warnings/errors: True
  ğŸ“„ Output: .\scenario-9-output-20260122-151106.txt

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Š Overall Statistics:
  Total scenarios: 9
  âœ… Passed: 0
  âŒ Failed: 8
  âš ï¸  Errors: 0
  â­ï¸  Skipped: 3

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âŒ SOME TESTS FAILED - Review output above
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[2026-01-22 15:11:17] [INFO] 
Test suite complete. Overall status: FAIL
