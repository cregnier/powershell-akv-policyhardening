"Policy Name","Policy ID","Default Effect","Can Use Deny","Can Use Audit","Allowed Effects","Category","Version","Definition Type","Description"
"[Preview]: Azure Key Vault Managed HSM should use private link","59fee2f4-d439-4f1b-9b9a-982e1474bfd8","Audit","False","True","Audit, Disabled","Audit-Only (No Deny option)","1.0.0-preview","Policy","Private link provides a way to connect Azure Key Vault Managed HSM to your Azure resources without sending traffic over ..."
"[Preview]: Configure Azure Key Vault Managed HSM to disable public network access","84d327c3-164a-4685-b453-900478614456","Modify","False","False","Modify, Disabled","Audit-Only (No Deny option)","2.0.0-preview","Policy","Disable public network access for your Azure Key Vault Managed HSM so that it's not accessible over the public internet...."
"[Preview]: Configure Azure Key Vault Managed HSM with private endpoints","d1d6d8bb-cc7c-420f-8c7d-6f6f5279a844","DeployIfNotExists","False","False","DeployIfNotExists, Disabled","Audit-Only (No Deny option)","1.0.0-preview","Policy","Private endpoints connect your virtual networks to Azure services without a public IP address at the source or destinati..."
"Configure Azure Key Vaults to use private DNS zones","ac673a9a-f77d-4846-b2d8-a57f8e1c01d4","DeployIfNotExists","False","False","DeployIfNotExists, Disabled","Audit-Only (No Deny option)","1.0.1","Policy","Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual ne..."
"Configure Azure Key Vaults with private endpoints","9d4fad1f-5189-4a42-b29e-cf7929c6b6df","DeployIfNotExists","False","False","DeployIfNotExists, Disabled","Audit-Only (No Deny option)","1.0.1","Policy","Private endpoints connect your virtual networks to Azure services without a public IP address at the source or destinati..."
"Configure key vaults to enable firewall","ac673a9a-f77d-4846-b2d8-a57f8e1c01dc","Modify","False","False","Modify, Disabled","Audit-Only (No Deny option)","1.1.1","Policy","Enable the key vault firewall so that the key vault is not accessible by default to any public IPs. You can then configu..."
"Deploy - Configure diagnostic settings for Azure Key Vault to Log Analytics workspace","951af2fa-529b-416e-ab6e-066fd85ac459","DeployIfNotExists","False","False","DeployIfNotExists, Disabled","Audit-Only (No Deny option)","2.0.1","Policy","Deploys the diagnostic settings for Azure Key Vault to stream resource logs to a Log Analytics workspace when any Key Va..."
"Deploy - Configure diagnostic settings to an Event Hub to be enabled on Azure Key Vault Managed HSM","a6d2c800-5230-4a40-bff3-8268b4987d42","DeployIfNotExists","False","False","DeployIfNotExists, Disabled","Audit-Only (No Deny option)","1.0.0","Policy","Deploys the diagnostic settings for Azure Key Vault Managed HSM to stream to a regional Event Hub when any Azure Key Vau..."
"Deploy Diagnostic Settings for Key Vault to Event Hub","ed7c8c13-51e7-49d1-8a43-8490431a0da2","DeployIfNotExists","False","False","DeployIfNotExists, Disabled","Audit-Only (No Deny option)","3.0.1","Policy","Deploys the diagnostic settings for Key Vault to stream to a regional Event Hub when any Key Vault which is missing this..."
"Keys should have a rotation policy ensuring that their rotation is scheduled within the specified number of days after creation.","d8cf8476-a2ec-4916-896e-992351803c44","Audit","False","True","Audit, Disabled","Audit-Only (No Deny option)","1.0.0","Policy","Manage your organizational compliance requirements by specifying the maximum number of days after key creation until it ..."
"Resource logs in Azure Key Vault Managed HSM should be enabled","a2a5b911-5617-447e-a49e-59dbe0e0434b","AuditIfNotExists","False","False","AuditIfNotExists, Disabled","Audit-Only (No Deny option)","1.1.0","Policy","To recreate activity trails for investigation purposes when a security incident occurs or when your network is compromis..."
"Resource logs in Key Vault should be enabled","cf820ca0-f99e-4f3e-84fb-66e913812d21","AuditIfNotExists","False","False","AuditIfNotExists, Disabled","Audit-Only (No Deny option)","5.0.0","Policy","Audit enabling of resource logs. This enables you to recreate activity trails to use for investigation purposes when a s..."
"[Preview]: Azure Key Vault Managed HSM keys should have an expiration date","1d478a74-21ba-4b9f-9d8f-8e6fced0eec5","Audit","True","True","Audit, Deny, Disabled","Deny-Capable (Default: Audit)","1.0.1-preview","Policy","To use this policy in preview, you must first follow these instructions at https://aka.ms/mhsmgovernance. Cryptographic ..."
"[Preview]: Azure Key Vault Managed HSM Keys should have more than the specified number of days before expiration","ad27588c-0198-4c84-81ef-08efd0274653","Audit","True","True","Audit, Deny, Disabled","Deny-Capable (Default: Audit)","1.0.1-preview","Policy","To use this policy in preview, you must first follow these instructions at https://aka.ms/mhsmgovernance. If a key is to..."
"[Preview]: Azure Key Vault Managed HSM keys using elliptic curve cryptography should have the specified curve names","e58fd0c1-feac-4d12-92db-0a7e9421f53e","Audit","True","True","Audit, Deny, Disabled","Deny-Capable (Default: Audit)","1.0.1-preview","Policy","To use this policy in preview, you must first follow these instructions at https://aka.ms/mhsmgovernance. Keys backed by..."
"[Preview]: Azure Key Vault Managed HSM keys using RSA cryptography should have a specified minimum key size","86810a98-8e91-4a44-8386-ec66d0de5d57","Audit","True","True","Audit, Deny, Disabled","Deny-Capable (Default: Audit)","1.0.1-preview","Policy","To use this policy in preview, you must first follow these instructions at https://aka.ms/mhsmgovernance. Set the minimu..."
"[Preview]: Azure Key Vault Managed HSM should disable public network access","19ea9d63-adee-4431-a95e-1913c6c1c75f","Audit","True","True","Audit, Deny, Disabled","Deny-Capable (Default: Audit)","1.0.0-preview","Policy","Disable public network access for your Azure Key Vault Managed HSM so that it's not accessible over the public internet...."
"Azure Key Vault Managed HSM should have purge protection enabled","c39ba22d-4428-4149-b981-70acb31fc383","Audit","True","True","Audit, Deny, Disabled","Deny-Capable (Default: Audit)","1.0.0","Policy","Malicious deletion of an Azure Key Vault Managed HSM can lead to permanent data loss. A malicious insider in your organi..."
"Azure Key Vault should disable public network access","405c5871-3e91-4644-8a63-58e19d68ff5b","Audit","True","True","Audit, Deny, Disabled","Deny-Capable (Default: Audit)","1.1.0","Policy","Disable public network access for your key vault so that it's not accessible over the public internet. This can reduce d..."
"Azure Key Vault should have firewall enabled or public network access disabled","55615ac9-af46-4a59-874e-391cc3dfb490","Audit","True","True","Audit, Deny, Disabled","Deny-Capable (Default: Audit)","3.3.0","Policy","Enable the key vault firewall so that the key vault is not accessible by default to any public IPs or disable public net..."
"Azure Key Vault should use RBAC permission model","12d4fa5e-1f9f-4c21-97a9-b99b3c6611b5","Audit","True","True","Audit, Deny, Disabled","Deny-Capable (Default: Audit)","1.0.1","Policy","Enable RBAC permission model across Key Vaults. Learn more at: https://learn.microsoft.com/en-us/azure/key-vault/general..."
"Azure Key Vaults should use private link","a6abeaec-4d90-4a02-805f-6b26c4d3fbe9","Audit","True","True","Audit, Deny, Disabled","Deny-Capable (Default: Audit)","1.2.1","Policy","Azure Private Link lets you connect your virtual networks to Azure services without a public IP address at the source or..."
"Certificates should be issued by one of the specified non-integrated certificate authorities","d3e82b87-6673-410b-8501-1896b688b9a3","Audit","True","True","Audit, Deny, Disabled","Deny-Capable (Default: Audit)","1.0.1","Policy","Manage your organizational compliance requirements by specifying custom or internal certificate authorities that can iss..."
"Certificates should be issued by the specified integrated certificate authority","8e826246-c976-48f6-b03e-619bb92b3d82","Audit","True","True","audit, Audit, deny, Deny, disabled, Disabled","Deny-Capable (Default: Audit)","2.1.0","Policy","Manage your organizational compliance requirements by specifying the Azure integrated certificate authorities that can i..."
"Certificates should be issued by the specified non-integrated certificate authority","a22f4a40-01d3-4c7d-8071-da157eeff341","Audit","True","True","audit, Audit, deny, Deny, disabled, Disabled","Deny-Capable (Default: Audit)","2.1.1","Policy","Manage your organizational compliance requirements by specifying one custom or internal certificate authorities that can..."
"Certificates should have the specified lifetime action triggers","12ef42cb-9903-4e39-9c26-422d29570417","Audit","True","True","audit, Audit, deny, Deny, disabled, Disabled","Deny-Capable (Default: Audit)","2.1.0","Policy","Manage your organizational compliance requirements by specifying whether a certificate lifetime action is triggered at a..."
"Certificates should have the specified maximum validity period","0a075868-4c26-42ef-914c-5bc007359560","Audit","True","True","audit, Audit, deny, Deny, disabled, Disabled","Deny-Capable (Default: Audit)","2.2.1","Policy","Manage your organizational compliance requirements by specifying the maximum amount of time that a certificate can be va..."
"Certificates should not expire within the specified number of days","f772fb64-8e40-40ad-87bc-7706e1949427","Audit","True","True","audit, Audit, deny, Deny, disabled, Disabled","Deny-Capable (Default: Audit)","2.1.1","Policy","Manage certificates that will expire within a specified number of days to ensure your organization has sufficient time t..."
"Certificates should use allowed key types","1151cede-290b-4ba0-8b38-0ad145ac888f","Audit","True","True","audit, Audit, deny, Deny, disabled, Disabled","Deny-Capable (Default: Audit)","2.1.0","Policy","Manage your organizational compliance requirements by restricting the key types allowed for certificates...."
"Certificates using elliptic curve cryptography should have allowed curve names","bd78111f-4953-4367-9fd5-7e08808b54bf","Audit","True","True","audit, Audit, deny, Deny, disabled, Disabled","Deny-Capable (Default: Audit)","2.1.0","Policy","Manage the allowed elliptic curve names for ECC Certificates stored in key vault. More information can be found at https..."
"Certificates using RSA cryptography should have the specified minimum key size","cee51871-e572-4576-855c-047c820360f0","Audit","True","True","audit, Audit, deny, Deny, disabled, Disabled","Deny-Capable (Default: Audit)","2.1.0","Policy","Manage your organizational compliance requirements by specifying a minimum key size for RSA certificates stored in your ..."
"Key Vault keys should have an expiration date","152b15f7-8e1f-4c1f-ab71-8c010ba5dbc0","Audit","True","True","Audit, Deny, Disabled","Deny-Capable (Default: Audit)","1.0.2","Policy","Cryptographic keys should have a defined expiration date and not be permanent. Keys that are valid forever provide a pot..."
"Key Vault secrets should have an expiration date","98728c90-32c7-4049-8429-847dc0f4fe37","Audit","True","True","Audit, Deny, Disabled","Deny-Capable (Default: Audit)","1.0.2","Policy","Secrets should have a defined expiration date and not be permanent. Secrets that are valid forever provide a potential a..."
"Key vaults should have deletion protection enabled","0b60c0b2-2dc2-4e1c-b5c9-abbed971de53","Audit","True","True","Audit, Deny, Disabled","Deny-Capable (Default: Audit)","2.1.0","Policy","Malicious deletion of a key vault can lead to permanent data loss. You can prevent permanent data loss by enabling purge..."
"Key vaults should have soft delete enabled","1e66c121-a66a-4b1f-9b83-0fd99bf0fc2d","Audit","True","True","Audit, Deny, Disabled","Deny-Capable (Default: Audit)","3.1.0","Policy","Deleting a key vault without soft delete enabled permanently deletes all secrets, keys, and certificates stored in the k..."
"Keys should be backed by a hardware security module (HSM)","587c79fe-dd04-4a5e-9d0b-f89598c7261b","Audit","True","True","Audit, Deny, Disabled","Deny-Capable (Default: Audit)","1.0.1","Policy","An HSM is a hardware security module that stores keys. An HSM provides a physical layer of protection for cryptographic ..."
"Keys should be the specified cryptographic type RSA or EC","75c4f823-d65c-4f29-a733-01d0077fdbcb","Audit","True","True","Audit, Deny, Disabled","Deny-Capable (Default: Audit)","1.0.1","Policy","Some applications require the use of keys backed by a specific cryptographic type. Enforce a particular cryptographic ke..."
"Keys should have more than the specified number of days before expiration","5ff38825-c5d8-47c5-b70e-069a21955146","Audit","True","True","Audit, Deny, Disabled","Deny-Capable (Default: Audit)","1.0.1","Policy","If a key is too close to expiration, an organizational delay to rotate the key may result in an outage. Keys should be r..."
"Keys should have the specified maximum validity period","49a22571-d204-4c91-a7b6-09b1a586fbc9","Audit","True","True","Audit, Deny, Disabled","Deny-Capable (Default: Audit)","1.0.1","Policy","Manage your organizational compliance requirements by specifying the maximum amount of time in days that a key can be va..."
"Keys should not be active for longer than the specified number of days","c26e4b24-cf98-4c67-b48b-5a25c4c69eb9","Audit","True","True","Audit, Deny, Disabled","Deny-Capable (Default: Audit)","1.0.1","Policy","Specify the number of days that a key should be active. Keys that are used for an extended period of time increase the p..."
"Keys using elliptic curve cryptography should have the specified curve names","ff25f3c8-b739-4538-9d07-3d6d25cfb255","Audit","True","True","Audit, Deny, Disabled","Deny-Capable (Default: Audit)","1.0.1","Policy","Keys backed by elliptic curve cryptography can have different curve names. Some applications are only compatible with sp..."
"Keys using RSA cryptography should have a specified minimum key size","82067dbb-e53b-4e06-b631-546d197452d9","Audit","True","True","Audit, Deny, Disabled","Deny-Capable (Default: Audit)","1.0.1","Policy","Set the minimum allowed key size for use with your key vaults. Use of RSA keys with small key sizes is not a secure prac..."
"Secrets should have content type set","75262d3e-ba4a-4f43-85f8-9f72c090e5e3","Audit","True","True","Audit, Deny, Disabled","Deny-Capable (Default: Audit)","1.0.1","Policy","A content type tag helps identify whether a secret is a password, connection string, etc. Different secrets have differe..."
"Secrets should have more than the specified number of days before expiration","b0eb591a-5e70-4534-a8bf-04b9c489584a","Audit","True","True","Audit, Deny, Disabled","Deny-Capable (Default: Audit)","1.0.1","Policy","If a secret is too close to expiration, an organizational delay to rotate the secret may result in an outage. Secrets sh..."
"Secrets should have the specified maximum validity period","342e8053-e12e-4c44-be01-c3c2f318400f","Audit","True","True","Audit, Deny, Disabled","Deny-Capable (Default: Audit)","1.0.1","Policy","Manage your organizational compliance requirements by specifying the maximum amount of time in days that a secret can be..."
"Secrets should not be active for longer than the specified number of days","e8d99835-8a06-45ae-a8e0-87a91941ccfe","Audit","True","True","Audit, Deny, Disabled","Deny-Capable (Default: Audit)","1.0.1","Policy","If your secrets were created with an activation date set in the future, you must ensure that your secrets have not been ..."
